<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ŸÜÿ∏ÿßŸÖ ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ ÿßŸÑŸÖÿ™ŸÉÿßŸÖŸÑ</title>
  <script src="./_sdk/data_sdk.js"></script>
  <script src="./_sdk/element_sdk.js"></script><!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"><!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet"><!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <!-- SheetJS for Excel support -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <!-- jsPDF for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
  <style>
        :root {
            /* ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© - ŸÖÿ≠ÿ≥ŸëŸÜÿ© */
            --primary-color: #6366f1;
            --secondary-color: #8b5cf6;
            --accent-color: #ec4899;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;
            
            /* ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ - ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ */
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-card: #1a1a1a;
            --bg-hover: #252525;
            --bg-light: #f8fafc;
            --bg-white: #ffffff;
            
            /* ÿßŸÑŸÜÿµŸàÿµ - ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ */
            --text-primary: #e8e8e8;
            --text-secondary: #b8b8b8;
            --text-tertiary: #8a8a8a;
            --text-dark: #1e293b;
            --text-muted: #6a6a6a;
            
            /* ÿßŸÑÿ≠ÿØŸàÿØ */
            --border-color: #2a2a2a;
            --border-light: #e2e8f0;
            --border-radius: 16px;
            --border-radius-sm: 8px;
            --border-radius-lg: 24px;
            
            /* ÿßŸÑÿ™ÿØÿ±ÿ¨ÿßÿ™ - ŸÖÿ≠ÿ≥ŸëŸÜÿ© */
            --primary-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --secondary-gradient: linear-gradient(135deg, #ec4899 0%, #f43f5e 100%);
            --success-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            
            /* ÿßŸÑÿ∏ŸÑÿßŸÑ - ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ */
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.5);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.6);
            --shadow-lg: 0 8px 25px rgba(0,0,0,0.7);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.8);
            --shadow-colored: 0 10px 40px -10px rgba(99, 102, 241, 0.5);
            
            /* ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ŸÑŸÑÿ´ŸäŸÖ ÿßŸÑÿØÿßŸÉŸÜ */
            --theme-bg-primary: var(--bg-primary);
            --theme-bg-secondary: var(--bg-secondary);
            --theme-bg-card: var(--bg-card);
            --theme-bg-hover: var(--bg-hover);
            --theme-text-primary: var(--text-primary);
            --theme-text-secondary: var(--text-secondary);
            --theme-text-tertiary: var(--text-tertiary);
            --theme-border: var(--border-color);
            --theme-shadow: var(--shadow-md);
        }

        /* ÿßŸÑÿ´ŸäŸÖ ÿßŸÑŸÅÿßÿ™ÿ≠ - ŸÖÿ≠ÿ≥ŸëŸÜ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ */
        [data-theme="light"] {
            /* ÿßŸÑÿÆŸÑŸÅŸäÿßÿ™ - ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ */
            --theme-bg-primary: #f5f5f0;
            --theme-bg-secondary: #fafaf8;
            --theme-bg-card: #ffffff;
            --theme-bg-hover: #ececea;
            
            /* ÿßŸÑŸÜÿµŸàÿµ - ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ */
            --theme-text-primary: #1a1a1a;
            --theme-text-secondary: #4a4a4a;
            --theme-text-tertiary: #6a6a6a;
            
            /* ÿßŸÑÿ≠ÿØŸàÿØ */
            --theme-border: #d8d8d8;
            
            /* ÿßŸÑÿ∏ŸÑÿßŸÑ - ŸÖÿ≠ÿ≥ŸëŸÜÿ© ŸÑŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ */
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 25px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.12);
            --shadow-colored: 0 10px 40px -10px rgba(99, 102, 241, 0.25);
            --theme-shadow: var(--shadow-md);
            
            /* ÿ£ŸÑŸàÿßŸÜ ŸÖÿÆÿµÿµÿ© ŸÑŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ */
            --light-accent: #eef2ff;
            --light-success: #ecfdf5;
            --light-warning: #fffbeb;
            --light-danger: #fef2f2;
            --light-info: #eff6ff;
        }

        /* üîµ ÿ´ŸäŸÖ ÿ£ÿ≤ÿ±ŸÇ ÿØÿßŸÉŸÜ - Blue Dark */
        [data-theme="blue-dark"] {
            --theme-bg-primary: #0a1628;
            --theme-bg-secondary: #0f1c30;
            --theme-bg-card: #152238;
            --theme-bg-hover: #1a2945;
            
            --theme-text-primary: #e1f0ff;
            --theme-text-secondary: #a8c5e0;
            --theme-text-tertiary: #7a9ec2;
            
            --theme-border: #1e3a5f;
            --shadow-colored: 0 10px 40px -10px rgba(59, 130, 246, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #3b82f6;
            --secondary-color: #2563eb;
        }

        /* üíö ÿ´ŸäŸÖ ÿ£ÿÆÿ∂ÿ± ÿØÿßŸÉŸÜ - Green Dark */
        [data-theme="green-dark"] {
            --theme-bg-primary: #0a1f0f;
            --theme-bg-secondary: #0e2817;
            --theme-bg-card: #14321f;
            --theme-bg-hover: #1a4028;
            
            --theme-text-primary: #d1fae5;
            --theme-text-secondary: #a7d9c0;
            --theme-text-tertiary: #7db89a;
            
            --theme-border: #1e5438;
            --shadow-colored: 0 10px 40px -10px rgba(16, 185, 129, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #10b981;
            --secondary-color: #059669;
        }

        /* üß° ÿ´ŸäŸÖ ÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿØÿßŸÉŸÜ - Orange Dark */
        [data-theme="orange-dark"] {
            --theme-bg-primary: #1f1208;
            --theme-bg-secondary: #2a1810;
            --theme-bg-card: #351e18;
            --theme-bg-hover: #402520;
            
            --theme-text-primary: #ffe4d1;
            --theme-text-secondary: #d9b8a7;
            --theme-text-tertiary: #b3927d;
            
            --theme-border: #543428;
            --shadow-colored: 0 10px 40px -10px rgba(249, 115, 22, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #f97316;
            --secondary-color: #ea580c;
        }

        /* üíú ÿ´ŸäŸÖ ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä ÿØÿßŸÉŸÜ - Purple Dark */
        [data-theme="purple-dark"] {
            --theme-bg-primary: #1a0a28;
            --theme-bg-secondary: #240f35;
            --theme-bg-card: #2e1542;
            --theme-bg-hover: #381a50;
            
            --theme-text-primary: #f0d1ff;
            --theme-text-secondary: #c9a8e0;
            --theme-text-tertiary: #a37dc2;
            
            --theme-border: #4a2563;
            --shadow-colored: 0 10px 40px -10px rgba(168, 85, 247, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #a855f7;
            --secondary-color: #9333ea;
        }

        /* ‚ù§Ô∏è ÿ´ŸäŸÖ ÿ£ÿ≠ŸÖÿ± ÿØÿßŸÉŸÜ - Red Dark */
        [data-theme="red-dark"] {
            --theme-bg-primary: #280a0a;
            --theme-bg-secondary: #350f0f;
            --theme-bg-card: #421515;
            --theme-bg-hover: #501a1a;
            
            --theme-text-primary: #ffd1d1;
            --theme-text-secondary: #e0a8a8;
            --theme-text-tertiary: #c27d7d;
            
            --theme-border: #632525;
            --shadow-colored: 0 10px 40px -10px rgba(239, 68, 68, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #ef4444;
            --secondary-color: #dc2626;
        }

        /* ü©µ ÿ´ŸäŸÖ ÿ≥ŸÖÿßŸàŸä ŸÅÿßÿ™ÿ≠ - Cyan Light */
        [data-theme="cyan-light"] {
            --theme-bg-primary: #e0f7fa;
            --theme-bg-secondary: #f0fbfc;
            --theme-bg-card: #ffffff;
            --theme-bg-hover: #d0f3f7;
            
            --theme-text-primary: #0e2933;
            --theme-text-secondary: #1a4d5f;
            --theme-text-tertiary: #26718b;
            
            --theme-border: #b0dce5;
            --shadow-colored: 0 10px 40px -10px rgba(6, 182, 212, 0.3);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.08);
            
            --primary-color: #06b6d4;
            --secondary-color: #0891b2;
        }

        /* üü° ÿ´ŸäŸÖ ÿ∞Ÿáÿ®Ÿä ŸÅÿßÿ™ÿ≠ - Gold Light */
        [data-theme="gold-light"] {
            --theme-bg-primary: #fffbea;
            --theme-bg-secondary: #fffef5;
            --theme-bg-card: #ffffff;
            --theme-bg-hover: #fff8d6;
            
            --theme-text-primary: #2a2008;
            --theme-text-secondary: #4d3810;
            --theme-text-tertiary: #705018;
            
            --theme-border: #e8d89b;
            --shadow-colored: 0 10px 40px -10px rgba(245, 158, 11, 0.3);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.08);
            
            --primary-color: #f59e0b;
            --secondary-color: #d97706;
        }

        /* üå∏ ÿ´ŸäŸÖ Ÿàÿ±ÿØŸä ŸÅÿßÿ™ÿ≠ - Pink Light */
        [data-theme="pink-light"] {
            --theme-bg-primary: #fce7f3;
            --theme-bg-secondary: #fef1f7;
            --theme-bg-card: #ffffff;
            --theme-bg-hover: #fad1e8;
            
            --theme-text-primary: #2d081f;
            --theme-text-secondary: #501030;
            --theme-text-tertiary: #731842;
            
            --theme-border: #f5c0dd;
            --shadow-colored: 0 10px 40px -10px rgba(236, 72, 153, 0.3);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.08);
            
            --primary-color: #ec4899;
            --secondary-color: #db2777;
        }

        /* üü¢ ÿ´ŸäŸÖ ÿ£ÿÆÿ∂ÿ± ÿ≤Ÿäÿ™ŸàŸÜŸä - Olive */
        [data-theme="olive"] {
            --theme-bg-primary: #1a1f0a;
            --theme-bg-secondary: #242a0f;
            --theme-bg-card: #2e3515;
            --theme-bg-hover: #38401a;
            
            --theme-text-primary: #e8f0d1;
            --theme-text-secondary: #c9d9a8;
            --theme-text-tertiary: #aac27d;
            
            --theme-border: #4a5425;
            --shadow-colored: 0 10px 40px -10px rgba(132, 204, 22, 0.5);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.6);
            
            --primary-color: #84cc16;
            --secondary-color: #65a30d;
        }

        /* üî¥ ÿ´ŸäŸÖ ÿ£ÿ≤ÿ±ŸÇ ÿØÿßŸÉŸÜ ŸÖŸÑŸÉŸä - Royal Blue */
        [data-theme="royal-blue"] {
            --theme-bg-primary: #0c1445;
            --theme-bg-secondary: #111b5f;
            --theme-bg-card: #162270;
            --theme-bg-hover: #1b2880;
            
            --theme-text-primary: #d6e4ff;
            --theme-text-secondary: #a8c0e8;
            --theme-text-tertiary: #7a9cd1;
            
            --theme-border: #2438a8;
            --shadow-colored: 0 10px 40px -10px rgba(37, 99, 235, 0.6);
            --theme-shadow: 0 4px 12px rgba(0,0,0,0.7);
            
            --primary-color: #2563eb;
            --secondary-color: #1d4ed8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: var(--theme-bg-primary);
            color: var(--theme-text-primary);
            height: 100%;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        html {
            height: 100%;
        }

        /* ÿÆŸÑŸÅŸäÿ© ŸÖÿ™ÿ≠ÿ±ŸÉÿ© */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: var(--theme-bg-primary);
            transition: all 0.3s ease;
        }

        .animated-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
            opacity: 0.7;
        }

        [data-theme="light"] .animated-bg::before {
            opacity: 0.1;
        }

        [data-theme="light"] .custom-titlebar {
            background: rgba(250, 250, 248, 0.98);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(25px);
        }

        [data-theme="light"] .titlebar-clock {
            background: rgba(102, 126, 234, 0.08);
            border: 1px solid rgba(102, 126, 234, 0.2);
            color: #1a1a1a;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(1deg); }
            66% { transform: translateY(10px) rotate(-1deg); }
        }

        /* ÿ™ÿµŸÖŸäŸÖ ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿπÿßŸÖ ŸÑŸÉŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) transparent;
        }

        *::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        *::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            margin: 4px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        *::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, 
                #667eea 0%, 
                #764ba2 40%,
                #f093fb 70%,
                #667eea 100%);
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 0 6px rgba(102, 126, 234, 0.4),
                inset 0 0 6px rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        *::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, 
                #f093fb 0%, 
                #764ba2 40%,
                #667eea 70%,
                #f093fb 100%);
            box-shadow: 
                0 0 16px rgba(102, 126, 234, 0.9),
                inset 0 0 8px rgba(255, 255, 255, 0.3);
            border-width: 1px;
            transform: scaleX(1.1);
        }

        *::-webkit-scrollbar-thumb:active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 
                0 0 20px rgba(102, 126, 234, 1),
                inset 0 0 10px rgba(255, 255, 255, 0.4);
        }

        *::-webkit-scrollbar-corner {
            background: transparent;
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ≥ŸÑÿ≥ */
        * {
            scroll-behavior: smooth;
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ŸÜÿ®ÿ∂ ŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± */
        @keyframes scrollbarPulse {
            0%, 100% {
                box-shadow: 0 0 6px rgba(102, 126, 234, 0.4);
            }
            50% {
                box-shadow: 0 0 12px rgba(102, 126, 234, 0.8);
            }
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿ™ŸàŸáÿ¨ ŸÖÿ™ÿ≠ÿ±ŸÉ ŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± */
        @keyframes scrollbarGlow {
            0% {
                box-shadow: 
                    0 0 6px rgba(102, 126, 234, 0.4),
                    0 0 12px rgba(102, 126, 234, 0.2);
            }
            50% {
                box-shadow: 
                    0 0 12px rgba(102, 126, 234, 0.6),
                    0 0 20px rgba(102, 126, 234, 0.4);
            }
            100% {
                box-shadow: 
                    0 0 6px rgba(102, 126, 234, 0.4),
                    0 0 12px rgba(102, 126, 234, 0.2);
            }
        }

        /* ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ™ŸàŸáÿ¨ ÿπŸÑŸâ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑŸÜÿ¥ÿ∑ */
        *::-webkit-scrollbar-thumb:hover {
            animation: scrollbarGlow 2s ease-in-out infinite;
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿÆÿµÿµ */
        .custom-titlebar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: var(--theme-bg-secondary);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 10000;
            -webkit-app-region: drag;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            direction: ltr;
        }

        .titlebar-left {
            display: flex;
            align-items: center;
            gap: 15px;
            -webkit-app-region: no-drag;
            min-width: 250px;
        }

        .titlebar-controls {
            display: flex;
            gap: 10px;
        }

        .titlebar-btn {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.25s ease;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            color: white;
        }

        .titlebar-btn i {
            z-index: 1;
            font-size: 14px;
        }

        .titlebar-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        .titlebar-btn:active {
            transform: translateY(0);
        }

        .titlebar-btn.close {
            background: linear-gradient(135deg, #ff5f57 0%, #ff3b30 100%);
        }

        .titlebar-btn.close:hover {
            background: linear-gradient(135deg, #ff3b30 0%, #e62117 100%);
            box-shadow: 0 4px 14px rgba(255, 59, 48, 0.7);
        }

        .titlebar-btn.minimize {
            background: linear-gradient(135deg, #ffbd2e 0%, #ffaa00 100%);
        }

        .titlebar-btn.minimize:hover {
            background: linear-gradient(135deg, #ffaa00 0%, #ff9500 100%);
            box-shadow: 0 4px 14px rgba(255, 170, 0, 0.7);
        }

        .titlebar-btn.maximize {
            background: linear-gradient(135deg, #28ca42 0%, #00d844 100%);
        }

        .titlebar-btn.maximize:hover {
            background: linear-gradient(135deg, #00d844 0%, #00c73c 100%);
            box-shadow: 0 4px 14px rgba(0, 216, 68, 0.7);
        }

        .titlebar-center {
            display: flex;
            align-items: center;
            gap: 20px;
            flex: 1;
            justify-content: center;
        }

        .titlebar-logo {
            width: 24px;
            height: 24px;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .titlebar-title {
            font-size: 0.9rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            user-select: none;
            white-space: nowrap;
        }

        .titlebar-right {
            display: flex;
            align-items: center;
            gap: 12px;
            -webkit-app-region: no-drag;
            min-width: 250px;
            justify-content: flex-end;
        }

        .titlebar-clock {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            background: var(--theme-bg-primary);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Cairo', monospace;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .titlebar-clock i {
            color: var(--primary-color);
        }

        .titlebar-refresh {
            padding: 6px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .titlebar-refresh:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }

        .titlebar-refresh:active {
            transform: translateY(0);
        }

        .titlebar-refresh i {
            transition: transform 0.6s ease;
        }

        .titlebar-refresh:hover i {
            transform: rotate(360deg);
        }

        /* ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ™ÿ±ÿ≠Ÿäÿ® */
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .welcome-overlay.fade-out {
            animation: fadeOut 0.3s ease;
            opacity: 0;
        }

        .welcome-card {
            background: var(--theme-bg-primary);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            max-width: 600px;
            width: 90%;
            overflow: hidden;
            animation: slideUp 0.4s ease;
            border: 1px solid var(--theme-border-color);
        }

        .welcome-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            text-align: center;
        }

        .welcome-header h2 {
            color: white;
            margin: 0;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .welcome-body {
            padding: 30px;
            text-align: center;
        }

        .welcome-body > p {
            color: var(--theme-text-primary);
            font-size: 1.1rem;
            margin-bottom: 25px;
        }

        .welcome-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .welcome-feature {
            background: var(--theme-bg-secondary);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid var(--theme-border-color);
            transition: all 0.3s ease;
        }

        .welcome-feature:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.2);
            border-color: var(--primary-color);
        }

        .welcome-feature span {
            font-size: 2rem;
            display: block;
            margin-bottom: 8px;
        }

        .welcome-feature p {
            color: var(--theme-text-primary);
            font-size: 0.9rem;
            margin: 0;
            font-weight: 500;
        }

        .welcome-note {
            background: var(--info-color);
            background: linear-gradient(135deg, var(--info-color), var(--primary-color));
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            margin: 20px 0 10px 0 !important;
        }

        .welcome-hint {
            color: var(--theme-text-secondary);
            font-size: 0.85rem;
            margin: 5px 0 0 0 !important;
        }

        .welcome-footer {
            padding: 20px 30px 30px;
            text-align: center;
        }

        .welcome-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 40px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .welcome-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 28px rgba(102, 126, 234, 0.6);
        }

        .welcome-btn:active {
            transform: translateY(0);
        }

        /* Toast Notifications */
        .toast-notification {
            position: fixed;
            top: 60px;
            right: 20px;
            background: var(--theme-bg-secondary);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            padding: 16px 20px;
            min-width: 300px;
            max-width: 400px;
            z-index: 9999;
            transform: translateX(120%);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--theme-border-color);
        }

        .toast-notification.show {
            transform: translateX(0);
        }

        .toast-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toast-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .toast-message {
            color: var(--theme-text-primary);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .toast-success {
            border-right: 4px solid var(--success-color);
        }

        .toast-error {
            border-right: 4px solid var(--danger-color);
        }

        .toast-warning {
            border-right: 4px solid var(--warning-color);
        }

        .toast-info {
            border-right: 4px solid var(--info-color);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© */
        .quick-stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, 
                var(--theme-bg-secondary) 0%, 
                var(--theme-bg-primary) 100%);
            border-radius: 16px;
            margin-bottom: 1.5rem;
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .quick-stat-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.2rem;
            background: linear-gradient(135deg, 
                var(--theme-bg-card) 0%, 
                rgba(102, 126, 234, 0.02) 100%);
            border-radius: 14px;
            border: 1px solid var(--theme-border-color);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quick-stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.1) 0%, 
                rgba(118, 75, 162, 0.05) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .quick-stat-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, 
                rgba(255, 255, 255, 0.1) 0%, 
                transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .quick-stat-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 
                0 12px 28px rgba(102, 126, 234, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .quick-stat-card:hover::before {
            opacity: 1;
        }

        .quick-stat-card:hover::after {
            opacity: 1;
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        .quick-stat-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            color: white;
            flex-shrink: 0;
            position: relative;
            z-index: 2;
            box-shadow: 
                0 6px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .quick-stat-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: inherit;
            border-radius: inherit;
            filter: blur(8px);
            opacity: 0.6;
            z-index: -1;
        }

        .quick-stat-card:hover .quick-stat-icon {
            transform: scale(1.15) rotate(8deg);
            box-shadow: 
                0 8px 24px rgba(0, 0, 0, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.3);
        }

        .products-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #8b5cf6 100%);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .value-icon {
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }

        .debts-icon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 50%, #b45309 100%);
            box-shadow: 0 6px 16px rgba(245, 158, 11, 0.4);
        }

        .debtors-icon {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
            box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4);
        }

        .debt-value-icon {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 50%, #be185d 100%);
            box-shadow: 0 6px 16px rgba(236, 72, 153, 0.4);
        }

        .quick-stat-info {
            flex: 1;
            position: relative;
            z-index: 2;
        }

        .quick-stat-label {
            font-size: 0.85rem;
            color: var(--theme-text-secondary);
            margin-bottom: 0.4rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }

        .quick-stat-card:hover .quick-stat-label {
            color: var(--primary-color);
        }

        .quick-stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, 
                var(--theme-text-primary) 0%, 
                var(--primary-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
            position: relative;
            z-index: 1;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .quick-stat-card:hover .quick-stat-value {
            transform: scale(1.08);
            filter: drop-shadow(0 4px 8px rgba(102, 126, 234, 0.3));
            animation: valueGlow 1s ease-in-out infinite;
        }

        @keyframes valueGlow {
            0%, 100% {
                filter: drop-shadow(0 4px 8px rgba(102, 126, 234, 0.3));
            }
            50% {
                filter: drop-shadow(0 6px 12px rgba(102, 126, 234, 0.5));
            }
        }

        /* ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑÿ≥ÿßÿπÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ© */
        .digital-clock-card {
            grid-column: span 2;
            background: linear-gradient(135deg, #1a1f3a 0%, #2d1b4e 50%, #1a1f3a 100%);
            border: 2px solid rgba(102, 126, 234, 0.3);
            padding: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 0 60px rgba(102, 126, 234, 0.1);
        }

        .digital-clock-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 30% 50%, rgba(102, 126, 234, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 70% 50%, rgba(118, 75, 162, 0.2) 0%, transparent 50%);
            animation: clockPulse 6s ease-in-out infinite;
        }

        .digital-clock-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.03) 50%, 
                transparent 70%);
            animation: shine 3s linear infinite;
        }

        @keyframes clockPulse {
            0%, 100% {
                transform: scale(1) rotate(0deg);
                opacity: 0.4;
            }
            50% {
                transform: scale(1.2) rotate(5deg);
                opacity: 0.7;
            }
        }

        @keyframes shine {
            0% {
                transform: translateX(-100%) translateY(-100%) rotate(45deg);
            }
            100% {
                transform: translateX(100%) translateY(100%) rotate(45deg);
            }
        }

        .digital-clock {
            width: 100%;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .clock-time {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #ffffff 0%, #a8b3ff 50%, #ffffff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-family: 'Courier New', monospace;
            letter-spacing: 0.15em;
            text-shadow: 
                0 0 20px rgba(168, 179, 255, 0.5),
                0 0 40px rgba(102, 126, 234, 0.3);
            margin-bottom: 1rem;
            animation: clockGlow 3s ease-in-out infinite;
            filter: drop-shadow(0 4px 12px rgba(102, 126, 234, 0.5));
            position: relative;
        }

        .clock-time::before {
            content: attr(data-time);
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(8px);
            opacity: 0.5;
            z-index: -1;
        }

        @keyframes clockGlow {
            0%, 100% {
                filter: drop-shadow(0 4px 12px rgba(102, 126, 234, 0.5));
            }
            50% {
                filter: drop-shadow(0 6px 20px rgba(102, 126, 234, 0.8));
            }
        }

        .clock-date {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.95);
            font-weight: 600;
            flex-wrap: wrap;
        }

        .clock-date span {
            padding: 0.5rem 1.2rem;
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.2) 0%, 
                rgba(118, 75, 162, 0.2) 100%);
            border-radius: 12px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(168, 179, 255, 0.3);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .clock-date span::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.2) 50%, 
                transparent 100%);
            transition: left 0.6s ease;
        }

        .clock-date span:hover::before {
            left: 100%;
        }

        .clock-date span:hover {
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.4) 0%, 
                rgba(118, 75, 162, 0.4) 100%);
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 6px 20px rgba(102, 126, 234, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border-color: rgba(168, 179, 255, 0.5);
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ≠ÿ±ŸÉÿ© ŸÑŸÑÿ•ÿπÿØÿßÿØÿßÿ™ */
        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .clock-date span:active {
            transform: translateY(-1px) scale(1.02);
        }

        /* ÿπÿØÿßÿØ ÿßŸÑÿ≥ŸÑÿ© ŸÅŸä ÿßŸÑÿ™ÿ±ŸàŸäÿ≥ÿ© */
        .cart-header {
            position: relative;
        }

        .cart-badge-info {
            display: flex;
            gap: 0.8rem;
            margin-right: auto;
        }

        .cart-mini-stat {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.8rem;
            background: var(--primary-color);
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: white;
        }

        .cart-mini-stat.total-price {
            background: var(--success-color);
        }

        /* ÿßÿ≥ÿ™ÿ¨ÿßÿ®ÿ© ŸÑŸÑÿ¥ÿßÿ¥ÿßÿ™ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© */
        @media (max-width: 1400px) {
            .digital-clock-card {
                grid-column: span 1;
            }
            
            .clock-time {
                font-size: 2rem;
            }
        }

        @media (max-width: 768px) {
            .quick-stats-bar {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .digital-clock-card {
                grid-column: span 2;
            }
        }

        /* ÿßŸÑÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
            padding-top: 40px;
        }

        /* ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä */
        .sidebar {
            width: 280px;
            background: var(--theme-bg-secondary);
            backdrop-filter: blur(20px);
            border-left: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: none;
            position: relative;
            z-index: 100;
            transform: translateX(0);
            padding-top: 0;
        }

        .sidebar.collapsed {
            width: 80px;
        }
        
        .sidebar.collapsed .nav-icon {
            margin-left: 0;
        }

        .sidebar.collapsed .nav-text,
        .sidebar.collapsed .logo p,
        .sidebar.collapsed .nav-section-title {
            opacity: 0;
            transform: translateX(-20px);
        }

        .sidebar.collapsed .logo h1 {
            font-size: 1rem;
        }

        /* ÿ±ÿ£ÿ≥ ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä - ŸÖÿÆŸÅŸä */
        .sidebar-header {
            display: none;
        }

        /* ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ™ŸÜŸÇŸÑ */
        .nav-menu {
            flex: 1;
            padding: 2rem 0 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .nav-menu::-webkit-scrollbar {
            width: 6px;
        }

        .nav-menu::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin: 8px 0;
        }

        .nav-menu::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .nav-menu::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            box-shadow: 0 0 8px var(--primary-color);
        }

        .nav-section {
            margin-bottom: 2rem;
        }

        .nav-section-title {
            padding: 0 1.5rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--theme-text-secondary);
            transition: all 0.3s ease;
        }

        .nav-item {
            margin: 0.25rem 1rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 1rem 1.25rem;
            color: var(--theme-text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .nav-link:hover::before,
        .nav-link.active::before {
            left: 0;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--text-primary);
            transform: translateX(8px);
            box-shadow: var(--shadow-md);
        }

        .sidebar.collapsed .nav-link:hover,
        .sidebar.collapsed .nav-link.active {
            transform: translateX(0) scale(1.1);
        }

        .nav-icon {
            width: 20px;
            margin-left: 1rem;
            font-size: 1.125rem;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .nav-link:hover .nav-icon {
            transform: scale(1.1);
        }

        .nav-text {
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        /* ÿ≤ÿ± ÿßŸÑÿ™ÿ®ÿØŸäŸÑ */
        .sidebar-toggle {
            position: absolute;
            top: 15px;
            left: -20px;
            background: var(--theme-bg-secondary);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--theme-text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
            z-index: 101;
        }

        .sidebar-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-lg);
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }
        
        [data-theme="light"] .sidebar-toggle {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            color: #4a5568;
        }
        
        [data-theme="light"] .sidebar-toggle:hover {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }

        /* ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÑŸàŸä */
        .top-bar {
            background: var(--theme-bg-secondary);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-sm);
            position: relative;
            z-index: 50;
        }

        .page-title {
            font-size: 1.75rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .top-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* ŸÖŸÅÿ™ÿßÿ≠ ÿßŸÑÿ´ŸäŸÖ */
        .theme-toggle {
            background: var(--theme-bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--theme-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        /* ÿßŸÑÿ®ÿ≠ÿ´ */
        .search-box {
            position: relative;
        }

        .search-input {
            background: var(--theme-bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 0.75rem 1rem 0.75rem 3rem;
            color: var(--theme-text-primary);
            font-size: 0.875rem;
            width: 300px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--theme-text-secondary);
        }

        /* ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ */
        .notification-btn {
            position: relative;
            background: var(--theme-bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--theme-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .notification-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        /* ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ */
        .page-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background: var(--theme-bg-primary);
        }

        .page {
            display: none !important;
            height: 100%;
        }

        .page.active {
            display: block !important;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ */
        .pos-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            height: 100%;
        }

        .products-section {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            gap: 1rem;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--theme-text-primary);
        }
        
        /* ÿÆÿßŸÜÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ */
        .pos-search-box {
            position: relative;
            flex: 1;
            max-width: 350px;
        }
        
        .pos-search-box i {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--theme-text-secondary);
            font-size: 0.9rem;
            pointer-events: none;
            z-index: 1;
        }
        
        .pos-search-input {
            width: 100%;
            background: var(--theme-bg-secondary);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            color: var(--theme-text-primary);
            font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Cairo', sans-serif;
        }
        
        .pos-search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            background: var(--theme-bg-card);
        }
        
        .pos-search-input::placeholder {
            color: var(--theme-text-secondary);
            opacity: 0.7;
        }
        
        [data-theme="light"] .pos-search-input {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            color: #1a202c;
        }
        
        [data-theme="light"] .pos-search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
            background: #ffffff;
        }
        
        [data-theme="light"] .pos-search-box i {
            color: #718096;
        }
        
        @media (max-width: 768px) {
            .section-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .pos-search-box {
                max-width: 100%;
            }
        }

        /* ŸÅŸÑÿßÿ™ÿ± ÿßŸÑŸÅÿ¶ÿßÿ™ */
        .category-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .category-btn {
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 0.5rem 1rem;
            color: var(--theme-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .category-btn:hover,
        .category-btn.active {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* ÿ¥ÿ®ŸÉÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1.5rem;
            max-height: calc(100% - 120px);
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .products-grid::-webkit-scrollbar {
            width: 12px;
        }

        .products-grid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            margin: 10px 0;
        }

        .products-grid::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, 
                #667eea 0%, 
                #764ba2 50%, 
                #f093fb 100%);
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 0 8px rgba(102, 126, 234, 0.5),
                inset 0 0 6px rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .products-grid::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, 
                #f093fb 0%, 
                #764ba2 50%, 
                #667eea 100%);
            box-shadow: 
                0 0 16px rgba(102, 126, 234, 0.9),
                inset 0 0 8px rgba(255, 255, 255, 0.3);
            transform: scaleX(1.15);
        }

        .products-grid::-webkit-scrollbar-thumb:active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 0 20px rgba(102, 126, 234, 1);
        }

        /* ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ */
        .product-card {
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: -1;
        }

        .product-card:hover::before {
            left: 0;
            opacity: 0.1;
        }

        .product-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .product-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .product-name {
            font-weight: 600;
            color: var(--theme-text-primary);
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .product-price {
            color: var(--success-color);
            font-size: 1rem;
            font-weight: 700;
        }

        .product-stock {
            font-size: 0.75rem;
            color: var(--theme-text-secondary);
            margin-top: 0.25rem;
        }

        /* ÿ≥ŸÑÿ© ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™ */
        .cart-section {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
            position: relative;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            overflow: hidden;
        }

        /* ÿÆŸÑŸÅŸäÿ© ŸÖÿ™ÿ≠ÿ±ŸÉÿ© ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä */
        .cart-section:not(:hover)::after {
            background: linear-gradient(
                180deg,
                transparent 0%,
                rgba(99, 102, 241, 0.03) 50%,
                transparent 100%
            );
        }

        /* ŸÖÿ§ÿ¥ÿ± ŸÑŸÑÿ™ŸÅÿßÿπŸÑ */
        .cart-section::before {
            content: 'üëÜ ŸÖÿ±ÿ± ŸÑÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ';
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.95), rgba(139, 92, 246, 0.95));
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.72rem;
            opacity: 0.9;
            transition: all 0.4s ease;
            pointer-events: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            animation: pulseHint 2s ease-in-out infinite;
            z-index: 2;
        }

        /* ŸÖÿ§ÿ¥ÿ± ÿπÿ±ÿ∂ ÿ¢ÿÆÿ± ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ */
        .cart-section::after {
            content: '‚¨áÔ∏è ÿπÿ±ÿ∂ ÿ¢ÿÆÿ± ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™';
            position: absolute;
            bottom: 180px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.9), rgba(16, 185, 129, 0.9));
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.75rem;
            opacity: 0;
            transition: all 0.4s ease;
            pointer-events: none;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
            z-index: 2;
            white-space: nowrap;
        }

        /* ÿ•ÿ∏Ÿáÿßÿ± ŸÖÿ§ÿ¥ÿ± ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ÿπŸÜÿØŸÖÿß ŸÑÿß ŸäŸÉŸàŸÜ hover */
        .cart-section:not(:hover)::after {
            opacity: 0.9;
            animation: slideUpDown 2s ease-in-out infinite;
        }

        @keyframes slideUpDown {
            0%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            50% {
                transform: translateX(-50%) translateY(5px);
            }
        }

        @keyframes pulseHint {
            0%, 100% {
                transform: scale(1);
                opacity: 0.9;
            }
            50% {
                transform: scale(1.05);
                opacity: 1;
            }
        }

        .cart-section:hover::before {
            opacity: 0;
            transform: scale(0.8) translateY(-10px);
        }

        .cart-section:hover::after {
            opacity: 0;
            transform: scale(0.8) translateY(10px);
        }

        /* ÿ•ÿÆŸÅÿßÿ° ÿßŸÑÿπŸÜÿßÿµÿ± ÿ®ÿ¥ŸÉŸÑ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä */
        .cart-section .cart-header,
        .cart-section .remove-btn,
        .cart-section .quantity-controls,
        .cart-section .cart-summary,
        .cart-section .checkout-btn,
        .cart-section .cart-actions {
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        /* ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿπŸÜÿßÿµÿ± ÿπŸÜÿØ hover */
        .cart-section:hover .cart-header,
        .cart-section:hover .remove-btn,
        .cart-section:hover .quantity-controls,
        .cart-section:hover .cart-summary,
        .cart-section:hover .checkout-btn,
        .cart-section:hover .cart-actions {
            opacity: 1;
            pointer-events: all;
        }

        /* ÿπÿ±ÿ∂ ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿØÿßÿ¶ŸÖÿßŸã */
        .cart-section .cart-count {
            opacity: 1 !important;
            pointer-events: all !important;
        }

        .cart-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .cart-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        .cart-count {
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 1.5rem;
            max-height: 300px;
            transition: all 0.3s ease;
            padding-left: 8px;
            position: relative;
            scroll-behavior: smooth;
        }

        /* ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿØÿßÿ¶ŸÖ ÿßŸÑÿ∏ŸáŸàÿ± ŸÖÿπ ÿ™ÿ£ÿ´Ÿäÿ± hover */
        .cart-items::-webkit-scrollbar {
            width: 10px;
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ∏ŸÑ ÿπŸÜÿØ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± */
        .cart-items::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(to bottom, 
                var(--theme-bg-card) 0%, 
                transparent 100%);
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .cart-items::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 30px;
            background: linear-gradient(to top, 
                var(--theme-bg-card) 0%, 
                transparent 100%);
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ∏ŸÑÿßŸÑ ÿπŸÜÿØ Ÿàÿ¨ŸàÿØ ŸÖÿ≠ÿ™ŸàŸâ ŸÑŸÑÿ™ŸÖÿ±Ÿäÿ± */
        .cart-items.has-scroll::before,
        .cart-items.has-scroll::after {
            opacity: 1;
        }

        /* ÿ™ÿµŸÖŸäŸÖ Scrollbar ÿ¨ŸÖŸäŸÑ Ÿàÿπÿµÿ±Ÿä */
        .cart-items::-webkit-scrollbar {
            width: 10px;
        }

        .cart-items::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin: 8px 0;
            box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.1);
        }

        .cart-items::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 0 0 6px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
        }

        .cart-items::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #f093fb 0%, #764ba2 50%, #667eea 100%);
            box-shadow: 0 0 12px rgba(102, 126, 234, 0.8);
            transform: scaleX(1.2);
        }

        .cart-items::-webkit-scrollbar-thumb:active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 0 16px rgba(102, 126, 234, 1);
        }

        /* ÿ™Ÿàÿ≥Ÿäÿπ ÿßŸÑÿ≥ŸÑÿ© ÿπŸÜÿØ hover */
        .cart-section:hover {
            box-shadow: 0 12px 40px rgba(99, 102, 241, 0.3);
            border-color: var(--primary-color);
            transform: scale(1.02);
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿ∂Ÿàÿ° ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ© ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± */
        .cart-section:not(:hover) {
            animation: subtleGlow 3s ease-in-out infinite;
        }

        @keyframes subtleGlow {
            0%, 100% {
                box-shadow: var(--shadow-md);
            }
            50% {
                box-shadow: 0 8px 25px rgba(99, 102, 241, 0.2);
            }
        }

        /* ÿ•ÿ®ŸÇÿßÿ° ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ∏ÿßŸáÿ±ÿ© ÿØÿßÿ¶ŸÖÿßŸã */
        .cart-section .cart-items {
            opacity: 1 !important;
        }

        .cart-section .cart-item {
            opacity: 1 !important;
        }

        .cart-empty {
            text-align: center;
            color: var(--theme-text-secondary);
            padding: 3rem 1rem;
            opacity: 1 !important;
        }

        .cart-empty i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .cart-item {
            background: var(--theme-bg-secondary);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0.95;
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ± ÿπŸÜÿØŸÖÿß ŸäŸÉŸàŸÜ ÿßŸÑŸÖÿ§ÿ¥ÿ± ÿ®ÿπŸäÿØÿßŸã - ÿßŸÑÿ™ÿ±ŸÉŸäÿ≤ ÿπŸÑŸâ ÿßŸÑÿ£ÿ≥ŸÅŸÑ */
        .cart-section:not(:hover) .cart-item {
            opacity: 0.3;
            transform: scale(0.95);
            transition: all 0.4s ease;
            filter: blur(0.5px);
        }

        /* ÿßŸÑÿπŸÜÿßÿµÿ± ÿßŸÑÿ£ÿÆŸäÿ±ÿ© ÿ™ŸÉŸàŸÜ ÿ£Ÿàÿ∂ÿ≠ Ÿàÿ£ŸÉÿ®ÿ± */
        .cart-section:not(:hover) .cart-item:last-child {
            opacity: 1 !important;
            transform: scale(1) !important;
            filter: none !important;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);
        }

        .cart-section:not(:hover) .cart-item:nth-last-child(2) {
            opacity: 0.7;
            transform: scale(0.98);
            filter: blur(0.2px);
        }

        .cart-section:not(:hover) .cart-item:nth-last-child(3) {
            opacity: 0.5;
            transform: scale(0.96);
            filter: blur(0.4px);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸàÿ∂Ÿàÿ≠ ÿπŸÜÿØ hover - ŸÉŸÑ ÿßŸÑÿπŸÜÿßÿµÿ± Ÿàÿßÿ∂ÿ≠ÿ© */
        .cart-section:hover .cart-item {
            opacity: 1 !important;
            transform: scale(1) !important;
            filter: none !important;
        }

        /* ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ */
        .cart-item::before {
            content: 'üì¶';
            font-size: 2rem;
            min-width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border-radius: 12px;
            border: 2px solid rgba(99, 102, 241, 0.3);
            transition: all 0.3s ease;
        }

        .cart-section:hover .cart-item::before {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
        }

        /* ÿ≠ÿ±ŸÉÿ© ÿ®ÿ≥Ÿäÿ∑ÿ© ŸÑŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä */
        .cart-section:not(:hover) .cart-item::before {
            animation: iconFloat 3s ease-in-out infinite;
        }

        @keyframes iconFloat {
            0%, 100% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-3px) rotate(-3deg);
            }
        }

        /* ÿ™ÿ∫ŸäŸäÿ± ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ŸÜŸàÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ */
        .cart-item[data-category="laptops"]::before {
            content: 'üíª';
        }

        .cart-item[data-category="phones"]::before {
            content: 'üì±';
        }

        .cart-item[data-category="accessories"]::before {
            content: 'üéß';
        }

        /* ÿ™ÿÆÿ∑Ÿäÿ∑ ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ */
        .cart-item-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* ÿ•ÿ®ŸÇÿßÿ° ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∏ÿßŸáÿ±ÿßŸã ÿØÿßÿ¶ŸÖÿßŸã */
        .cart-item .item-info {
            opacity: 1 !important;
        }

        .cart-item .item-info h4 {
            opacity: 1 !important;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--theme-text-primary);
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ÿ¥ÿßÿ±ÿ© ÿßŸÑŸÉŸÖŸäÿ© ÿπŸÜÿØŸÖÿß ŸäŸÉŸàŸÜ ÿßŸÑŸÖÿ§ÿ¥ÿ± ÿ®ÿπŸäÿØÿßŸã */
        .cart-section:not(:hover) .cart-item .item-info h4::after {
            content: attr(data-quantity) 'x';
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-right: 8px;
        }

        /* ÿ•ÿÆŸÅÿßÿ° ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÅÿ±ÿØŸä ÿπŸÜÿØŸÖÿß ŸÑÿß ŸäŸàÿ¨ÿØ hover */
        .cart-section:not(:hover) .item-price {
            opacity: 0;
            height: 0;
            margin: 0;
            overflow: hidden;
        }

        .cart-item:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .item-info h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--theme-text-primary);
            margin-bottom: 0.25rem;
        }

        .item-price {
            font-size: 0.8rem;
            color: var(--success-color);
            font-weight: 500;
        }

        .remove-btn {
            background: var(--danger-gradient);
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .remove-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .qty-controls {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--theme-bg-card);
            border-radius: var(--border-radius-lg);
            padding: 0.5rem;
        }

        .qty-btn {
            background: var(--primary-color);
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .qty-btn:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }

        .quantity {
            font-weight: 600;
            color: var(--theme-text-primary);
            min-width: 30px;
            text-align: center;
        }

        .item-total {
            font-weight: 700;
            color: var(--success-color);
            font-size: 0.9rem;
        }

        /* ŸÖŸÑÿÆÿµ ÿßŸÑÿ≥ŸÑÿ© */
        .cart-summary {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 1.5rem;
        }

        .discount-section {
            margin-bottom: 1rem;
        }

        .discount-input {
            width: 100%;
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 0.75rem;
            color: var(--theme-text-primary);
            font-size: 0.875rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .discount-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            font-size: 0.9rem;
            color: var(--theme-text-primary);
        }

        .summary-row.total {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--theme-text-primary);
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 0.75rem;
            margin-top: 1rem;
        }

        .summary-value {
            font-weight: 600;
        }

        /* ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ */
        .payment-methods {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin: 1.5rem 0;
        }

        .payment-btn {
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 1rem;
            color: var(--theme-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .payment-btn i {
            font-size: 1.5rem;
        }

        .payment-btn:hover,
        .payment-btn.selected {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* ÿ≤ÿ± ÿßŸÑÿØŸÅÿπ */
        .checkout-btn {
            width: 100%;
            background: var(--success-gradient);
            border: none;
            border-radius: var(--border-radius);
            padding: 1rem;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .checkout-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .checkout-btn:disabled {
            background: var(--theme-bg-secondary);
            color: var(--theme-text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        /* ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ */
        .settings-card {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.5s ease forwards;
            opacity: 0;
        }
        
        .settings-card:nth-child(1) { animation-delay: 0.1s; }
        .settings-card:nth-child(2) { animation-delay: 0.2s; }
        .settings-card:nth-child(3) { animation-delay: 0.3s; }
        .settings-card:nth-child(4) { animation-delay: 0.4s; }
        .settings-card:nth-child(5) { animation-delay: 0.5s; }
        .settings-card:nth-child(6) { animation-delay: 0.6s; }

        .settings-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .settings-card:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .settings-card:hover::before {
            transform: scaleY(1);
        }

        .settings-card-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .settings-card:hover .settings-card-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .settings-card-icon.store-icon {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(16, 185, 129, 0.2));
            color: #22c55e;
        }

        .settings-card-icon.system-icon {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            color: #6366f1;
        }

        .settings-card-icon.backup-icon {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(37, 99, 235, 0.2));
            color: #3b82f6;
        }

        .settings-card-icon.notifications-icon {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2));
            color: #fbbf24;
        }

        .settings-card-icon.printing-icon {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(147, 51, 234, 0.2));
            color: #a855f7;
        }

        .settings-card-icon.security-icon {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(220, 38, 38, 0.2));
            color: #ef4444;
        }

        .settings-card-content {
            flex: 1;
        }

        .settings-card-content h3 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--theme-text-primary);
        }

        .settings-card-content p {
            font-size: 0.9rem;
            color: var(--theme-text-secondary);
            line-height: 1.5;
        }

        .settings-card-arrow {
            color: var(--theme-text-secondary);
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .settings-card:hover .settings-card-arrow {
            transform: translateX(-5px);
            color: var(--primary-color);
        }

        /* ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿµÿ∫ÿ±ÿ© */
        .info-mini-card {
            background: var(--theme-bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 2px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: slideInFromRight 0.5s ease forwards;
            opacity: 0;
        }
        
        .info-mini-card:nth-child(1) { animation-delay: 0.1s; }
        .info-mini-card:nth-child(2) { animation-delay: 0.2s; }
        .info-mini-card:nth-child(3) { animation-delay: 0.3s; }
        .info-mini-card:nth-child(4) { animation-delay: 0.4s; }

        .info-mini-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .info-mini-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.1);
        }

        .info-mini-card:hover::before {
            transform: scaleX(1);
        }

        .info-mini-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .info-mini-content {
            flex: 1;
        }

        .info-mini-label {
            font-size: 0.85rem;
            color: var(--theme-text-secondary);
            margin-bottom: 0.3rem;
        }

        .info-mini-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--theme-text-primary);
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ÿ®ÿ∑ÿßŸÇÿßÿ™ ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ÿπŸÑŸâ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ */
        .stat-overview-card {
            background: var(--theme-bg-card);
            border-radius: 16px;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.05);
            transition: all 0.3s ease;
            animation: slideInUp 0.6s ease forwards;
            opacity: 0;
        }
        
        .stat-overview-card:nth-child(1) { animation-delay: 0.2s; }
        .stat-overview-card:nth-child(2) { animation-delay: 0.3s; }
        .stat-overview-card:nth-child(3) { animation-delay: 0.4s; }
        .stat-overview-card:nth-child(4) { animation-delay: 0.5s; }

        .stat-overview-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.1);
        }

        .stat-overview-header {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 2px solid rgba(255,255,255,0.05);
        }

        .stat-overview-icon {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .stat-overview-header h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--theme-text-primary);
            margin: 0;
        }

        .stat-overview-body {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .stat-overview-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .stat-overview-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .stat-overview-item span {
            font-size: 0.9rem;
            color: var(--theme-text-secondary);
        }

        .stat-overview-item strong {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        /* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© */
        .quick-action-btn {
            padding: 1.2rem 1.5rem;
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.5s ease forwards;
            opacity: 0;
        }
        
        .quick-action-btn:nth-child(1) { animation-delay: 0.6s; }
        .quick-action-btn:nth-child(2) { animation-delay: 0.7s; }
        .quick-action-btn:nth-child(3) { animation-delay: 0.8s; }
        .quick-action-btn:nth-child(4) { animation-delay: 0.9s; }

        .quick-action-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .quick-action-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .quick-action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .quick-action-btn:active {
            transform: translateY(-1px);
        }

        .quick-action-btn i {
            font-size: 1.2rem;
            position: relative;
            z-index: 1;
        }

        .quick-action-btn span {
            position: relative;
            z-index: 1;
        }

        /* ÿπŸÜŸàÿßŸÜ ŸÅÿ±ÿπŸä ŸÑŸÑŸÇÿ≥ŸÖ */
        .section-subtitle {
            font-size: 0.95rem;
            color: var(--theme-text-secondary);
            margin-top: 0.5rem;
        }

        /* ÿßŸÑÿ¨ÿØÿßŸàŸÑ */
        .table-container {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius-lg);
            overflow: auto;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 600px;
        }

        .table-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        .table-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, 
                #667eea 0%, 
                #764ba2 50%, 
                #f093fb 100%);
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 0 0 8px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, 
                #f093fb 0%, 
                #764ba2 50%, 
                #667eea 100%);
            box-shadow: 0 0 16px rgba(102, 126, 234, 0.9);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: var(--primary-gradient);
            color: white;
            padding: 1rem;
            text-align: right;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 0.875rem;
            color: var(--theme-text-primary);
        }

        .table tr:hover {
            background: rgba(255,255,255,0.05);
        }

        /* ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--theme-bg-secondary);
            color: var(--theme-text-secondary);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .btn-secondary:hover {
            background: var(--theme-bg-card);
            color: var(--theme-text-primary);
        }

        .btn-success {
            background: var(--success-gradient);
            color: white;
        }

        .btn-warning {
            background: var(--warning-gradient);
            color: white;
        }

        .btn-danger {
            background: var(--danger-gradient);
            color: white;
        }

        .action-btn {
            padding: 0.5rem;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.3s ease;
            margin: 0 0.25rem;
        }

        .edit-btn {
            background: var(--warning-gradient);
            color: white;
        }

        .delete-btn {
            background: var(--danger-gradient);
            color: white;
        }

        .view-btn {
            background: var(--primary-gradient);
            color: white;
        }

        .action-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--theme-bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-gradient);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--theme-text-primary);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--theme-text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
        }

        /* ÿßŸÑŸÜŸàÿßŸÅÿ∞ ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ© */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--theme-bg-card);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            max-height: 80%;
            overflow-y: auto;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.3s ease;
        }

        .modal-content::-webkit-scrollbar {
            width: 10px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin: 8px 0;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, 
                #667eea 0%, 
                #764ba2 50%, 
                #f093fb 100%);
            border-radius: 12px;
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 0 0 8px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, 
                #f093fb 0%, 
                #764ba2 50%, 
                #667eea 100%);
            box-shadow: 0 0 16px rgba(102, 126, 234, 0.9);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--theme-text-primary);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--theme-text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: var(--danger-gradient);
            color: white;
        }

        /* ÿßŸÑŸÜŸÖÿßÿ∞ÿ¨ */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--theme-text-primary);
            font-size: 0.875rem;
        }

        .form-input, .form-select {
            width: 100%;
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 0.75rem;
            color: var(--theme-text-primary);
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        /* ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑÿ∑ÿ®ÿßÿπÿ© */
        .form-range {
            width: 100%;
            height: 6px;
            background: var(--theme-bg-secondary);
            border-radius: 10px;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .form-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
            transition: all 0.2s ease;
        }

        .form-range::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.6);
        }

        .form-range::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--primary-color);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
            transition: all 0.2s ease;
        }

        .form-range::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.6);
        }

        .form-control {
            width: 100%;
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 0.75rem;
            color: var(--theme-text-primary);
            font-size: 0.875rem;
            font-family: 'Cairo', sans-serif;
            transition: all 0.3s ease;
            resize: vertical;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        /* ÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÜÿ¨ÿßÿ≠ ŸàÿßŸÑÿÆÿ∑ÿ£ */
        .success-message {
            background: var(--success-gradient);
            color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 1rem;
            display: none;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .error-message {
            background: var(--danger-gradient);
            color: white;
            padding: 1rem;
            border-radius: var(--border-radius);
            text-align: center;
            margin-bottom: 1rem;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿµÿØŸäÿ± ŸàÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ */
        .export-import-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .export-btn, .import-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .export-btn {
            background: var(--success-gradient);
            color: white;
        }

        .import-btn {
            background: var(--warning-gradient);
            color: white;
        }

        .export-btn:hover, .import-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿßŸÑŸÅÿ¶ÿßÿ™ */
        .category-icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .category-icon-btn {
            background: var(--theme-bg-secondary);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.5rem;
        }

        .category-icon-btn:hover,
        .category-icon-btn.selected {
            background: var(--primary-color);
            color: white;
            transform: scale(1.05);
        }

        /* ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ */
        .installment-form {
            background: var(--theme-bg-secondary);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            margin-top: 2rem;
            display: none;
            border: 2px solid rgba(102, 126, 234, 0.2);
            animation: slideInUp 0.4s ease;
        }
        
        /* ÿÆŸäÿßÿ±ÿßÿ™ ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ */
        .payment-options-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            padding: 1.5rem 0;
        }
        
        .payment-option-card {
            background: var(--theme-bg-secondary);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: var(--border-radius-lg);
            padding: 2.5rem 2rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .payment-option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }
        
        .payment-option-card:hover::before {
            opacity: 0.1;
        }
        
        .payment-option-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }
        
        .payment-option-card.cash-payment:hover {
            border-color: var(--success-color);
        }
        
        .payment-option-card.installment-payment:hover {
            border-color: var(--warning-color);
        }
        
        .payment-option-icon {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }
        
        .payment-option-card.cash-payment .payment-option-icon {
            background: var(--success-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .payment-option-card.installment-payment .payment-option-icon {
            background: var(--warning-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .payment-option-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--theme-text-primary);
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }
        
        .payment-option-description {
            font-size: 0.9rem;
            color: var(--theme-text-secondary);
            position: relative;
            z-index: 1;
        }
        
        /* ÿ±ÿ£ÿ≥ ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ */
        .installment-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        
        .installment-header i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .installment-header h4 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--theme-text-primary);
            margin: 0;
        }
        
        /* ÿ£ŸÇÿ≥ÿßŸÖ ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨ */
        .form-section {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255,255,255,0.05);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 1.25rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .section-title i {
            font-size: 1.1rem;
        }
        
        .form-grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .form-grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }
        
        .form-hint {
            display: block;
            font-size: 0.75rem;
            color: var(--theme-text-secondary);
            margin-top: 0.35rem;
            font-style: italic;
        }
        
        .required {
            color: var(--danger-color);
            margin-right: 0.25rem;
        }
        
        /* ŸÖŸÑÿÆÿµ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ */
        .installment-summary {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border-radius: var(--border-radius-lg);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 2px solid rgba(102, 126, 234, 0.3);
        }
        
        .summary-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--theme-text-primary);
            margin-bottom: 1.25rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        
        .summary-title i {
            font-size: 1.3rem;
            color: var(--primary-color);
        }
        
        .summary-items {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .summary-row .summary-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
            color: var(--theme-text-secondary);
        }
        
        .summary-row .summary-label i {
            width: 20px;
            text-align: center;
        }
        
        .summary-divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            margin: 0.5rem 0;
        }
        
        .summary-row.total-row {
            background: rgba(102, 126, 234, 0.15);
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-top: 0.5rem;
        }
        
        .summary-row.total-row .summary-label {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--theme-text-primary);
        }
        
        .summary-row.total-row .summary-value {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary-color);
        }
        
        .summary-row.monthly-row {
            background: var(--success-gradient);
            padding: 1rem;
            border-radius: var(--border-radius);
            color: white;
        }
        
        .summary-row.monthly-row .summary-label {
            font-size: 1rem;
            font-weight: 600;
            color: white;
        }
        
        .summary-row.monthly-row .summary-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
        }
        
        .summary-value.highlight {
            animation: pulse 2s infinite;
        }

        .installment-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ´ŸäŸÖ ÿßŸÑŸÅÿßÿ™ÿ≠ */
        [data-theme="light"] .payment-option-card {
            background: #ffffff;
            border: 2px solid #e2e8f0;
        }
        
        [data-theme="light"] .payment-option-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        [data-theme="light"] .form-section {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
        }
        
        [data-theme="light"] .installment-summary {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.08) 100%);
            border: 2px solid rgba(102, 126, 234, 0.2);
        }
        
        @media (max-width: 768px) {
            .payment-options-container {
                grid-template-columns: 1fr;
            }
            
            .form-grid-2,
            .form-grid-3 {
                grid-template-columns: 1fr;
            }
        }

        /* ÿ™ÿµŸÖŸäŸÖ ŸÖÿ™ÿ¨ÿßŸàÿ® */
        @media (max-width: 1200px) {
            .pos-layout {
                grid-template-columns: 1fr 350px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 250px;
                transform: translateX(-100%);
                position: fixed;
                z-index: 100;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .sidebar-toggle {
                display: block;
            }

            .pos-layout {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .search-input {
                width: 200px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* ÿ£ŸÜŸäŸÖŸäÿ¥ŸÜ ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä */
        @keyframes slideInLeft {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes slideOutLeft {
            from { transform: translateX(0); }
            to { transform: translateX(-100%); }
        }

        .sidebar.animating-in {
            animation: slideInLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.animating-out {
            animation: slideOutLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© */
        .text-success { color: var(--success-color); }
        .text-warning { color: var(--warning-color); }
        .text-danger { color: var(--danger-color); }
        .text-muted { color: var(--theme-text-secondary); }

        .bg-success { background: var(--success-gradient); }
        .bg-warning { background: var(--warning-gradient); }
        .bg-danger { background: var(--danger-gradient); }

        .border-success { border-color: var(--success-color); }
        .border-warning { border-color: var(--warning-color); }
        .border-danger { border-color: var(--danger-color); }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ */
        .barcode-section {
            display: flex;
            gap: 0.5rem;
            align-items: end;
        }

        .barcode-input {
            flex: 1;
        }

        .generate-barcode-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .generate-barcode-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ */
        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: var(--theme-text-secondary);
        }

        .detail-value {
            font-weight: 500;
            color: var(--theme-text-primary);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸÑÿßÿ™ÿ± */
        .filters-section {
            background: var(--theme-bg-card);
            border-radius: var(--border-radius);
            padding: 1rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ≠ÿßŸÑÿ© ÿßŸÑÿØŸäŸÜ */
        .debt-status {
            padding: 0.25rem 0.75rem;
            border-radius: var(--border-radius-lg);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .debt-status.active {
            background: var(--success-gradient);
            color: white;
        }

        .debt-status.overdue {
            background: var(--danger-gradient);
            color: white;
        }

        .debt-status.paid {
            background: var(--theme-bg-secondary);
            color: var(--theme-text-secondary);
        }
        
        /* ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´ */
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--theme-bg-card);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: var(--border-radius-lg);
            margin-top: 0.75rem;
            max-height: 500px;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(20px);
        }
        
        .search-results.active {
            display: block;
            animation: searchResultsAppear 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes searchResultsAppear {
            from {
                opacity: 0;
                transform: translateY(-15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .search-results::-webkit-scrollbar {
            width: 8px;
        }
        
        .search-results::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin: 8px 0;
        }
        
        .search-results::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .search-results::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            box-shadow: 0 0 10px var(--primary-color);
        }
        
        .search-category {
            padding: 1rem 1.25rem 0.75rem;
            border-bottom: 2px solid rgba(255,255,255,0.05);
            background: rgba(102, 126, 234, 0.03);
        }
        
        .search-category:last-child {
            border-bottom: none;
        }
        
        .search-category-title {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--primary-color);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .search-category-title i {
            font-size: 1rem;
        }
        
        .search-category-title .count {
            background: var(--primary-gradient);
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            margin-right: 0.25rem;
        }
        
        .search-result-item {
            padding: 1rem 1.25rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.03);
            position: relative;
            overflow: hidden;
        }
        
        .search-result-item::before {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--primary-gradient);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .search-result-item:hover::before {
            transform: scaleY(1);
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .search-result-item:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.05) 100%);
            transform: translateX(-4px);
            padding-right: 1.5rem;
        }
        
        .search-result-icon {
            width: 48px;
            height: 48px;
            min-width: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-gradient);
            border-radius: var(--border-radius);
            color: white;
            font-size: 1.25rem;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
        }
        
        .search-result-item:hover .search-result-icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }
        
        .search-result-info {
            flex: 1;
            min-width: 0;
        }
        
        .search-result-title {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--theme-text-primary);
            margin-bottom: 0.35rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.3s ease;
        }
        
        .search-result-item:hover .search-result-title {
            color: var(--primary-color);
        }
        
        .search-result-subtitle {
            font-size: 0.8rem;
            color: var(--theme-text-secondary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            transition: color 0.3s ease;
        }
        
        .search-result-subtitle span {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        
        .search-result-item:hover .search-result-subtitle {
            color: var(--theme-text-primary);
        }
        
        .search-result-badge {
            background: var(--theme-bg-secondary);
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--theme-text-secondary);
            white-space: nowrap;
        }
        
        .search-result-item:hover .search-result-badge {
            background: rgba(255,255,255,0.1);
            color: var(--primary-color);
        }
        
        .search-empty {
            padding: 3rem 2rem;
            text-align: center;
            color: var(--theme-text-secondary);
        }
        
        .search-empty i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.3;
            color: var(--primary-color);
        }
        
        .search-empty p {
            font-size: 0.95rem;
            font-weight: 500;
        }
        
        .search-header {
            padding: 1rem 1.25rem;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            background: var(--primary-gradient);
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .search-header i {
            margin-left: 0.5rem;
        }
        
        .search-total {
            background: rgba(255,255,255,0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿßŸÑÿ´ŸäŸÖ ÿßŸÑŸÅÿßÿ™ÿ≠ */
        [data-theme="light"] .search-results {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        
        [data-theme="light"] .search-category {
            background: #f7fafc;
        }
        
        [data-theme="light"] .search-result-item:hover {
            background: linear-gradient(90deg, rgba(102, 126, 234, 0.08) 0%, rgba(118, 75, 162, 0.03) 100%);
        }
        
        [data-theme="light"] .search-result-item:hover .search-result-title {
            color: var(--primary-color);
        }
        
        [data-theme="light"] .search-result-badge {
            background: #edf2f7;
            color: #4a5568;
        }
        
        [data-theme="light"] .search-result-item:hover .search-result-badge {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
        }
        
        .search-box {
            position: relative;
        }
        
        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ÿ®ÿßŸÑÿ´ŸäŸÖ ÿßŸÑŸÅÿßÿ™ÿ≠ */
        [data-theme="light"] .form-input,
        [data-theme="light"] .form-select {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            color: #1a202c;
        }
        
        [data-theme="light"] .form-input:focus,
        [data-theme="light"] .form-select:focus {
            border-color: var(--primary-color);
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }
        
        [data-theme="light"] .form-input::placeholder {
            color: #a0aec0;
        }
        
        [data-theme="light"] .stat-card {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            box-shadow: var(--shadow-md);
        }
        
        [data-theme="light"] .product-card {
            background: #ffffff;
            border: 1px solid #d8d8d8;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
        }
        
        [data-theme="light"] .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }
        
        [data-theme="light"] .sidebar {
            background: #fafaf8;
            border-left: 1px solid #d8d8d8;
            box-shadow: -4px 0 12px rgba(0,0,0,0.06);
        }
        
        [data-theme="light"] .nav-btn {
            color: #4a4a4a;
        }
        
        [data-theme="light"] .nav-btn:hover {
            background: #ececea;
            color: var(--primary-color);
        }
        
        [data-theme="light"] .nav-btn.active {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        [data-theme="light"] .top-bar {
            background: rgba(250, 250, 248, 0.95);
            border-bottom: 1px solid rgba(0,0,0,0.08);
            backdrop-filter: blur(25px);
        }
        
        [data-theme="light"] .modal-content {
            background: #ffffff;
            border: 1px solid #d8d8d8;
            box-shadow: var(--shadow-xl);
        }
        
        [data-theme="light"] .table {
            background: #ffffff;
        }
        
        [data-theme="light"] .table thead {
            background: #f5f5f0;
            border-bottom: 2px solid #d8d8d8;
        }
        
        [data-theme="light"] .table th {
            color: #2d3748;
            font-weight: 600;
        }
        
        [data-theme="light"] .table td {
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }
        
        [data-theme="light"] .table tbody tr:hover {
            background: #f7fafc;
        }
        
        [data-theme="light"] .cart-item {
            background: #ffffff;
            border: 1px solid #e2e8f0;
        }
        
        [data-theme="light"] .cart-item:hover {
            background: #f7fafc;
            border-color: var(--primary-color);
        }
        
        [data-theme="light"] .search-input {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            color: #1a202c;
        }
        
        [data-theme="light"] .search-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }
        
        [data-theme="light"] .category-btn {
            background: #ffffff;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }
        
        [data-theme="light"] .category-btn:hover {
            background: #edf2f7;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        [data-theme="light"] .category-btn.active {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-color: transparent;
        }
        
        [data-theme="light"] .action-btn {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #e2e8f0;
        }
        
        [data-theme="light"] .action-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.1);
        }
        
        [data-theme="light"] .action-btn.delete-btn:hover {
            background: #fc8181;
            border-color: #fc8181;
        }
        
        [data-theme="light"] .summary-card {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            box-shadow: var(--shadow-md);
        }
        
        [data-theme="light"] .summary-row {
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }
        
        [data-theme="light"] .summary-row.total {
            color: var(--primary-color);
            font-weight: bold;
            border-top: 2px solid var(--primary-color);
        }
        
        [data-theme="light"] .category-icon-btn {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            color: #4a5568;
        }
        
        [data-theme="light"] .category-icon-btn:hover {
            background: #edf2f7;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        [data-theme="light"] .category-icon-btn.selected {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-color: transparent;
        }
        
        [data-theme="light"] .toast {
            background: #ffffff;
            color: #1a202c;
            border: 1px solid #e2e8f0;
            box-shadow: var(--shadow-lg);
        }
        
        [data-theme="light"] .toast.success {
            background: #f0fff4;
            border-color: #9ae6b4;
            color: #22543d;
        }
        
        [data-theme="light"] .toast.error {
            background: #fff5f5;
            border-color: #fc8181;
            color: #742a2a;
        }
        
        [data-theme="light"] .toast.info {
            background: #ebf8ff;
            border-color: #90cdf4;
            color: #2c5282;
        }
        
        [data-theme="light"] .export-btn {
            background: #ffffff;
            color: #4a5568;
            border: 2px solid #e2e8f0;
        }
        
        [data-theme="light"] .export-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        [data-theme="light"] .debt-status.paid {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        [data-theme="light"] select option {
            background: #ffffff;
            color: #1a202c;
        }
        
        [data-theme="light"] textarea {
            background: #ffffff;
            border: 2px solid #e2e8f0;
            color: #1a202c;
        }
        
        [data-theme="light"] textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }
        
        /* ÿ£ŸÜŸÖÿßÿ∑ ÿÆÿßÿµÿ© ÿ®ÿµŸÅÿ≠ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ */
        .card {
            background: var(--theme-bg-card);
            border: 1px solid var(--theme-border);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--theme-shadow);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }
        
        [data-theme="light"] .card {
            background: var(--theme-bg-card);
            border: 1px solid var(--theme-border);
            box-shadow: var(--theme-shadow);
        }
        
        [data-theme="light"] .card:hover {
            box-shadow: 0 12px 35px rgba(15, 23, 42, 0.12);
        }
        
        .installment-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            display: inline-block;
        }
        
        .installment-status.paid {
            background: #d4edda;
            color: #155724;
        }
        
        .installment-status.pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .installment-status.overdue {
            background: #f8d7da;
            color: #721c24;
        }
        
        .payment-btn {
            background: var(--success-gradient);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.3s ease;
        }
        
        .payment-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
        }
        
        .payment-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿ∂ÿ∫Ÿàÿ∑ */
        body.compact-mode .pos-layout {
            gap: 1rem;
        }

        body.compact-mode .products-section,
        body.compact-mode .cart-section {
            padding: 1rem;
        }

        body.compact-mode .section-header {
            margin-bottom: 1rem;
        }

        body.compact-mode .product-card {
            padding: 0.75rem;
        }

        body.compact-mode .cart-item {
            padding: 0.75rem;
        }

        body.compact-mode .stat-card {
            padding: 1rem;
        }

        /* ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ© */
        body.no-animations * {
            animation: none !important;
            transition: none !important;
        }

        body.no-animations .page.active {
            animation: none !important;
        }

        /* ÿØÿπŸÖ ÿßŸÑŸÑÿ∫ÿßÿ™ */
        body.rtl {
            direction: rtl;
        }

        body.ltr {
            direction: ltr;
        }

        body.ltr .sidebar {
            left: 0;
            right: auto;
        }

        body.ltr .main-content {
            margin-left: 280px;
            margin-right: 0;
        }

        body.ltr .pos-layout {
            grid-template-columns: 1fr 400px;
        }

        body.ltr .cart-section {
            border-right: none;
            border-left: 1px solid var(--border-color);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÖŸÜÿ™ŸÇŸäÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ */
        input[type="color"] {
            cursor: pointer;
            border: 2px solid var(--border-color) !important;
            transition: all 0.3s ease;
        }

        input[type="color"]:hover {
            border-color: var(--primary-color) !important;
            transform: scale(1.05);
        }

        input[type="color"]:focus {
            outline: none;
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        /* ÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿØŸäŸÜÿßŸÖŸäŸÉŸäÿ© */
        .btn-primary {
            background: var(--primary-gradient) !important;
        }

        .btn-success {
            background: var(--success-gradient) !important;
        }

        .btn-warning {
            background: var(--warning-gradient) !important;
        }

        .btn-danger {
            background: var(--danger-gradient) !important;
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ */
        .settings-card-icon.store-icon {
            background: linear-gradient(135deg, var(--success-color) 0%, rgba(34, 197, 94, 0.2) 100%);
        }

        .settings-card-icon.system-icon {
            background: linear-gradient(135deg, var(--primary-color) 0%, rgba(99, 102, 241, 0.2) 100%);
        }

        .settings-card-icon.backup-icon {
            background: linear-gradient(135deg, var(--info-color) 0%, rgba(59, 130, 246, 0.2) 100%);
        }

        .settings-card-icon.notifications-icon {
            background: linear-gradient(135deg, var(--warning-color) 0%, rgba(251, 191, 36, 0.2) 100%);
        }

        .settings-card-icon.printing-icon {
            background: linear-gradient(135deg, var(--secondary-color) 0%, rgba(168, 85, 247, 0.2) 100%);
        }

        .settings-card-icon.security-icon {
            background: linear-gradient(135deg, var(--danger-color) 0%, rgba(239, 68, 68, 0.2) 100%);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿ®ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿØŸäŸÜÿßŸÖŸäŸÉŸäÿ© */
        .stat-card {
            border-top: 3px solid var(--primary-color);
        }

        .product-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.15);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ toast notifications */
        .toast.success {
            background: linear-gradient(135deg, var(--success-color) 0%, rgba(16, 185, 129, 0.9) 100%);
        }

        .toast.error {
            background: linear-gradient(135deg, var(--danger-color) 0%, rgba(239, 68, 68, 0.9) 100%);
        }

        .toast.warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, rgba(245, 158, 11, 0.9) 100%);
        }

        .toast.info {
            background: linear-gradient(135deg, var(--info-color) 0%, rgba(59, 130, 246, 0.9) 100%);
        }

        /* ÿ£ÿ≤ÿ±ÿßÿ± ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ´ŸäŸÖÿßÿ™ */
        .theme-preview-btn {
            width: 100%;
            height: 60px;
            border: none;
            border-radius: 12px;
            font-size: 1.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .theme-preview-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .theme-preview-btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        /* ÿ™ÿ≠ÿ≥ŸäŸÜ ÿπÿ±ÿ∂ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖŸÜÿ≥ÿØŸÑÿ© ŸÑŸÑÿ´ŸäŸÖÿßÿ™ */
        #themeSelect {
            background: var(--theme-bg-card);
            color: var(--theme-text-primary);
            border: 2px solid var(--theme-border);
            font-weight: 500;
        }

        #themeSelect:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        #themeSelect optgroup {
            background: var(--theme-bg-secondary);
            color: var(--theme-text-primary);
            font-weight: bold;
            padding: 0.5rem;
        }

        #themeSelect option {
            background: var(--theme-bg-card);
            color: var(--theme-text-primary);
            padding: 0.5rem;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body data-theme="dark">
  <!-- ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿÆÿµÿµ -->
  <div class="custom-titlebar">
   <div class="titlebar-left">
    <div class="titlebar-controls">
     <button class="titlebar-btn close" title="ÿ•ÿ∫ŸÑÿßŸÇ">
      <i class="fas fa-times"></i>
     </button>
     <button class="titlebar-btn maximize" title="ÿ™ŸÉÿ®Ÿäÿ±">
      <i class="fas fa-window-maximize"></i>
     </button>
     <button class="titlebar-btn minimize" title="ÿ™ÿµÿ∫Ÿäÿ±">
      <i class="fas fa-window-minimize"></i>
     </button>
    </div>
    <button class="titlebar-refresh" onclick="refreshApp()" title="ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©">
     <i class="fas fa-sync-alt"></i>
     <span>ÿ™ÿ≠ÿØŸäÿ´</span>
    </button>
    <button class="titlebar-refresh" onclick="toggleThemeQuick()" title="ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑŸÖÿ∏Ÿáÿ±" style="margin-right: 0.5rem;">
     <i class="fas fa-palette"></i>
     <span>ÿßŸÑÿ´ŸäŸÖ</span>
    </button>
   </div>
   
   <div class="titlebar-center">
    <div class="titlebar-logo">üíº</div>
    <span class="titlebar-title">ŸÜÿ∏ÿßŸÖ ŸÜŸÇÿßÿ∑ ÿßŸÑÿ®Ÿäÿπ ÿßŸÑŸÖÿ™ŸÇÿØŸÖ - ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿ•ÿ®ÿØÿßÿπ ÿßŸÑÿ±ŸÇŸÖŸä</span>
    <div class="titlebar-clock">
     <i class="fas fa-clock"></i>
     <span id="titlebarClock">00:00:00</span>
    </div>
   </div>
   
   <div class="titlebar-right">
   </div>
  </div>
  
  <div class="animated-bg"></div>
  <div class="app-container"><!-- ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä -->
   <nav class="sidebar" id="sidebar"><button class="sidebar-toggle" id="sidebarToggle"> <i class="fas fa-angle-double-right"></i> </button>
    <div class="nav-menu">
     <div class="nav-section">
      <div class="nav-section-title">
       ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
      </div>
      <div class="nav-item"><a class="nav-link active" onclick="showPage('pos')"> <i class="fas fa-cash-register nav-icon"></i> <span class="nav-text">ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ</span> </a>
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('invoices')"> <i class="fas fa-receipt nav-icon"></i> <span class="nav-text">ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</span> </a>
      </div>
     </div>
     <div class="nav-section">
      <div class="nav-section-title">
       ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('products')"> <i class="fas fa-boxes nav-icon"></i> <span class="nav-text">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span> </a>
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('inventory')"> <i class="fas fa-warehouse nav-icon"></i> <span class="nav-text">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿ≤ŸÜ</span> </a>
      </div>
     </div>
     <div class="nav-section">
      <div class="nav-section-title">
       ÿßŸÑŸÖÿßŸÑŸäÿ©
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('debts')"> <i class="fas fa-credit-card nav-icon"></i> <span class="nav-text">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ</span> </a>
      </div>
     </div>
     <div class="nav-section">
      <div class="nav-section-title">
       ÿßŸÑŸÜÿ∏ÿßŸÖ
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('printer')"> <i class="fas fa-print nav-icon"></i> <span class="nav-text">ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿ©</span> </a>
      </div>
      <div class="nav-item"><a class="nav-link" onclick="showPage('settings')"> <i class="fas fa-cog nav-icon"></i> <span class="nav-text">ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©</span> </a>
      </div>
     </div>
    </div>
   </nav><!-- ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä -->
   <main class="main-content"><!-- ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÑŸàŸä -->
    <div class="top-bar">
     <h1 class="page-title" id="currentPageTitle">ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ</h1>
     <div class="top-actions">
      <div class="search-box">
          <input type="text" class="search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÜÿ∏ÿßŸÖ..." id="globalSearchInput" onkeyup="handleGlobalSearch(event)"> 
          <i class="fas fa-search search-icon"></i>
          <div id="searchResults" class="search-results"></div>
      </div>
      <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()"> <i class="fas fa-moon"></i> </button>
      <div class="notification-btn" id="notificationBtn" onclick="showNotificationsPanel()"><i class="fas fa-bell"></i> <span class="notification-badge" id="notificationCount">0</span>
      </div>
     </div>
    </div><!-- ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ -->
    <div class="page-content"><!-- ÿµŸÅÿ≠ÿ© ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ -->
     <div id="pos" class="page active">
      <!-- ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© -->
      <div class="quick-stats-bar">
        <div class="quick-stat-card">
          <div class="quick-stat-icon products-icon">
            <i class="fas fa-boxes"></i>
          </div>
          <div class="quick-stat-info">
            <div class="quick-stat-label">ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</div>
            <div class="quick-stat-value" id="quickTotalProducts">0</div>
          </div>
        </div>
        <div class="quick-stat-card">
          <div class="quick-stat-icon value-icon">
            <i class="fas fa-dollar-sign"></i>
          </div>
          <div class="quick-stat-info">
            <div class="quick-stat-label">ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</div>
            <div class="quick-stat-value" id="quickTotalValue">0 ÿØ</div>
          </div>
        </div>
        <div class="quick-stat-card">
          <div class="quick-stat-icon debts-icon">
            <i class="fas fa-file-invoice-dollar"></i>
          </div>
          <div class="quick-stat-info">
            <div class="quick-stat-label">ÿπÿØÿØ ÿßŸÑÿØŸäŸàŸÜ</div>
            <div class="quick-stat-value" id="quickDebtsCount">0</div>
          </div>
        </div>
        <div class="quick-stat-card">
          <div class="quick-stat-icon debtors-icon">
            <i class="fas fa-users"></i>
          </div>
          <div class="quick-stat-info">
            <div class="quick-stat-label">ÿßŸÑŸÖÿØŸäŸàŸÜŸäŸÜ</div>
            <div class="quick-stat-value" id="quickDebtorsCount">0</div>
          </div>
        </div>
        <div class="quick-stat-card">
          <div class="quick-stat-icon debt-value-icon">
            <i class="fas fa-hand-holding-usd"></i>
          </div>
          <div class="quick-stat-info">
            <div class="quick-stat-label">ŸÇŸäŸÖÿ© ÿßŸÑÿØŸäŸàŸÜ</div>
            <div class="quick-stat-value" id="quickDebtsValue">0 ÿØ</div>
          </div>
        </div>
        <div class="quick-stat-card digital-clock-card">
          <div class="digital-clock">
            <div class="clock-time" id="digitalClockTime">00:00:00</div>
            <div class="clock-date">
              <span id="digitalClockDay">ÿßŸÑÿ¨ŸÖÿπÿ©</span>
              <span id="digitalClockDate">1 ŸäŸÜÿßŸäÿ± 2024</span>
            </div>
          </div>
        </div>
      </div>
      <div class="pos-layout">
       <div class="products-section">
        <div class="section-header">
         <div class="section-title"><i class="fas fa-shopping-bag"></i> ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©
         </div>
         <div class="pos-search-box">
             <i class="fas fa-search"></i>
             <input type="text" id="posSearchInput" class="pos-search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖŸÜÿ™ÿ¨..." onkeyup="filterPOSProducts()">
         </div>
        </div>
        <div class="category-filters" id="categoryFilters">
         <div class="category-btn active" data-category="all"><i class="fas fa-th-large"></i> ÿßŸÑŸÉŸÑ
         </div>
        </div>
        <div class="products-grid" id="productsGrid"><!-- ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
        </div>
       </div>
       <div class="cart-section">
        <div class="success-message" id="successMessage"><i class="fas fa-check-circle"></i> ÿ™ŸÖ ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ ÿ®ŸÜÿ¨ÿßÿ≠! üéâ
        </div>
        <div class="cart-header">
          <i class="fas fa-shopping-cart"></i> 
          <span class="cart-title">ÿ≥ŸÑÿ© ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿäÿßÿ™</span>
          <div class="cart-badge-info">
            <div class="cart-mini-stat">
              <i class="fas fa-boxes"></i>
              <span id="cartItemsCount">0</span>
            </div>
            <div class="cart-mini-stat total-price">
              <i class="fas fa-dollar-sign"></i>
              <span id="cartTotalPrice">0</span>
            </div>
          </div>
        </div>
        <div class="cart-items" id="cartItems">
         <div class="cart-empty"><i class="fas fa-shopping-cart"></i>
          <p>ÿßŸÑÿ≥ŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©</p><small>ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÑÿ•ÿ∂ÿßŸÅÿ™Ÿáÿß</small>
         </div>
        </div>
        <div class="cart-summary">
         <div class="discount-section"><input type="number" class="discount-input" id="discountInput" placeholder="ÿÆÿµŸÖ (%)">
         </div>
         <div class="summary-row"><span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä:</span> <span class="summary-value" id="subtotal">0 ÿØŸäŸÜÿßÿ±</span>
         </div>
         <div class="summary-row"><span>ÿßŸÑÿÆÿµŸÖ:</span> <span class="summary-value" id="discountAmount">0 ÿØŸäŸÜÿßÿ±</span>
         </div>
         <div class="summary-row"><span>ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© (<span id="taxRate">0</span>%):</span> <span class="summary-value" id="taxAmount">0 ÿØŸäŸÜÿßÿ±</span>
         </div>
         <div class="summary-row total"><span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÜŸáÿßÿ¶Ÿä:</span> <span class="summary-value" id="finalTotal">0 ÿØŸäŸÜÿßÿ±</span>
         </div>
         <div class="payment-methods">
          <div class="payment-btn selected" data-method="ŸÜŸÇÿØŸä"><i class="fas fa-money-bill-wave"></i> <span>ŸÜŸÇÿØŸä</span>
          </div>
          <div class="payment-btn" data-method="ÿ®ÿ∑ÿßŸÇÿ©"><i class="fas fa-credit-card"></i> <span>ÿ®ÿ∑ÿßŸÇÿ©</span>
          </div>
         </div><button class="checkout-btn" id="checkoutBtn" disabled> <i class="fas fa-check"></i> ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ </button>
        </div>
       </div>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ -->
     <div id="products" class="page">
      <div class="section-header">
       <div class="section-title"><i class="fas fa-boxes"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
       </div>
       <div class="pos-search-box">
           <i class="fas fa-search"></i>
           <input type="text" id="productsSearchInput" class="pos-search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™..." onkeyup="filterProducts()">
       </div>
       <div style="display: flex; gap: 1rem; align-items: center;">
        <div class="export-import-buttons"><button class="export-btn" onclick="exportData('products', 'json')"> <i class="fas fa-download"></i> JSON </button> <button class="export-btn" onclick="exportData('products', 'excel')"> <i class="fas fa-file-excel"></i> Excel </button> <button class="export-btn" onclick="exportData('products', 'pdf')"> <i class="fas fa-file-pdf"></i> PDF </button> <input type="file" id="importProductsFile" accept=".json,.xlsx,.csv" style="display: none;" onchange="importData('products')"> <button class="import-btn" onclick="document.getElementById('importProductsFile').click()"> <i class="fas fa-upload"></i> ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ </button>
        </div><button class="btn btn-secondary" onclick="showAddCategoryModal()"> <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅ </button> <button class="btn btn-primary" onclick="showAddProductModal()"> <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ ÿ¨ÿØŸäÿØ </button>
       </div>
      </div>
      <div class="stats-grid">
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-boxes"></i>
        </div>
        <div class="stat-value" id="totalProducts">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-dollar-sign"></i>
        </div>
        <div class="stat-value" id="totalValue">
         0
        </div>
        <div class="stat-label">
         ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i>
        </div>
        <div class="stat-value" id="lowStockItems">
         0
        </div>
        <div class="stat-label">
         ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÇŸÑŸäŸÑÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-tags"></i>
        </div>
        <div class="stat-value" id="totalCategories">
         0
        </div>
        <div class="stat-label">
         ÿπÿØÿØ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
        </div>
       </div>
      </div>
      <div class="table-container">
       <table class="table">
        <thead>
         <tr>
          <th><i class="fas fa-barcode"></i> ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ</th>
          <th><i class="fas fa-tag"></i> ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
          <th><i class="fas fa-layer-group"></i> ÿßŸÑÿ™ÿµŸÜŸäŸÅ</th>
          <th><i class="fas fa-money-bill"></i> ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ</th>
          <th><i class="fas fa-coins"></i> ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ©</th>
          <th><i class="fas fa-warehouse"></i> ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</th>
          <th><i class="fas fa-cogs"></i> ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
         </tr>
        </thead>
        <tbody id="productsTableBody"><!-- ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
        </tbody>
       </table>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿ≤ŸÜ -->
     <div id="inventory" class="page">
      <div class="section-header">
       <div class="section-title"><i class="fas fa-warehouse"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿ≤ŸÜ
       </div>
       <div class="pos-search-box">
           <i class="fas fa-search"></i>
           <input type="text" id="inventorySearchInput" class="pos-search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ..." onkeyup="filterInventory()">
       </div>
       <div class="export-import-buttons"><button class="export-btn" onclick="exportData('inventory', 'json')"> <i class="fas fa-download"></i> JSON </button> <button class="export-btn" onclick="exportData('inventory', 'excel')"> <i class="fas fa-file-excel"></i> Excel </button> <button class="export-btn" onclick="exportData('inventory', 'pdf')"> <i class="fas fa-file-pdf"></i> PDF </button> <input type="file" id="importInventoryFile" accept=".json,.xlsx,.csv" style="display: none;" onchange="importData('inventory')"> <button class="import-btn" onclick="document.getElementById('importInventoryFile').click()"> <i class="fas fa-upload"></i> ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ </button>
       </div>
      </div>
      <div class="filters-section">
       <div class="filters-grid">
        <div class="form-group"><label class="form-label">ŸÅŸÑÿ™ÿ±ÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿµŸÜŸäŸÅ</label> <select class="form-select" id="inventoryCategory"> <option value="all">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™</option> </select>
        </div>
        <div class="form-group"><label class="form-label">ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</label> <select class="form-select" id="stockStatus"> <option value="all">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿßŸÑÿßÿ™</option> <option value="in-stock">ŸÖÿ™ŸàŸÅÿ±</option> <option value="low-stock">ŸÖÿÆÿ≤ŸàŸÜ ŸÇŸÑŸäŸÑ</option> <option value="out-of-stock">ŸÜŸÅÿØ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</option> </select>
        </div>
       </div>
      </div>
      <div class="stats-grid">
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-value" id="totalProfit">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ±ÿ®ÿ≠ ÿßŸÑŸÖÿ™ŸàŸÇÿπ
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-chart-pie"></i>
        </div>
        <div class="stat-value" id="totalCost">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿ™ŸÉŸÑŸÅÿ©
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-balance-scale"></i>
        </div>
        <div class="stat-value" id="profitMargin">
         0%
        </div>
        <div class="stat-label">
         ŸáÿßŸÖÿ¥ ÿßŸÑÿ±ÿ®ÿ≠
        </div>
       </div>
      </div>
      <div class="table-container">
       <table class="table">
        <thead>
         <tr>
          <th><i class="fas fa-tag"></i> ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
          <th><i class="fas fa-layer-group"></i> ÿßŸÑÿ™ÿµŸÜŸäŸÅ</th>
          <th><i class="fas fa-warehouse"></i> ÿßŸÑŸÉŸÖŸäÿ©</th>
          <th><i class="fas fa-coins"></i> ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©</th>
          <th><i class="fas fa-money-bill"></i> ÿßŸÑŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ™ŸàŸÇÿπÿ©</th>
          <th><i class="fas fa-chart-line"></i> ÿßŸÑÿ±ÿ®ÿ≠ ÿßŸÑŸÖÿ™ŸàŸÇÿπ</th>
          <th><i class="fas fa-info-circle"></i> ÿßŸÑÿ≠ÿßŸÑÿ©</th>
         </tr>
        </thead>
        <tbody id="inventoryTableBody"><!-- ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸÜ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
        </tbody>
       </table>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ± -->
     <div id="invoices" class="page">
      <div class="section-header">
       <div class="section-title"><i class="fas fa-receipt"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
       </div>
       <div class="pos-search-box">
           <i class="fas fa-search"></i>
           <input type="text" id="invoicesSearchInput" class="pos-search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±..." onkeyup="filterInvoices()">
       </div>
       <div class="export-import-buttons"><button class="export-btn" onclick="exportData('invoices', 'json')"> <i class="fas fa-download"></i> JSON </button> <button class="export-btn" onclick="exportData('invoices', 'excel')"> <i class="fas fa-file-excel"></i> Excel </button> <button class="export-btn" onclick="exportData('invoices', 'pdf')"> <i class="fas fa-file-pdf"></i> PDF </button> <input type="file" id="importInvoicesFile" accept=".json,.xlsx,.csv" style="display: none;" onchange="importData('invoices')"> <button class="import-btn" onclick="document.getElementById('importInvoicesFile').click()"> <i class="fas fa-upload"></i> ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ </button>
       </div>
      </div>
      <div class="stats-grid">
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-receipt"></i>
        </div>
        <div class="stat-value" id="totalInvoices">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-value" id="totalSales">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-calendar-day"></i>
        </div>
        <div class="stat-value" id="todaySales">
         0
        </div>
        <div class="stat-label">
         ŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑŸäŸàŸÖ
        </div>
       </div>
      </div>
      <div class="table-container">
       <table class="table">
        <thead>
         <tr>
          <th><i class="fas fa-hashtag"></i> ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</th>
          <th><i class="fas fa-calendar"></i> ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</th>
          <th><i class="fas fa-user"></i> ÿßŸÑÿπŸÖŸäŸÑ</th>
          <th><i class="fas fa-money-bill"></i> ÿßŸÑŸÖÿ®ŸÑÿ∫</th>
          <th><i class="fas fa-credit-card"></i> ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ</th>
          <th><i class="fas fa-cogs"></i> ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
         </tr>
        </thead>
        <tbody id="invoicesTableBody"><!-- ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ± ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
        </tbody>
       </table>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ -->
     <div id="debts" class="page">
      <div class="section-header">
       <div class="section-title"><i class="fas fa-credit-card"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ ŸàÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
       </div>
       <div class="pos-search-box">
           <i class="fas fa-search"></i>
           <input type="text" id="debtsSearchInput" class="pos-search-input" placeholder="ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿØŸäŸàŸÜ..." onkeyup="filterDebts()">
       </div>
       <div class="export-import-buttons"><button class="export-btn" onclick="exportData('debts', 'json')"> <i class="fas fa-download"></i> JSON </button> <button class="export-btn" onclick="exportData('debts', 'excel')"> <i class="fas fa-file-excel"></i> Excel </button> <button class="export-btn" onclick="exportData('debts', 'pdf')"> <i class="fas fa-file-pdf"></i> PDF </button> <input type="file" id="importDebtsFile" accept=".json,.xlsx,.csv" style="display: none;" onchange="importData('debts')"> <button class="import-btn" onclick="document.getElementById('importDebtsFile').click()"> <i class="fas fa-upload"></i> ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ </button>
       </div>
      </div>
      <div class="stats-grid">
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-money-bill-wave"></i>
        </div>
        <div class="stat-value" id="totalDebts">
         0
        </div>
        <div class="stat-label">
         ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØŸäŸàŸÜ
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-users"></i>
        </div>
        <div class="stat-value" id="debtCustomers">
         0
        </div>
        <div class="stat-label">
         ÿπÿØÿØ ÿßŸÑÿπŸÖŸÑÿßÿ°
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-value" id="overdueDebts">
         0
        </div>
        <div class="stat-label">
         ÿØŸäŸàŸÜ ŸÖÿ™ÿ£ÿÆÿ±ÿ©
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-value" id="paidDebts">
         0
        </div>
        <div class="stat-label">
         ÿØŸäŸàŸÜ ŸÖÿ≥ÿØÿØÿ©
        </div>
       </div>
      </div>
      <div class="table-container">
       <table class="table">
        <thead>
         <tr>
          <th><i class="fas fa-user"></i> ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ</th>
          <th><i class="fas fa-phone"></i> ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ</th>
          <th><i class="fas fa-money-bill"></i> ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä</th>
          <th><i class="fas fa-calendar-alt"></i> ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä</th>
          <th><i class="fas fa-calendar"></i> ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿßÿ≥ÿ™ÿ≠ŸÇÿßŸÇ</th>
          <th><i class="fas fa-info-circle"></i> ÿßŸÑÿ≠ÿßŸÑÿ©</th>
          <th><i class="fas fa-cogs"></i> ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
         </tr>
        </thead>
        <tbody id="debtsTableBody"><!-- ÿßŸÑÿØŸäŸàŸÜ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
        </tbody>
       </table>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ ÿßŸÑŸÉÿßŸÖŸÑÿ© -->
     <div id="debtDetailsPage" class="page">
      <div class="section-header">
       <div class="section-title">
        <button class="btn btn-secondary" onclick="navigateTo('debts')" style="margin-left: 10px;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
        </button>
        <i class="fas fa-user-circle"></i> ÿ™ŸÅÿßÿµŸäŸÑ ÿØŸäŸÜ ÿßŸÑÿπŸÖŸäŸÑ
       </div>
      </div>
      
      <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ -->
      <div class="stats-grid" id="debtCustomerInfo">
       <!-- ÿ≥ÿ™ÿ∏Ÿáÿ± ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ ŸáŸÜÿß -->
      </div>
      
      <!-- ŸÖŸÑÿÆÿµ ÿßŸÑÿØŸäŸÜ -->
      <div class="stat-card" id="debtSummaryCard" style="margin: 20px 0; padding: 30px;">
       <!-- ŸÖŸÑÿÆÿµ ÿßŸÑÿØŸäŸÜ -->
      </div>
      
      <!-- ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ© -->
      <div class="card" style="margin: 20px 0;">
       <h3 style="margin-bottom: 20px; color: var(--primary-color);"><i class="fas fa-file-invoice"></i> ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑÿ£ÿµŸÑŸäÿ©</h3>
       <div id="debtInvoiceDetails">
        <!-- ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© -->
       </div>
      </div>
      
      <!-- ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ© -->
      <div class="card" style="margin: 20px 0;">
       <h3 style="margin-bottom: 20px; color: var(--primary-color);"><i class="fas fa-calendar-alt"></i> ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿäÿ©</h3>
       <div class="table-container">
        <table class="table">
         <thead>
          <tr>
           <th><i class="fas fa-hashtag"></i> ÿßŸÑÿ¥Ÿáÿ±</th>
           <th><i class="fas fa-calendar"></i> ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿßÿ≥ÿ™ÿ≠ŸÇÿßŸÇ</th>
           <th><i class="fas fa-money-bill"></i> ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ≥ÿ™ÿ≠ŸÇ</th>
           <th><i class="fas fa-check-circle"></i> ÿßŸÑÿ≠ÿßŸÑÿ©</th>
           <th><i class="fas fa-calendar-check"></i> ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿØŸÅÿπ</th>
           <th><i class="fas fa-cogs"></i> ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™</th>
          </tr>
         </thead>
         <tbody id="installmentsTableBody">
          <!-- ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
         </tbody>
        </table>
       </div>
      </div>
      
      <!-- ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™ -->
      <div class="card" style="margin: 20px 0;">
       <h3 style="margin-bottom: 20px; color: var(--primary-color);"><i class="fas fa-history"></i> ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™</h3>
       <div class="table-container">
        <table class="table">
         <thead>
          <tr>
           <th><i class="fas fa-calendar"></i> ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</th>
           <th><i class="fas fa-money-bill-wave"></i> ÿßŸÑŸÖÿ®ŸÑÿ∫</th>
           <th><i class="fas fa-hashtag"></i> ÿßŸÑÿ¥Ÿáÿ± ÿßŸÑŸÖÿ≥ÿØÿØ</th>
           <th><i class="fas fa-sticky-note"></i> ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</th>
          </tr>
         </thead>
         <tbody id="paymentsHistoryBody">
          <!-- ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™ -->
         </tbody>
        </table>
       </div>
      </div>
     </div><!-- ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿ© -->
     <div id="printer" class="page">
      <div class="section-header">
       <div class="section-title"><i class="fas fa-print"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©
       </div>
       <div style="display: flex; gap: 1rem;">
        <button class="btn btn-primary" onclick="testPrint()">
         <i class="fas fa-print"></i> ÿ∑ÿ®ÿßÿπÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
        </button>
        <button class="btn btn-success" onclick="savePrinterSettings()">
         <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
        </button>
        <button class="btn btn-secondary" onclick="resetPrinterSettings()">
         <i class="fas fa-undo"></i> ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä
        </button>
       </div>
      </div>

      <div class="stats-grid">
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-print"></i></div>
        <div class="stat-value" id="totalPrints">0</div>
        <div class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ∑ÿ®Ÿàÿπÿßÿ™</div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-calendar-day"></i></div>
        <div class="stat-value" id="todayPrints">0</div>
        <div class="stat-label">ŸÖÿ∑ÿ®Ÿàÿπÿßÿ™ ÿßŸÑŸäŸàŸÖ</div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-cog"></i></div>
        <div class="stat-value" id="activePrinterType">ÿπÿßÿØŸäÿ©</div>
        <div class="stat-label">ŸÜŸàÿπ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ÿßŸÑŸÜÿ¥ÿ∑</div>
       </div>
       <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
        <div class="stat-value" id="activePaperSize">80mm</div>
        <div class="stat-label">ÿ≠ÿ¨ŸÖ ÿßŸÑŸàÿ±ŸÇ</div>
       </div>
      </div>

      <!-- ŸÇÿ≥ŸÖ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ŸàÿßŸÑŸÖÿπÿßŸäŸÜÿ© -->
      <div style="display: grid; grid-template-columns: 400px 1fr; gap: 2rem; margin-top: 2rem;">
       
       <!-- ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ -->
       <div class="table-container" style="height: fit-content;">
        <div style="padding: 1.5rem;">
         <h3 style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-cog"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
         </h3>

         <!-- ŸÜŸàÿπ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© -->
         <div class="form-group">
          <label class="form-label">
           <i class="fas fa-print"></i> ŸÜŸàÿπ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
          </label>
          <select class="form-select" id="printerType" onchange="updatePreview()">
           <option value="default">ÿ∑ÿßÿ®ÿπÿ© ÿπÿßÿØŸäÿ© (A4)</option>
           <option value="thermal">ÿ∑ÿßÿ®ÿπÿ© ÿ≠ÿ±ÿßÿ±Ÿäÿ© (80mm)</option>
           <option value="thermal-58">ÿ∑ÿßÿ®ÿπÿ© ÿ≠ÿ±ÿßÿ±Ÿäÿ© (58mm)</option>
          </select>
         </div>

         <!-- Ÿàÿ∂ÿπ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© -->
         <div class="form-group">
          <label class="form-label">
           <i class="fas fa-bolt"></i> Ÿàÿ∂ÿπ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
          </label>
          <div style="display: flex; gap: 1rem;">
           <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
            <input type="radio" name="printMode" value="preview" checked onchange="updatePreview()">
            <span>ŸÖÿπÿßŸäŸÜÿ©</span>
           </label>
           <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
            <input type="radio" name="printMode" value="direct" onchange="updatePreview()">
            <span>ŸÖÿ®ÿßÿ¥ÿ±ÿ©</span>
           </label>
          </div>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ÿßŸÑŸàÿ±ŸÇ -->
         <div class="form-group">
          <label class="form-label">
           <i class="fas fa-file"></i> ÿ≠ÿ¨ŸÖ ÿßŸÑŸàÿ±ŸÇ
          </label>
          <select class="form-select" id="paperSize" onchange="updatePreview()">
           <option value="80mm">80mm (ÿ≠ÿ±ÿßÿ±Ÿä)</option>
           <option value="58mm">58mm (ÿ≠ÿ±ÿßÿ±Ÿä)</option>
           <option value="A4">A4 (210 √ó 297 ŸÖŸÑŸÖ)</option>
           <option value="A5">A5 (148 √ó 210 ŸÖŸÑŸÖ)</option>
          </select>
         </div>

         <hr style="margin: 1.5rem 0; border-color: var(--border-color);">

         <!-- ÿ£ÿ≠ÿ¨ÿßŸÖ ÿßŸÑÿÆÿ∑Ÿàÿ∑ -->
         <h4 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-text-height"></i> ÿ£ÿ≠ÿ¨ÿßŸÖ ÿßŸÑÿÆÿ∑Ÿàÿ∑
         </h4>

         <!-- ÿ≠ÿ¨ŸÖ ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ± -->
         <div class="form-group">
          <label class="form-label">ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ± (px)</label>
          <input type="range" class="form-range" id="storeTitleSize" min="14" max="32" value="24" 
                 oninput="updatePreview(); document.getElementById('storeTitleSizeValue').textContent = this.value">
          <span id="storeTitleSizeValue" style="font-weight: bold;">24</span>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± -->
         <div class="form-group">
          <label class="form-label">ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± (px)</label>
          <input type="range" class="form-range" id="storeInfoSize" min="10" max="20" value="14" 
                 oninput="updatePreview(); document.getElementById('storeInfoSizeValue').textContent = this.value">
          <span id="storeInfoSizeValue" style="font-weight: bold;">14</span>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ŸÜÿµ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© -->
         <div class="form-group">
          <label class="form-label">ŸÜÿµ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© (px)</label>
          <input type="range" class="form-range" id="invoiceTextSize" min="10" max="18" value="13" 
                 oninput="updatePreview(); document.getElementById('invoiceTextSizeValue').textContent = this.value">
          <span id="invoiceTextSizeValue" style="font-weight: bold;">13</span>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ÿßŸÑÿ¨ÿØŸàŸÑ -->
         <div class="form-group">
          <label class="form-label">ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ (px)</label>
          <input type="range" class="form-range" id="tableTextSize" min="10" max="18" value="12" 
                 oninput="updatePreview(); document.getElementById('tableTextSizeValue').textContent = this.value">
          <span id="tableTextSizeValue" style="font-weight: bold;">12</span>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä -->
         <div class="form-group">
          <label class="form-label">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä (px)</label>
          <input type="range" class="form-range" id="totalTextSize" min="12" max="22" value="16" 
                 oninput="updatePreview(); document.getElementById('totalTextSizeValue').textContent = this.value">
          <span id="totalTextSizeValue" style="font-weight: bold;">16</span>
         </div>

         <!-- ÿ≠ÿ¨ŸÖ ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ -->
         <div class="form-group">
          <label class="form-label">ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ (px)</label>
          <input type="range" class="form-range" id="footerTextSize" min="8" max="16" value="11" 
                 oninput="updatePreview(); document.getElementById('footerTextSizeValue').textContent = this.value">
          <span id="footerTextSizeValue" style="font-weight: bold;">11</span>
         </div>

         <hr style="margin: 1.5rem 0; border-color: var(--border-color);">

         <!-- ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ•ŸäÿµÿßŸÑ -->
         <h4 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-paint-brush"></i> ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ•ŸäÿµÿßŸÑ
         </h4>

         <!-- ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿ®ŸäŸÜ ÿßŸÑÿ£ÿ≥ÿ∑ÿ± -->
         <div class="form-group">
          <label class="form-label">ÿßŸÑŸÖÿ≥ÿßŸÅÿ© ÿ®ŸäŸÜ ÿßŸÑÿ£ÿ≥ÿ∑ÿ±</label>
          <input type="range" class="form-range" id="lineHeight" min="1" max="2" step="0.1" value="1.4" 
                 oninput="updatePreview(); document.getElementById('lineHeightValue').textContent = this.value">
          <span id="lineHeightValue" style="font-weight: bold;">1.4</span>
         </div>

         <!-- ÿßŸÑŸáŸàÿßŸÖÿ¥ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© -->
         <div class="form-group">
          <label class="form-label">ÿßŸÑŸáŸàÿßŸÖÿ¥ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ© (px)</label>
          <input type="range" class="form-range" id="sidePadding" min="5" max="30" value="15" 
                 oninput="updatePreview(); document.getElementById('sidePaddingValue').textContent = this.value">
          <span id="sidePaddingValue" style="font-weight: bold;">15</span>
         </div>

         <!-- ÿßŸÑŸáŸàÿßŸÖÿ¥ ÿßŸÑÿπŸÑŸàŸäÿ© ŸàÿßŸÑÿ≥ŸÅŸÑŸäÿ© -->
         <div class="form-group">
          <label class="form-label">ÿßŸÑŸáŸàÿßŸÖÿ¥ ÿßŸÑÿπŸÑŸàŸäÿ©/ÿßŸÑÿ≥ŸÅŸÑŸäÿ© (px)</label>
          <input type="range" class="form-range" id="topBottomPadding" min="5" max="30" value="15" 
                 oninput="updatePreview(); document.getElementById('topBottomPaddingValue').textContent = this.value">
          <span id="topBottomPaddingValue" style="font-weight: bold;">15</span>
         </div>

         <!-- ŸÜŸÖÿ∑ ÿßŸÑÿ≠ÿØŸàÿØ -->
         <div class="form-group">
          <label class="form-label">ŸÜŸÖÿ∑ ÿßŸÑÿ≠ÿØŸàÿØ</label>
          <select class="form-select" id="borderStyle" onchange="updatePreview()">
           <option value="dashed">ŸÖÿ™ŸÇÿ∑ÿπ</option>
           <option value="solid">ŸÖÿ™ÿµŸÑ</option>
           <option value="double">ŸÖÿ≤ÿØŸàÿ¨</option>
           <option value="none">ÿ®ÿØŸàŸÜ</option>
          </select>
         </div>

         <!-- ÿ≥ŸÖŸÉ ÿßŸÑÿ≠ÿØŸàÿØ -->
         <div class="form-group">
          <label class="form-label">ÿ≥ŸÖŸÉ ÿßŸÑÿ≠ÿØŸàÿØ (px)</label>
          <input type="range" class="form-range" id="borderWidth" min="1" max="3" value="1" 
                 oninput="updatePreview(); document.getElementById('borderWidthValue').textContent = this.value">
          <span id="borderWidthValue" style="font-weight: bold;">1</span>
         </div>

         <!-- ŸÖÿ≠ÿßÿ∞ÿßÿ© ÿßŸÑÿπŸÜŸàÿßŸÜ -->
         <div class="form-group">
          <label class="form-label">ŸÖÿ≠ÿßÿ∞ÿßÿ© ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ±</label>
          <select class="form-select" id="titleAlign" onchange="updatePreview()">
           <option value="center">Ÿàÿ≥ÿ∑</option>
           <option value="right">ŸäŸÖŸäŸÜ</option>
           <option value="left">Ÿäÿ≥ÿßÿ±</option>
          </select>
         </div>

         <hr style="margin: 1.5rem 0; border-color: var(--border-color);">

         <!-- ÿÆŸäÿßÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© -->
         <h4 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fas fa-sliders-h"></i> ÿÆŸäÿßÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ©
         </h4>

         <!-- ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ¥ÿπÿßÿ± -->
         <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
           <input type="checkbox" id="showLogo" onchange="updatePreview()">
           <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ¥ÿπÿßÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ±</span>
          </label>
         </div>

         <!-- ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑŸàŸÇÿ™ -->
         <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
           <input type="checkbox" id="showDateTime" checked onchange="updatePreview()">
           <span>ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑŸàŸÇÿ™</span>
          </label>
         </div>

         <!-- ÿ•ÿ∏Ÿáÿßÿ± ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© -->
         <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
           <input type="checkbox" id="showInvoiceNumber" checked onchange="updatePreview()">
           <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
          </label>
         </div>

         <!-- ÿ•ÿ∏Ÿáÿßÿ± ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ -->
         <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
           <input type="checkbox" id="showProductsTable" checked onchange="updatePreview()">
           <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
          </label>
         </div>

         <!-- ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ -->
         <div class="form-group">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
           <input type="checkbox" id="showFooter" checked onchange="updatePreview()">
           <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ±ÿ≥ÿßŸÑÿ© ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ</span>
          </label>
         </div>

         <!-- ŸÜÿµ ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ ÿßŸÑŸÖÿÆÿµÿµ -->
         <div class="form-group">
          <label class="form-label">ŸÜÿµ ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ ÿßŸÑŸÖÿÆÿµÿµ</label>
          <textarea class="form-control" id="customFooter" rows="2" 
                    placeholder="ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ" oninput="updatePreview()"></textarea>
         </div>

        </div>
       </div>

       <!-- ŸÖÿπÿßŸäŸÜÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ© -->
       <div class="table-container">
        <div style="padding: 1.5rem;">
         <h3 style="margin-bottom: 1.5rem; display: flex; align-items: center; justify-content: space-between;">
          <span><i class="fas fa-eye"></i> ŸÖÿπÿßŸäŸÜÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ©</span>
          <span style="font-size: 0.9rem; color: var(--text-secondary);">
           ÿ™ÿ≠ÿØŸäÿ´ ÿ™ŸÑŸÇÿßÿ¶Ÿä
          </span>
         </h3>
         
         <!-- ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÖÿπÿßŸäŸÜÿ© -->
         <div style="background: var(--bg-secondary); padding: 2rem; border-radius: 12px; display: flex; justify-content: center; align-items: flex-start; min-height: 600px;">
          <div id="receiptPreview" style="background: white; color: black; box-shadow: 0 10px 40px rgba(0,0,0,0.2); border-radius: 4px; max-width: 100%; overflow: hidden;">
           <!-- ÿ≥Ÿäÿ™ŸÖ ŸÖŸÑÿ° ÿßŸÑŸÖÿπÿßŸäŸÜÿ© ŸáŸÜÿß -->
          </div>
         </div>

        </div>
       </div>

      </div>

     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ© -->
     <div id="settings" class="page">
      <div class="section-header" style="margin-bottom: 2rem;">
       <div class="section-title"><i class="fas fa-cog"></i> ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©</div>
       <div class="section-subtitle">ÿ•ÿØÿßÿ±ÿ© ÿ¨ŸÖŸäÿπ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ ŸÖŸÜ ŸÖŸÉÿßŸÜ Ÿàÿßÿ≠ÿØ</div>
      </div>

      <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ© ÿπŸÜ ÿßŸÑŸÜÿ∏ÿßŸÖ -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
        <div class="info-mini-card">
          <div class="info-mini-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
            <i class="fas fa-box"></i>
          </div>
          <div class="info-mini-content">
            <div class="info-mini-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</div>
            <div class="info-mini-value" id="settingsProductCount">0</div>
          </div>
        </div>
        
        <div class="info-mini-card">
          <div class="info-mini-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
            <i class="fas fa-layer-group"></i>
          </div>
          <div class="info-mini-content">
            <div class="info-mini-label">ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™</div>
            <div class="info-mini-value" id="settingsCategoryCount">0</div>
          </div>
        </div>
        
        <div class="info-mini-card">
          <div class="info-mini-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
            <i class="fas fa-receipt"></i>
          </div>
          <div class="info-mini-content">
            <div class="info-mini-label">ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</div>
            <div class="info-mini-value" id="settingsInvoiceCount">0</div>
          </div>
        </div>
        
        <div class="info-mini-card">
          <div class="info-mini-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
            <i class="fas fa-money-bill-wave"></i>
          </div>
          <div class="info-mini-content">
            <div class="info-mini-label">ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</div>
            <div class="info-mini-value" id="settingsSalesValue">0 ÿØ.ÿπ</div>
          </div>
        </div>
      </div>

      <!-- ŸÇÿ≥ŸÖ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© -->
      <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--theme-text-primary); display: flex; align-items: center; gap: 0.75rem;">
          <span style="width: 4px; height: 24px; background: var(--primary-gradient); border-radius: 2px;"></span>
          <i class="fas fa-sliders-h"></i>
          ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
        </h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">
          
          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± -->
          <div class="settings-card" onclick="showSettingsPage('store')">
            <div class="settings-card-icon store-icon">
              <i class="fas fa-store"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±</h3>
              <p>ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±ÿå ÿßŸÑÿπŸÜŸàÿßŸÜÿå ÿßŸÑÿ∂ÿ±ÿßÿ¶ÿ® ŸàÿßŸÑŸÅÿ±Ÿàÿπ</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ -->
          <div class="settings-card" onclick="showSettingsPage('system')">
            <div class="settings-card-icon system-icon">
              <i class="fas fa-desktop"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ</h3>
              <p>ÿßŸÑŸÖÿ∏Ÿáÿ±ÿå ÿßŸÑŸÑÿ∫ÿ©ÿå ÿßŸÑÿπŸÖŸÑÿ© Ÿàÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿ±ÿ∂</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© -->
          <div class="settings-card" onclick="showSettingsPage('printing')">
            <div class="settings-card-icon printing-icon">
              <i class="fas fa-print"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©</h3>
              <p>ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ± ŸàÿßŸÑÿ∑ÿßÿ®ÿπÿßÿ™</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

        </div>
      </div>

      <!-- ŸÇÿ≥ŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸàÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä -->
      <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--theme-text-primary); display: flex; align-items: center; gap: 0.75rem;">
          <span style="width: 4px; height: 24px; background: var(--primary-gradient); border-radius: 2px;"></span>
          <i class="fas fa-database"></i>
          ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸàÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä
        </h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">
          
          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© -->
          <div class="settings-card" onclick="showSettingsPage('backup')">
            <div class="settings-card-icon backup-icon">
              <i class="fas fa-cloud-upload-alt"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©</h3>
              <p>ÿ•ŸÜÿ¥ÿßÿ° Ÿàÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ŸÑŸÑÿ®ŸäÿßŸÜÿßÿ™</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ -->
          <div class="settings-card" onclick="showSettingsPage('notifications')">
            <div class="settings-card-icon notifications-icon">
              <i class="fas fa-bell"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</h3>
              <p>ÿ™ŸÜÿ®ŸäŸáÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜÿå ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑÿØŸäŸàŸÜ</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ -->
          <div class="settings-card" onclick="showSettingsPage('security')">
            <div class="settings-card-icon security-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="settings-card-content">
              <h3>ÿßŸÑÿ£ŸÖÿßŸÜ ŸàÿßŸÑÿÆÿµŸàÿµŸäÿ©</h3>
              <p>ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ŸàÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™</p>
            </div>
            <div class="settings-card-arrow">
              <i class="fas fa-chevron-left"></i>
            </div>
          </div>

        </div>
      </div>

      <!-- ŸÇÿ≥ŸÖ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ŸàÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± -->
      <div style="margin-bottom: 2rem;">
        <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--theme-text-primary); display: flex; align-items: center; gap: 0.75rem;">
          <span style="width: 4px; height: 24px; background: var(--primary-gradient); border-radius: 2px;"></span>
          <i class="fas fa-chart-line"></i>
          ŸÜÿ∏ÿ±ÿ© ÿπÿßŸÖÿ© ÿπŸÑŸâ ÿßŸÑŸÜÿ∏ÿßŸÖ
        </h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
          
          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ -->
          <div class="stat-overview-card">
            <div class="stat-overview-header">
              <div class="stat-overview-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                <i class="fas fa-warehouse"></i>
              </div>
              <h4>ÿ≠ÿßŸÑÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</h4>
            </div>
            <div class="stat-overview-body">
              <div class="stat-overview-item">
                <span>ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÜÿ¥ÿ∑ÿ©</span>
                <strong id="activeProductsCount">0</strong>
              </div>
              <div class="stat-overview-item">
                <span>ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÇÿßÿ±ÿ®ÿ™ ÿßŸÑŸÜŸÅÿßÿ∞</span>
                <strong id="lowStockCount" style="color: #fbbf24;">0</strong>
              </div>
              <div class="stat-overview-item">
                <span>ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÜŸÅÿ∞ÿ™</span>
                <strong id="outOfStockCount" style="color: #ef4444;">0</strong>
              </div>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ŸÖŸÑÿÆÿµ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ -->
          <div class="stat-overview-card">
            <div class="stat-overview-header">
              <div class="stat-overview-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                <i class="fas fa-chart-bar"></i>
              </div>
              <h4>ŸÖŸÑÿÆÿµ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</h4>
            </div>
            <div class="stat-overview-body">
              <div class="stat-overview-item">
                <span>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</span>
                <strong id="totalInvoicesCount">0</strong>
              </div>
              <div class="stat-overview-item">
                <span>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™</span>
                <strong id="totalSalesAmount">0 ÿØ.ÿπ</strong>
              </div>
              <div class="stat-overview-item">
                <span>ŸÖÿ™Ÿàÿ≥ÿ∑ ŸÇŸäŸÖÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
                <strong id="averageInvoice">0 ÿØ.ÿπ</strong>
              </div>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ÿ≠ÿßŸÑÿ© ÿßŸÑÿØŸäŸàŸÜ -->
          <div class="stat-overview-card">
            <div class="stat-overview-header">
              <div class="stat-overview-icon" style="background: linear-gradient(135deg, #fa709a, #fee140);">
                <i class="fas fa-file-invoice-dollar"></i>
              </div>
              <h4>ÿ≠ÿßŸÑÿ© ÿßŸÑÿØŸäŸàŸÜ</h4>
            </div>
            <div class="stat-overview-body">
              <div class="stat-overview-item">
                <span>ÿπÿØÿØ ÿßŸÑŸÖÿØŸäŸÜŸäŸÜ</span>
                <strong id="totalDebtorsCount">0</strong>
              </div>
              <div class="stat-overview-item">
                <span>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØŸäŸàŸÜ</span>
                <strong id="totalDebtsAmount">0 ÿØ.ÿπ</strong>
              </div>
              <div class="stat-overview-item">
                <span>ÿØŸäŸàŸÜ ŸÖÿ™ÿ£ÿÆÿ±ÿ©</span>
                <strong id="overdueDebtsCount" style="color: #ef4444;">0</strong>
              </div>
            </div>
          </div>

          <!-- ÿ®ÿ∑ÿßŸÇÿ© ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ -->
          <div class="stat-overview-card">
            <div class="stat-overview-header">
              <div class="stat-overview-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                <i class="fas fa-info-circle"></i>
              </div>
              <h4>ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ</h4>
            </div>
            <div class="stat-overview-body">
              <div class="stat-overview-item">
                <span>ÿ•ÿµÿØÿßÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</span>
                <strong>v2.0.0</strong>
              </div>
              <div class="stat-overview-item">
                <span>ÿ¢ÿÆÿ± ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©</span>
                <strong id="lastBackupDate">ŸÑÿß ÿ™Ÿàÿ¨ÿØ</strong>
              </div>
              <div class="stat-overview-item">
                <span>ÿ≠ÿßŸÑÿ© ÿßŸÑŸÜÿ∏ÿßŸÖ</span>
                <strong style="color: #22c55e;">
                  <i class="fas fa-check-circle"></i> ŸäÿπŸÖŸÑ ÿ®ÿ¥ŸÉŸÑ ÿ¨ŸäÿØ
                </strong>
              </div>
            </div>
          </div>

        </div>
      </div>

      <!-- ŸÇÿ≥ŸÖ ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ© -->
      <div>
        <h3 style="font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--theme-text-primary); display: flex; align-items: center; gap: 0.75rem;">
          <span style="width: 4px; height: 24px; background: var(--primary-gradient); border-radius: 2px;"></span>
          <i class="fas fa-bolt"></i>
          ÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿ≥ÿ±Ÿäÿπÿ©
        </h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
          
          <button class="quick-action-btn" onclick="showSettingsPage('backup')" style="background: linear-gradient(135deg, #667eea, #764ba2);">
            <i class="fas fa-download"></i>
            <span>ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™</span>
          </button>

          <button class="quick-action-btn" onclick="window.print()" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
            <i class="fas fa-print"></i>
            <span>ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÇÿ±Ÿäÿ±</span>
          </button>

          <button class="quick-action-btn" onclick="refreshApp()" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
            <i class="fas fa-sync-alt"></i>
            <span>ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™</span>
          </button>

          <button class="quick-action-btn" onclick="showSettingsPage('system')" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
            <i class="fas fa-palette"></i>
            <span>ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑŸÖÿ∏Ÿáÿ±</span>
          </button>

        </div>
      </div>

     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± -->
     <div id="settings-store" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-store"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-info-circle"></i> ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©
            </h3>
            
            <div class="form-group">
              <label class="form-label"><i class="fas fa-store"></i> ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ™ÿ¨ÿ±</label>
              <input type="text" class="form-input" id="settingsStoreName" placeholder="ÿßÿ≥ŸÖ ŸÖÿ™ÿ¨ÿ±ŸÉ">
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-user"></i> ÿßÿ≥ŸÖ ÿßŸÑŸÖÿßŸÑŸÉ</label>
              <input type="text" class="form-input" id="settingsOwnerName" placeholder="ÿßÿ≥ŸÖ ŸÖÿßŸÑŸÉ ÿßŸÑŸÖÿ™ÿ¨ÿ±">
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-file-alt"></i> ÿ±ŸÇŸÖ ÿßŸÑÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿä</label>
              <input type="text" class="form-input" id="settingsCommercialReg" placeholder="ÿ±ŸÇŸÖ ÿßŸÑÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ¨ÿßÿ±Ÿä">
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-certificate"></i> ÿßŸÑÿ±ŸÇŸÖ ÿßŸÑÿ∂ÿ±Ÿäÿ®Ÿä</label>
              <input type="text" class="form-input" id="settingsTaxNumber" placeholder="ÿßŸÑÿ±ŸÇŸÖ ÿßŸÑÿ∂ÿ±Ÿäÿ®Ÿä ŸÑŸÑŸÖÿ™ÿ¨ÿ±">
            </div>
          </div>

          <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-address-card"></i> ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿßÿ™ÿµÿßŸÑ
            </h3>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-map-marker-alt"></i> ÿßŸÑÿπŸÜŸàÿßŸÜ ÿßŸÑŸÉÿßŸÖŸÑ</label>
              <textarea class="form-input" id="settingsStoreAddress" rows="3" placeholder="ÿßŸÑŸÖÿØŸäŸÜÿ© - ÿßŸÑÿ≠Ÿä - ÿßŸÑÿ¥ÿßÿ±ÿπ"></textarea>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label class="form-label"><i class="fas fa-phone"></i> ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ 1</label>
                <input type="tel" class="form-input" id="settingsStorePhone1" placeholder="07XXXXXXXXX">
              </div>

              <div class="form-group">
                <label class="form-label"><i class="fas fa-phone"></i> ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ 2</label>
                <input type="tel" class="form-input" id="settingsStorePhone2" placeholder="07XXXXXXXXX">
              </div>
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-envelope"></i> ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</label>
              <input type="email" class="form-input" id="settingsStoreEmail" placeholder="info@store.com">
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fab fa-whatsapp"></i> ÿ±ŸÇŸÖ ÿßŸÑŸàÿßÿ™ÿ≥ÿßÿ®</label>
              <input type="tel" class="form-input" id="settingsWhatsapp" placeholder="07XXXXXXXXX">
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-globe"></i> ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä</label>
              <input type="url" class="form-input" id="settingsWebsite" placeholder="https://yourstore.com">
            </div>
          </div>

          <!-- ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿßŸÑŸäÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-dollar-sign"></i> ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿßŸÑŸäÿ©
            </h3>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-percentage"></i> ŸÖÿπÿØŸÑ ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© (%)</label>
              <input type="number" class="form-input" id="settingsTaxRate" value="0" min="0" max="100" step="0.1">
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ Ÿáÿ∞Ÿá ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
              </small>
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-coins"></i> ÿßŸÑÿπŸÖŸÑÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©</label>
              <select class="form-select" id="settingsDefaultCurrency">
                <option value="IQD">ÿØŸäŸÜÿßÿ± ÿπÿ±ÿßŸÇŸä (IQD)</option>
                <option value="USD">ÿØŸàŸÑÿßÿ± ÿ£ŸÖÿ±ŸäŸÉŸä (USD)</option>
                <option value="EUR">ŸäŸàÿ±Ÿà (EUR)</option>
                <option value="GBP">ÿ¨ŸÜŸäŸá ÿßÿ≥ÿ™ÿ±ŸÑŸäŸÜŸä (GBP)</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label"><i class="fas fa-money-bill"></i> ÿ£ŸÇŸÑ ŸÖÿ®ŸÑÿ∫ ŸÑŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ≥ŸÖŸàÿ≠</label>
              <input type="number" class="form-input" id="settingsMinDebtAmount" value="0">
            </div>
          </div>

          <!-- ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿπŸÖŸÑ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-clock"></i> ÿ£ŸàŸÇÿßÿ™ ÿßŸÑÿπŸÖŸÑ
            </h3>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <div class="form-group">
                <label class="form-label">ŸàŸÇÿ™ ÿßŸÑŸÅÿ™ÿ≠</label>
                <input type="time" class="form-input" id="settingsOpenTime" value="09:00">
              </div>

              <div class="form-group">
                <label class="form-label">ŸàŸÇÿ™ ÿßŸÑÿ•ÿ∫ŸÑÿßŸÇ</label>
                <input type="time" class="form-input" id="settingsCloseTime" value="22:00">
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ£ŸäÿßŸÖ ÿßŸÑÿπÿ∑ŸÑ</label>
              <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-top: 0.5rem;">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                  <input type="checkbox" id="closedFriday" style="width: auto;">
                  <span>ÿßŸÑÿ¨ŸÖÿπÿ©</span>
                </label>
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                  <input type="checkbox" id="closedSaturday" style="width: auto;">
                  <span>ÿßŸÑÿ≥ÿ®ÿ™</span>
                </label>
              </div>
            </div>
          </div>

          <!-- ÿßŸÑÿ¥ÿπÿßÿ± -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-image"></i> ÿ¥ÿπÿßÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ±
            </h3>

            <div class="form-group">
              <label class="form-label">ÿ±ŸÅÿπ ÿ¥ÿπÿßÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ±</label>
              <input type="file" class="form-input" id="settingsStoreLogo" accept="image/*">
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿ≥Ÿäÿ∏Ÿáÿ± ÿßŸÑÿ¥ÿπÿßÿ± ÿπŸÑŸâ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ± ÿßŸÑŸÖÿ∑ÿ®Ÿàÿπÿ© (ŸäŸÅÿ∂ŸÑ ÿµŸàÿ±ÿ© ÿ®ÿÆŸÑŸÅŸäÿ© ÿ¥ŸÅÿßŸÅÿ© PNG)
              </small>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn btn-primary" onclick="saveStoreSettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            </button>
            <button class="btn btn-secondary" onclick="showPage('settings')">
              <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°
            </button>
          </div>

        </div>
      </div>
     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ -->
     <div id="settings-system" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-desktop"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ∏Ÿáÿ± -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-palette"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ∏Ÿáÿ±
            </h3>

            <div class="form-group">
              <label class="form-label">ÿßÿÆÿ™ÿ± ŸÖÿ∏Ÿáÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÉÿßŸÖŸÑ</label>
              <select class="form-select" id="themeSelect" onchange="changeTheme(this.value)" style="font-size: 1rem;">
                <optgroup label="ÿßŸÑÿ´ŸäŸÖÿßÿ™ ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸäÿ©">
                  <option value="dark">üåô ÿßŸÑŸÖÿ∏Ÿáÿ± ÿßŸÑÿØÿßŸÉŸÜ (ŸÉŸÑÿßÿ≥ŸäŸÉŸä)</option>
                  <option value="light">‚òÄÔ∏è ÿßŸÑŸÖÿ∏Ÿáÿ± ÿßŸÑŸÅÿßÿ™ÿ≠ (ŸÉŸÑÿßÿ≥ŸäŸÉŸä)</option>
                </optgroup>
                
                <optgroup label="ÿßŸÑÿ´ŸäŸÖÿßÿ™ ÿßŸÑÿØÿßŸÉŸÜÿ© ÿßŸÑŸÖŸÑŸàŸÜÿ©">
                  <option value="blue-dark">üîµ ÿ£ÿ≤ÿ±ŸÇ ÿØÿßŸÉŸÜ (Blue Dark)</option>
                  <option value="green-dark">üíö ÿ£ÿÆÿ∂ÿ± ÿØÿßŸÉŸÜ (Green Dark)</option>
                  <option value="orange-dark">üß° ÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿØÿßŸÉŸÜ (Orange Dark)</option>
                  <option value="purple-dark">üíú ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä ÿØÿßŸÉŸÜ (Purple Dark)</option>
                  <option value="red-dark">‚ù§Ô∏è ÿ£ÿ≠ŸÖÿ± ÿØÿßŸÉŸÜ (Red Dark)</option>
                  <option value="olive">üü¢ ÿ≤Ÿäÿ™ŸàŸÜŸä ÿØÿßŸÉŸÜ (Olive)</option>
                  <option value="royal-blue">üî¥ ÿ£ÿ≤ÿ±ŸÇ ŸÖŸÑŸÉŸä (Royal Blue)</option>
                </optgroup>
                
                <optgroup label="ÿßŸÑÿ´ŸäŸÖÿßÿ™ ÿßŸÑŸÅÿßÿ™ÿ≠ÿ© ÿßŸÑŸÖŸÑŸàŸÜÿ©">
                  <option value="cyan-light">ü©µ ÿ≥ŸÖÿßŸàŸä ŸÅÿßÿ™ÿ≠ (Cyan Light)</option>
                  <option value="gold-light">üü° ÿ∞Ÿáÿ®Ÿä ŸÅÿßÿ™ÿ≠ (Gold Light)</option>
                  <option value="pink-light">üå∏ Ÿàÿ±ÿØŸä ŸÅÿßÿ™ÿ≠ (Pink Light)</option>
                </optgroup>
              </select>
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿßÿÆÿ™ÿ± ÿßŸÑÿ´ŸäŸÖ ÿßŸÑŸÖŸÅÿ∂ŸÑ - ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿπŸÑŸâ ŸÉÿßŸÖŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸÅŸàÿ±ÿßŸã
              </small>
              
              <!-- ŸÖÿπÿßŸäŸÜÿ© ÿ≥ÿ±Ÿäÿπÿ© ŸÑŸÑÿ´ŸäŸÖÿßÿ™ -->
              <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 0.75rem; margin-top: 1rem; padding: 1rem; background: var(--theme-bg-hover); border-radius: 12px;">
                <button onclick="changeTheme('dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%); color: #e8e8e8;" title="ÿßŸÑÿØÿßŸÉŸÜ ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸä">
                  üåô
                </button>
                <button onclick="changeTheme('light')" class="theme-preview-btn" style="background: linear-gradient(135deg, #f5f5f0 0%, #ffffff 100%); color: #1a1a1a; border: 1px solid #d8d8d8;" title="ÿßŸÑŸÅÿßÿ™ÿ≠ ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸä">
                  ‚òÄÔ∏è
                </button>
                <button onclick="changeTheme('blue-dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #0a1628 0%, #152238 100%); color: #e1f0ff;" title="ÿ£ÿ≤ÿ±ŸÇ ÿØÿßŸÉŸÜ">
                  üîµ
                </button>
                <button onclick="changeTheme('green-dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #0a1f0f 0%, #14321f 100%); color: #d1fae5;" title="ÿ£ÿÆÿ∂ÿ± ÿØÿßŸÉŸÜ">
                  üíö
                </button>
                <button onclick="changeTheme('orange-dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #1f1208 0%, #351e18 100%); color: #ffe4d1;" title="ÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿØÿßŸÉŸÜ">
                  üß°
                </button>
                <button onclick="changeTheme('purple-dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #1a0a28 0%, #2e1542 100%); color: #f0d1ff;" title="ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä ÿØÿßŸÉŸÜ">
                  üíú
                </button>
                <button onclick="changeTheme('red-dark')" class="theme-preview-btn" style="background: linear-gradient(135deg, #280a0a 0%, #421515 100%); color: #ffd1d1;" title="ÿ£ÿ≠ŸÖÿ± ÿØÿßŸÉŸÜ">
                  ‚ù§Ô∏è
                </button>
                <button onclick="changeTheme('cyan-light')" class="theme-preview-btn" style="background: linear-gradient(135deg, #e0f7fa 0%, #ffffff 100%); color: #0e2933; border: 1px solid #b0dce5;" title="ÿ≥ŸÖÿßŸàŸä ŸÅÿßÿ™ÿ≠">
                  ü©µ
                </button>
                <button onclick="changeTheme('gold-light')" class="theme-preview-btn" style="background: linear-gradient(135deg, #fffbea 0%, #ffffff 100%); color: #2a2008; border: 1px solid #e8d89b;" title="ÿ∞Ÿáÿ®Ÿä ŸÅÿßÿ™ÿ≠">
                  üü°
                </button>
                <button onclick="changeTheme('pink-light')" class="theme-preview-btn" style="background: linear-gradient(135deg, #fce7f3 0%, #ffffff 100%); color: #2d081f; border: 1px solid #f5c0dd;" title="Ÿàÿ±ÿØŸä ŸÅÿßÿ™ÿ≠">
                  üå∏
                </button>
                <button onclick="changeTheme('olive')" class="theme-preview-btn" style="background: linear-gradient(135deg, #1a1f0a 0%, #2e3515 100%); color: #e8f0d1;" title="ÿ≤Ÿäÿ™ŸàŸÜŸä">
                  üü¢
                </button>
                <button onclick="changeTheme('royal-blue')" class="theme-preview-btn" style="background: linear-gradient(135deg, #0c1445 0%, #162270 100%); color: #d6e4ff;" title="ÿ£ÿ≤ÿ±ŸÇ ŸÖŸÑŸÉŸä">
                  üî¥
                </button>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©</label>
              <select class="form-select" id="colorSchemeSelect" onchange="previewColorScheme(this.value)">
                <option value="default">ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä (ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä Ÿàÿ±ÿØŸä)</option>
                <option value="blue">ÿ£ÿ≤ÿ±ŸÇ ÿπÿµÿ±Ÿä üíô</option>
                <option value="green">ÿ£ÿÆÿ∂ÿ± ÿ∑ÿ®ŸäÿπŸä üíö</option>
                <option value="orange">ÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿØÿßŸÅÿ¶ üß°</option>
                <option value="red">ÿ£ÿ≠ŸÖÿ± ŸÜÿßÿ±Ÿä ‚ù§Ô∏è</option>
                <option value="purple">ÿ®ŸÜŸÅÿ≥ÿ¨Ÿä ŸÖŸÑŸÉŸä üíú</option>
                <option value="cyan">ÿ≥ŸÖÿßŸàŸä ŸÖŸÜÿπÿ¥ ü©µ</option>
                <option value="amber">ŸÉŸáÿ±ŸÖÿßŸÜŸä ÿ∞Ÿáÿ®Ÿä üü°</option>
                <option value="teal">ÿ™ÿ±ŸÉŸàÿßÿ≤ ŸáÿßÿØÿ¶ üîµ</option>
              </select>
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿßÿÆÿ™ÿ± ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ŸÑÿØŸäŸÉ - ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇŸáÿß ÿπŸÑŸâ ÿ¨ŸÖŸäÿπ ÿπŸÜÿßÿµÿ± ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
              </small>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ™ÿÆÿµŸäÿµ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©</label>
              <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-top: 1rem;">
                
                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-palette"></i> ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="primaryColorPicker" value="#6366f1" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="primaryColorInput" value="#6366f1" class="form-input" style="flex: 1;" placeholder="#6366f1">
                  </div>
                </div>

                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-palette"></i> ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ´ÿßŸÜŸàŸä
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="secondaryColorPicker" value="#8b5cf6" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="secondaryColorInput" value="#8b5cf6" class="form-input" style="flex: 1;" placeholder="#8b5cf6">
                  </div>
                </div>

                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-check-circle"></i> ŸÑŸàŸÜ ÿßŸÑŸÜÿ¨ÿßÿ≠
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="successColorPicker" value="#10b981" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="successColorInput" value="#10b981" class="form-input" style="flex: 1;" placeholder="#10b981">
                  </div>
                </div>

                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-exclamation-triangle"></i> ŸÑŸàŸÜ ÿßŸÑÿ™ÿ≠ÿ∞Ÿäÿ±
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="warningColorPicker" value="#f59e0b" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="warningColorInput" value="#f59e0b" class="form-input" style="flex: 1;" placeholder="#f59e0b">
                  </div>
                </div>

                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-times-circle"></i> ŸÑŸàŸÜ ÿßŸÑÿÆÿ∑ÿ±
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="dangerColorPicker" value="#ef4444" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="dangerColorInput" value="#ef4444" class="form-input" style="flex: 1;" placeholder="#ef4444">
                  </div>
                </div>

                <div>
                  <label style="font-size: 0.875rem; color: var(--theme-text-secondary); display: block; margin-bottom: 0.5rem;">
                    <i class="fas fa-info-circle"></i> ŸÑŸàŸÜ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™
                  </label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="color" id="infoColorPicker" value="#3b82f6" style="width: 60px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                    <input type="text" id="infoColorInput" value="#3b82f6" class="form-input" style="flex: 1;" placeholder="#3b82f6">
                  </div>
                </div>

              </div>
              <button class="btn btn-secondary" onclick="resetDefaultColors()" style="margin-top: 1rem;">
                <i class="fas fa-undo"></i> ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
              </button>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆÿ∑</label>
              <select class="form-select" id="fontSizeSelect">
                <option value="small">ÿµÿ∫Ÿäÿ±</option>
                <option value="medium" selected>ŸÖÿ™Ÿàÿ≥ÿ∑</option>
                <option value="large">ŸÉÿ®Ÿäÿ±</option>
              </select>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="compactModeCheck" style="width: auto;">
                <span>ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿØŸÖÿ¨ (ÿπÿ±ÿ∂ ÿ£ŸÉÿ´ÿ± ŸÉÿ´ÿßŸÅÿ©)</span>
              </label>
            </div>
          </div>

          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÑÿ∫ÿ© ŸàÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-language"></i> ÿßŸÑŸÑÿ∫ÿ© ŸàÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ
            </h3>

            <div class="form-group">
              <label class="form-label">ŸÑÿ∫ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</label>
              <select class="form-select" id="languageSelect">
                <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ© üáÆüá∂</option>
                <option value="en">English üá¨üáß</option>
                <option value="ku">ŸÉŸàÿ±ÿØ€å üè¥</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</label>
              <select class="form-select" id="dateFormatSelect">
                <option value="DD/MM/YYYY">ŸäŸàŸÖ/ÿ¥Ÿáÿ±/ÿ≥ŸÜÿ©</option>
                <option value="MM/DD/YYYY">ÿ¥Ÿáÿ±/ŸäŸàŸÖ/ÿ≥ŸÜÿ©</option>
                <option value="YYYY-MM-DD">ÿ≥ŸÜÿ©-ÿ¥Ÿáÿ±-ŸäŸàŸÖ</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ™ŸÜÿ≥ŸäŸÇ ÿßŸÑŸàŸÇÿ™</label>
              <select class="form-select" id="timeFormatSelect">
                <option value="12">12 ÿ≥ÿßÿπÿ© (AM/PM)</option>
                <option value="24">24 ÿ≥ÿßÿπÿ©</option>
              </select>
            </div>
          </div>

          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ° -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-tachometer-alt"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ÿØÿßÿ°
            </h3>

            <div class="form-group">
              <label class="form-label">ÿπÿØÿØ ÿßŸÑÿπŸÜÿßÿµÿ± ŸÅŸä ÿßŸÑÿµŸÅÿ≠ÿ©</label>
              <select class="form-select" id="itemsPerPageSelect">
                <option value="10">10 ÿπŸÜÿßÿµÿ±</option>
                <option value="25" selected>25 ÿπŸÜÿµÿ±</option>
                <option value="50">50 ÿπŸÜÿµÿ±</option>
                <option value="100">100 ÿπŸÜÿµÿ±</option>
              </select>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="animationsCheck" checked style="width: auto;">
                <span>ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ™ÿ£ÿ´Ÿäÿ±ÿßÿ™ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="autosaveCheck" checked style="width: auto;">
                <span>ÿßŸÑÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÉŸÑ 5 ÿØŸÇÿßÿ¶ŸÇ</span>
              </label>
            </div>
          </div>

          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-cash-register"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="barcodeSound" checked style="width: auto;">
                <span>ÿ™ÿ¥ÿ∫ŸäŸÑ ÿµŸàÿ™ ÿπŸÜÿØ ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="autoPrint" style="width: auto;">
                <span>ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ ÿßŸÑÿ®Ÿäÿπ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="clearCartAfterSale" checked style="width: auto;">
                <span>ŸÖÿ≥ÿ≠ ÿßŸÑÿ≥ŸÑÿ© ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ ÿßŸÑÿ®Ÿäÿπ</span>
              </label>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn btn-primary" onclick="saveSystemSettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            </button>
            <button class="btn btn-secondary" onclick="showPage('settings')">
              <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°
            </button>
          </div>

        </div>
      </div>
     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© -->
     <div id="settings-backup" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-database"></i> ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-download"></i> ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
            </h3>

            <div style="background: rgba(34, 197, 94, 0.1); border-right: 4px solid #22c55e; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
              <h4 style="color: #22c55e; margin-bottom: 0.5rem;">
                <i class="fas fa-info-circle"></i> ŸÜÿµŸäÿ≠ÿ© ŸÖŸáŸÖÿ©
              </h4>
              <p style="color: var(--theme-text-secondary); line-height: 1.6;">
                ŸÇŸÖ ÿ®ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ÿ®ÿ¥ŸÉŸÑ ÿØŸàÿ±Ÿä (ŸäŸàŸÖŸäÿßŸã ÿ£Ÿà ÿ£ÿ≥ÿ®ŸàÿπŸäÿßŸã) ŸÑŸÑÿ≠ŸÅÿßÿ∏ ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ŸÉ ÿ¢ŸÖŸÜÿ©.
              </p>
            </div>

            <div style="display: grid; gap: 1rem;">
              <button class="btn btn-success" onclick="createFullBackup()" style="padding: 1.5rem; font-size: 1.1rem;">
                <i class="fas fa-download"></i> ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ŸÉÿßŸÖŸÑÿ©
              </button>

              <button class="btn" style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 1.5rem;" onclick="createDataBackup()">
                <i class="fas fa-database"></i> ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸÇÿ∑ (ŸÖŸÜÿ™ÿ¨ÿßÿ™ÿå ŸÅŸàÿßÿ™Ÿäÿ±ÿå ÿØŸäŸàŸÜ)
              </button>

              <button class="btn" style="background: linear-gradient(135deg, #f093fb, #f5576c); padding: 1.5rem;" onclick="createSettingsBackup()">
                <i class="fas fa-cog"></i> ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸÇÿ∑
              </button>
            </div>
          </div>

          <!-- ÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-upload"></i> ÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
            </h3>

            <div style="background: rgba(251, 191, 36, 0.1); border-right: 4px solid #fbbf24; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
              <h4 style="color: #fbbf24; margin-bottom: 0.5rem;">
                <i class="fas fa-exclamation-triangle"></i> ÿ™ÿ≠ÿ∞Ÿäÿ±
              </h4>
              <p style="color: var(--theme-text-secondary); line-height: 1.6;">
                ÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ÿ≥Ÿäÿ§ÿØŸä ÿ•ŸÑŸâ ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©. ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ŸÇÿ®ŸÑ ÿßŸÑÿßÿ≥ÿ™ÿπÿßÿØÿ©.
              </p>
            </div>

            <input type="file" id="backupFileInput" accept=".json" style="display: none;" onchange="handleBackupRestore(event)">
            
            <button class="btn btn-warning" onclick="document.getElementById('backupFileInput').click()" style="width: 100%; padding: 1.5rem; font-size: 1.1rem;">
              <i class="fas fa-upload"></i> ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
            </button>
          </div>

          <!-- ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-clock"></i> ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="autoBackupEnabled" style="width: auto;">
                <span>ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä</span>
              </label>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ™ŸÉÿ±ÿßÿ± ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä</label>
              <select class="form-select" id="autoBackupFrequency">
                <option value="daily">ŸäŸàŸÖŸäÿßŸã</option>
                <option value="weekly">ÿ£ÿ≥ÿ®ŸàÿπŸäÿßŸã</option>
                <option value="monthly">ÿ¥Ÿáÿ±ŸäÿßŸã</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">ŸÖŸàŸÇÿπ ÿ≠ŸÅÿ∏ ÿßŸÑŸÜÿ≥ÿÆ</label>
              <div style="display: flex; gap: 1rem;">
                <input type="text" class="form-input" id="backupLocation" readonly value="ÿßŸÑŸÖÿ¨ŸÑÿØ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä">
                <button class="btn btn-secondary" onclick="chooseBackupLocation()">
                  <i class="fas fa-folder-open"></i> ÿ™ÿ∫ŸäŸäÿ±
                </button>
              </div>
            </div>

            <button class="btn btn-primary" onclick="saveBackupSettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä
            </button>
          </div>

          <!-- ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-exclamation-circle"></i> ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ
            </h3>

            <div style="background: rgba(239, 68, 68, 0.1); border-right: 4px solid #ef4444; padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem;">
              <h4 style="color: #ef4444; margin-bottom: 0.5rem;">
                <i class="fas fa-skull-crossbones"></i> ÿÆÿ∑ÿ± - ÿπŸÖŸÑŸäÿ© ÿ∫Ÿäÿ± ŸÇÿßÿ®ŸÑÿ© ŸÑŸÑÿ™ÿ±ÿßÿ¨ÿπ
              </h4>
              <p style="color: var(--theme-text-secondary); line-height: 1.6; margin-bottom: 1rem;">
                Ÿáÿ∞Ÿá ÿßŸÑÿπŸÖŸÑŸäÿ© ÿ≥ÿ™ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸàÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ Ÿàÿ™ÿπŸäÿØ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸÑÿ≠ÿßŸÑÿ™Ÿá ÿßŸÑÿ£ŸàŸÑŸâ. 
                ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿπŸÖŸÑŸäÿ© ÿ®ÿπÿØ ÿ™ŸÜŸÅŸäÿ∞Ÿáÿß!
              </p>
              <ul style="color: var(--theme-text-secondary); line-height: 1.8; margin-right: 1.5rem;">
                <li>üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸàÿßŸÑŸÅÿ¶ÿßÿ™</li>
                <li>üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ŸàÿßŸÑÿπŸÖŸÑÿßÿ°</li>
                <li>üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</li>
                <li>üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿØŸäŸàŸÜ ŸàÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</li>
                <li>üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸàÿßŸÑÿ™ÿÆÿµŸäÿµÿßÿ™</li>
                <li>üóëÔ∏è ŸÖÿ≥ÿ≠ ŸÇŸàÿßÿπÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ</li>
              </ul>
            </div>

            <div style="display: grid; gap: 1rem;">
              <button class="btn btn-warning" onclick="clearSampleData()" style="padding: 1rem; font-size: 1rem;">
                <i class="fas fa-broom"></i> ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÅŸÇÿ∑
              </button>
              
              <button class="btn btn-danger" onclick="confirmFactoryReset()" style="padding: 1.5rem; font-size: 1.1rem;">
                <i class="fas fa-trash-alt"></i> ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ ÿßŸÑŸÉÿßŸÖŸÑÿ© (ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ¥Ÿäÿ°)
              </button>
            </div>
          </div>

        </div>
      </div>
     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ -->
     <div id="settings-notifications" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-bell"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-boxes"></i> ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="lowStockNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ÿßŸÜÿÆŸÅÿßÿ∂ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</span>
              </label>
            </div>

            <div class="form-group">
              <label class="form-label">ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ™ÿ≠ÿ∞Ÿäÿ± (%)</label>
              <input type="number" class="form-input" id="lowStockThreshold" value="20" min="0" max="100">
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØŸÖÿß ŸäÿµŸÑ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿ•ŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑŸÜÿ≥ÿ®ÿ© ŸÖŸÜ ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ
              </small>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="outOfStockNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ŸÜŸÅÿßÿ∞ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="expiryNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ÿßŸÇÿ™ÿ±ÿßÿ® ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿ©</span>
              </label>
            </div>
          </div>

          <!-- ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-shopping-cart"></i> ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="salesNotifications" checked style="width: auto;">
                <span>ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ÿßŸÑŸäŸàŸÖŸäÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="largeSaleNotifications" style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ÿ®Ÿäÿπ ÿ®ŸÖÿ®ŸÑÿ∫ ŸÉÿ®Ÿäÿ±</span>
              </label>
            </div>

            <div class="form-group">
              <label class="form-label">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÉÿ®Ÿäÿ± (ÿØŸäŸÜÿßÿ±)</label>
              <input type="number" class="form-input" id="largeSaleAmount" value="1000000">
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="dailySalesReport" checked style="width: auto;">
                <span>ÿ™ŸÇÿ±Ÿäÿ± ŸÖÿ®Ÿäÿπÿßÿ™ ŸäŸàŸÖŸä (ŸÜŸáÿßŸäÿ© ÿßŸÑŸäŸàŸÖ)</span>
              </label>
            </div>
          </div>

          <!-- ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿØŸäŸàŸÜ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-file-invoice-dollar"></i> ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿØŸäŸàŸÜ
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="debtNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ÿ•ÿ∂ÿßŸÅÿ© ÿØŸäŸÜ ÿ¨ÿØŸäÿØ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="debtDueNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ÿπŸÜÿØ ÿßŸÇÿ™ÿ±ÿßÿ® ŸÖŸàÿπÿØ ÿ≥ÿØÿßÿØ ÿØŸäŸÜ</span>
              </label>
            </div>

            <div class="form-group">
              <label class="form-label">ÿßŸÑÿ™ŸÜÿ®ŸäŸá ŸÇÿ®ŸÑ ÿßŸÑŸÖŸàÿπÿØ ÿ®ŸÄ (ÿ£ŸäÿßŸÖ)</label>
              <input type="number" class="form-input" id="debtDueDays" value="3" min="1">
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="overdueDebtNotifications" checked style="width: auto;">
                <span>ÿ™ŸÜÿ®ŸäŸá ŸäŸàŸÖŸä ŸÑŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±ÿ©</span>
              </label>
            </div>
          </div>

          <!-- ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-desktop"></i> ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="updateNotifications" checked style="width: auto;">
                <span>ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ÿßÿ™ ÿßŸÑŸÖÿ™ŸàŸÅÿ±ÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="backupReminders" checked style="width: auto;">
                <span>ÿ™ÿ∞ŸÉŸäÿ± ÿ®ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="soundNotifications" checked style="width: auto;">
                <span>ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ£ÿµŸàÿßÿ™ ŸÖÿπ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™</span>
              </label>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn btn-primary" onclick="saveNotificationSettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            </button>
            <button class="btn btn-secondary" onclick="showPage('settings')">
              <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°
            </button>
          </div>

        </div>
      </div>
     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© -->
     <div id="settings-printing" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-print"></i> ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-print"></i> ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
            </h3>

            <div class="form-group">
              <label class="form-label">ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ∑ÿßÿ®ÿπÿ©</label>
              <select class="form-select" id="defaultPrinterSelect">
                <option value="">ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ© ŸÑŸÑŸÜÿ∏ÿßŸÖ</option>
                <option value="printer1">Thermal Printer POS-80</option>
                <option value="printer2">HP LaserJet Pro</option>
              </select>
              <button class="btn btn-secondary" onclick="refreshPrinters()" style="margin-top: 0.5rem;">
                <i class="fas fa-sync"></i> ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿßÿ™
              </button>
            </div>

            <div class="form-group">
              <label class="form-label">ÿ≠ÿ¨ŸÖ ÿßŸÑŸàÿ±ŸÇÿ©</label>
              <select class="form-select" id="paperSizeSelect">
                <option value="58mm">58mm (Thermal)</option>
                <option value="80mm" selected>80mm (Thermal)</option>
                <option value="A4">A4</option>
                <option value="A5">A5</option>
              </select>
            </div>
          </div>

          <!-- ÿ™ÿµŸÖŸäŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-receipt"></i> ÿ™ÿµŸÖŸäŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            </h3>

            <div class="form-group">
              <label class="form-label">ÿ≠ÿ¨ŸÖ ÿÆÿ∑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</label>
              <select class="form-select" id="invoiceFontSize">
                <option value="small">ÿµÿ∫Ÿäÿ± (10px)</option>
                <option value="medium" selected>ŸÖÿ™Ÿàÿ≥ÿ∑ (12px)</option>
                <option value="large">ŸÉÿ®Ÿäÿ± (14px)</option>
                <option value="xlarge">ŸÉÿ®Ÿäÿ± ÿ¨ÿØÿßŸã (16px)</option>
              </select>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="showLogoOnInvoice" checked style="width: auto;">
                <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ¥ÿπÿßÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿπŸÑŸâ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="showBarcodeOnInvoice" checked style="width: auto;">
                <span>ÿ•ÿ∏Ÿáÿßÿ± ÿ®ÿßÿ±ŸÉŸàÿØ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="showTaxOnInvoice" checked style="width: auto;">
                <span>ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ© ÿπŸÑŸâ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label class="form-label">ŸÖŸÑÿßÿ≠ÿ∏ÿ© ŸÅŸä ŸÜŸáÿßŸäÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</label>
              <textarea class="form-input" id="invoiceFooterNote" rows="3" placeholder="ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ - ŸÜÿ™ŸÖŸÜŸâ ŸÑŸÉŸÖ ŸäŸàŸÖÿßŸã ÿ≥ÿπŸäÿØÿßŸã"></textarea>
            </div>
          </div>

          <!-- ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿäÿ© -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-magic"></i> ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿäÿ©
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="autoPrintInvoice" style="width: auto;">
                <span>ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ ŸÉŸÑ ÿπŸÖŸÑŸäÿ© ÿ®Ÿäÿπ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="printCopies" style="width: auto;">
                <span>ÿ∑ÿ®ÿßÿπÿ© ŸÜÿ≥ÿÆÿ™ŸäŸÜ (ŸÜÿ≥ÿÆÿ© ŸÑŸÑÿπŸÖŸäŸÑ ŸàŸÜÿ≥ÿÆÿ© ŸÑŸÑÿ£ÿ±ÿ¥ŸäŸÅ)</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="openCashDrawer" style="width: auto;">
                <span>ŸÅÿ™ÿ≠ ÿØÿ±ÿ¨ ÿßŸÑŸÜŸÇŸàÿØ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ÿ®ÿπÿØ ÿßŸÑÿ®Ÿäÿπ</span>
              </label>
            </div>

            <button class="btn" style="background: linear-gradient(135deg, #667eea, #764ba2); width: 100%; padding: 1.2rem; margin-top: 1rem;" onclick="printTestPage()">
              <i class="fas fa-file-pdf"></i> ÿ∑ÿ®ÿßÿπÿ© ÿµŸÅÿ≠ÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
            </button>
          </div>

          <div class="form-actions">
            <button class="btn btn-primary" onclick="savePrintingSettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            </button>
            <button class="btn btn-secondary" onclick="showPage('settings')">
              <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°
            </button>
          </div>

        </div>
      </div>
     </div>

     <!-- ÿµŸÅÿ≠ÿ© ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ -->
     <div id="settings-security" class="page" style="display: none;">
      <div class="section-header">
       <button class="btn btn-secondary" onclick="showPage('settings')" style="margin-left: 1rem;">
         <i class="fas fa-arrow-right"></i> ÿ±ÿ¨Ÿàÿπ
       </button>
       <div class="section-title"><i class="fas fa-shield-alt"></i> ÿßŸÑÿ£ŸÖÿßŸÜ ŸàÿßŸÑÿÆÿµŸàÿµŸäÿ©</div>
      </div>

      <div style="max-width: 900px; margin: 0 auto;">
        <div class="table-container" style="padding: 2rem;">
          
          <!-- ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-key"></i> ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="enablePassword" style="width: auto;">
                <span>ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ÿ®ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ±</span>
              </label>
            </div>

            <div id="passwordFields" style="display: none;">
              <div class="form-group">
                <label class="form-label">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ≠ÿßŸÑŸäÿ©</label>
                <input type="password" class="form-input" id="currentPassword">
              </div>

              <div class="form-group">
                <label class="form-label">ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©</label>
                <input type="password" class="form-input" id="newPassword">
              </div>

              <div class="form-group">
                <label class="form-label">ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±</label>
                <input type="password" class="form-input" id="confirmPassword">
              </div>

              <button class="btn btn-warning" onclick="changePassword()">
                <i class="fas fa-key"></i> ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
              </button>
            </div>
          </div>

          <!-- ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™ -->
          <div style="margin-bottom: 3rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-user-shield"></i> ÿßŸÑÿµŸÑÿßÿ≠Ÿäÿßÿ™
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="requirePasswordForDelete" checked style="width: auto;">
                <span>ÿ∑ŸÑÿ® ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿπŸÜÿØ ÿßŸÑÿ≠ÿ∞ŸÅ</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="requirePasswordForReports" style="width: auto;">
                <span>ÿ∑ŸÑÿ® ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑŸÖÿßŸÑŸäÿ©</span>
              </label>
            </div>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="requirePasswordForSettings" checked style="width: auto;">
                <span>ÿ∑ŸÑÿ® ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑÿ™ÿπÿØŸäŸÑ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™</span>
              </label>
            </div>
          </div>

          <!-- ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™ -->
          <div style="margin-bottom: 2rem;">
            <h3 style="margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(255,255,255,0.1);">
              <i class="fas fa-history"></i> ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™
            </h3>

            <div class="form-group">
              <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" id="enableActivityLog" checked style="width: auto;">
                <span>ÿ™ŸÅÿπŸäŸÑ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™</span>
              </label>
              <small style="color: var(--theme-text-secondary); margin-top: 0.5rem; display: block;">
                ÿ™ÿ≥ÿ¨ŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿπŸÖŸÑŸäÿßÿ™ (ÿßŸÑÿ®Ÿäÿπÿå ÿßŸÑÿ≠ÿ∞ŸÅÿå ÿßŸÑÿ™ÿπÿØŸäŸÑ)
              </small>
            </div>

            <div class="form-group">
              <label class="form-label">ŸÖÿØÿ© ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑÿ≥ÿ¨ŸÑ</label>
              <select class="form-select" id="logRetentionPeriod">
                <option value="30">30 ŸäŸàŸÖ</option>
                <option value="90" selected>90 ŸäŸàŸÖ</option>
                <option value="180">180 ŸäŸàŸÖ</option>
                <option value="365">ÿ≥ŸÜÿ© ŸÉÿßŸÖŸÑÿ©</option>
                <option value="0">ÿ®ÿØŸàŸÜ ÿ≠ÿØ</option>
              </select>
            </div>

            <button class="btn btn-secondary" onclick="viewActivityLog()">
              <i class="fas fa-list"></i> ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™
            </button>
          </div>

          <div class="form-actions">
            <button class="btn btn-primary" onclick="saveSecuritySettings()">
              <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            </button>
            <button class="btn btn-secondary" onclick="showPage('settings')">
              <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°
            </button>
          </div>

        </div>
      </div>
     </div>

    </div>
   </main>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ -->
  <div id="addProductModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-plus-circle"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ ÿ¨ÿØŸäÿØ</h3><button class="close-btn" onclick="closeModal('addProductModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <form id="addProductForm">
     <div class="form-grid">
      <div class="form-group"><label class="form-label"> <i class="fas fa-tag"></i> ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ </label> <input type="text" class="form-input" id="productName" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-barcode"></i> ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ </label>
       <div class="barcode-section"><input type="text" class="form-input barcode-input" id="productBarcode"> <button type="button" class="generate-barcode-btn" onclick="generateBarcode()"> <i class="fas fa-magic"></i> ÿ™ŸàŸÑŸäÿØ </button>
       </div>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-layer-group"></i> ÿßŸÑÿ™ÿµŸÜŸäŸÅ </label> <select class="form-select" id="productCategory" required> <option value="">ÿßÿÆÿ™ÿ± ÿßŸÑÿ™ÿµŸÜŸäŸÅ</option> </select>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-truck"></i> ÿßŸÑŸÖŸàÿ±ÿØ </label> <input type="text" class="form-input" id="productSupplier">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-coins"></i> ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© (ŸÖŸÅÿ±ÿØ) </label> <input type="number" class="form-input" id="productCostRetail" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-coins"></i> ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© (ÿ¨ŸÖŸÑÿ©) </label> <input type="number" class="form-input" id="productCostWholesale">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-money-bill"></i> ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ (ŸÖŸÅÿ±ÿØ) </label> <input type="number" class="form-input" id="productPriceRetail" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-money-bill"></i> ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ (ÿ¨ŸÖŸÑÿ©) </label> <input type="number" class="form-input" id="productPriceWholesale">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-warehouse"></i> ÿßŸÑŸÉŸÖŸäÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ© </label> <input type="number" class="form-input" id="productStock" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-exclamation-triangle"></i> ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑŸÖÿÆÿ≤ŸàŸÜ </label> <input type="number" class="form-input" id="productMinStock" value="10">
      </div>
     </div>
     <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('addProductModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="submit" class="btn btn-primary"> <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿßŸÑŸÖŸÜÿ™ÿ¨ </button>
     </div>
    </form>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿπÿØŸäŸÑ ŸÖŸÜÿ™ÿ¨ -->
  <div id="editProductModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-edit"></i> ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨</h3><button class="close-btn" onclick="closeModal('editProductModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <form id="editProductForm" onsubmit="handleEditProduct(event)">
     <input type="hidden" id="editProductId">
     <div class="form-grid">
      <div class="form-group"><label class="form-label"> <i class="fas fa-tag"></i> ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨ </label> <input type="text" class="form-input" id="editProductName" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-barcode"></i> ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ </label> <input type="text" class="form-input" id="editProductBarcode">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-layer-group"></i> ÿßŸÑÿ™ÿµŸÜŸäŸÅ </label> <select class="form-select" id="editProductCategory" required> <option value="">ÿßÿÆÿ™ÿ± ÿßŸÑÿ™ÿµŸÜŸäŸÅ</option> </select>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-truck"></i> ÿßŸÑŸÖŸàÿ±ÿØ </label> <input type="text" class="form-input" id="editProductSupplier">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-coins"></i> ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© (ŸÖŸÅÿ±ÿØ) </label> <input type="number" class="form-input" id="editProductCostRetail" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-coins"></i> ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© (ÿ¨ŸÖŸÑÿ©) </label> <input type="number" class="form-input" id="editProductCostWholesale">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-money-bill"></i> ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ (ŸÖŸÅÿ±ÿØ) </label> <input type="number" class="form-input" id="editProductPriceRetail" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-money-bill"></i> ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ (ÿ¨ŸÖŸÑÿ©) </label> <input type="number" class="form-input" id="editProductPriceWholesale">
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-warehouse"></i> ÿßŸÑŸÉŸÖŸäÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ© </label> <input type="number" class="form-input" id="editProductStock" required>
      </div>
      <div class="form-group"><label class="form-label"> <i class="fas fa-exclamation-triangle"></i> ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑŸÖÿÆÿ≤ŸàŸÜ </label> <input type="number" class="form-input" id="editProductMinStock">
      </div>
     </div>
     <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('editProductModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="submit" class="btn btn-success"> <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿπÿØŸäŸÑÿßÿ™ </button>
     </div>
    </form>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅ -->
  <div id="addCategoryModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-plus-circle"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅ ÿ¨ÿØŸäÿØ</h3><button class="close-btn" onclick="closeModal('addCategoryModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <form id="addCategoryForm">
     <div class="form-group"><label class="form-label"> <i class="fas fa-tag"></i> ÿßÿ≥ŸÖ ÿßŸÑÿ™ÿµŸÜŸäŸÅ </label> <input type="text" class="form-input" id="categoryName" required>
     </div>
     <div class="form-group"><label class="form-label"> <i class="fas fa-icons"></i> ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ£ŸäŸÇŸàŸÜÿ© </label>
      <div class="category-icon-grid" id="categoryIconGrid"><!-- ÿßŸÑÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
      </div><input type="hidden" id="selectedCategoryIcon" value="fas fa-box">
     </div>
     <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('addCategoryModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="submit" class="btn btn-primary"> <i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿµŸÜŸäŸÅ </button>
     </div>
    </form>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ -->
  <div id="paymentModal" class="modal">
   <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-credit-card"></i> ÿßÿÆÿ™Ÿäÿßÿ± ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ</h3>
     <button class="close-btn" onclick="closeModal('paymentModal')">
         <i class="fas fa-times"></i>
     </button>
    </div>
    
    <!-- ÿÆŸäÿßÿ±ÿßÿ™ ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ -->
    <div class="payment-options-container">
        <button class="payment-option-card cash-payment" onclick="processCashPayment()">
            <div class="payment-option-icon">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="payment-option-title">ÿØŸÅÿπ ŸÜŸÇÿØŸä</div>
            <div class="payment-option-description">ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ ŸÅŸàÿ±ÿßŸã ÿ®ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÜŸÇÿØŸä</div>
        </button>
        
        <button class="payment-option-card installment-payment" onclick="showInstallmentForm()">
            <div class="payment-option-icon">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="payment-option-title">ÿØŸÅÿπ ÿ®ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</div>
            <div class="payment-option-description">ÿ™ŸÇÿ≥ŸäŸÖ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿπŸÑŸâ ÿπÿØÿ© ÿ£ÿ¥Ÿáÿ±</div>
        </button>
    </div>
    
    <!-- ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ -->
    <div id="installmentForm" class="installment-form">
        <div class="installment-header">
            <i class="fas fa-user-edit"></i>
            <h4>ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ ŸàÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</h4>
        </div>
        
        <!-- ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ -->
        <div class="form-section">
            <div class="section-title">
                <i class="fas fa-user-circle"></i>
                <span>ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ</span>
            </div>
            <div class="form-grid-2">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-user"></i>
                        ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input" id="customerName" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ" required>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-phone"></i>
                        ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input" id="customerPhone" placeholder="07XX XXX XXXX" required>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-map-marker-alt"></i>
                    ÿßŸÑÿπŸÜŸàÿßŸÜ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)
                </label>
                <input type="text" class="form-input" id="customerAddress" placeholder="ÿ£ÿØÿÆŸÑ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿπŸÖŸäŸÑ">
            </div>
        </div>
        
        <!-- ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ -->
        <div class="form-section">
            <div class="section-title">
                <i class="fas fa-calculator"></i>
                <span>ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</span>
            </div>
            <div class="form-grid-3">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-calendar"></i>
                        ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ±
                    </label>
                    <input type="number" class="form-input" id="installmentMonths" min="1" max="60" value="12" onchange="calculateInstallment()">
                    <small class="form-hint">ŸÖŸÜ 1 ÿ•ŸÑŸâ 60 ÿ¥Ÿáÿ±</small>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-money-bill-wave"></i>
                        ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ∂ÿßŸÅŸä
                    </label>
                    <input type="number" class="form-input" id="additionalAmount" value="0" min="0" step="1000" placeholder="0" onchange="calculateInstallment()">
                    <small class="form-hint">ÿßŸÑÿ≤ŸäÿßÿØÿ© ÿπŸÑŸâ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ£ÿµŸÑŸä</small>
                </div>
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-hand-holding-usd"></i>
                        ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©
                    </label>
                    <input type="number" class="form-input" id="downPayment" value="0" min="0" step="1000" placeholder="0" onchange="calculateInstallment()">
                    <small class="form-hint">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ ŸÖŸÇÿØŸÖÿßŸã</small>
                </div>
            </div>
        </div>
        
        <!-- ŸÖŸÑÿÆÿµ ÿßŸÑÿ≠ÿ≥ÿßÿ® -->
        <div class="installment-summary">
            <div class="summary-title">
                <i class="fas fa-file-invoice-dollar"></i>
                <span>ŸÖŸÑÿÆÿµ ÿßŸÑÿ≠ÿ≥ÿßÿ®</span>
            </div>
            <div class="summary-items">
                <div class="summary-row">
                    <span class="summary-label">
                        <i class="fas fa-shopping-cart"></i>
                        ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ£ÿµŸÑŸä
                    </span>
                    <span class="summary-value" id="originalAmount">0 ÿØŸäŸÜÿßÿ±</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">
                        <i class="fas fa-plus-circle"></i>
                        ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ∂ÿßŸÅŸä
                    </span>
                    <span class="summary-value text-warning" id="addedProfit">0 ÿØŸäŸÜÿßÿ±</span>
                </div>
                <div class="summary-row" id="downPaymentRow" style="display: none;">
                    <span class="summary-label">
                        <i class="fas fa-hand-holding-usd"></i>
                        ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©
                    </span>
                    <span class="summary-value text-success" id="downPaymentDisplay">0 ÿØŸäŸÜÿßÿ±</span>
                </div>
                <div class="summary-divider"></div>
                <div class="summary-row total-row">
                    <span class="summary-label">
                        <i class="fas fa-wallet"></i>
                        ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
                    </span>
                    <span class="summary-value" id="totalInstallmentAmount">0 ÿØŸäŸÜÿßÿ±</span>
                </div>
                <div class="summary-row monthly-row">
                    <span class="summary-label">
                        <i class="fas fa-calendar-check"></i>
                        ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä
                    </span>
                    <span class="summary-value highlight" id="monthlyPayment">0 ÿØŸäŸÜÿßÿ±</span>
                </div>
            </div>
        </div>
        
        <!-- ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ -->
        <div class="form-actions">
            <button type="button" class="btn btn-secondary" onclick="closeModal('paymentModal')">
                <i class="fas fa-times"></i>
                ÿ•ŸÑÿ∫ÿßÿ°
            </button>
            <button type="button" class="btn btn-primary" onclick="processInstallmentPayment()">
                <i class="fas fa-check-circle"></i>
                ÿ≠ŸÅÿ∏ Ÿàÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ
            </button>
        </div>
    </div>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ -->
  <div id="productDetailsModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-info-circle"></i> ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨</h3><button class="close-btn" onclick="closeModal('productDetailsModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <div id="productDetailsContent"><!-- ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
    </div>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© -->
  <div id="invoiceDetailsModal" class="modal">
   <div class="modal-content" style="max-width: 800px;">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-file-invoice"></i> ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</h3><button class="close-btn" onclick="closeModal('invoiceDetailsModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <div id="invoiceDetailsContent"><!-- ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
    </div>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ -->
  <div id="debtDetailsModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-user-circle"></i> ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿπŸÖŸäŸÑ ŸàÿßŸÑÿØŸäŸÜ</h3><button class="close-btn" onclick="closeModal('debtDetailsModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <div id="debtDetailsContent"><!-- ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß -->
    </div>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑÿØŸäŸÜ -->
  <div id="payDebtModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-money-check-alt"></i> ÿ™ÿ≥ÿØŸäÿØ ÿØŸäŸÜ</h3><button class="close-btn" onclick="closeModal('payDebtModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <form id="payDebtForm">
     <div class="form-group"><label class="form-label">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä</label> <input type="text" class="form-input" id="remainingDebtAmount" readonly>
     </div>
     <div class="form-group"><label class="form-label">ŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ™ÿ≥ÿØŸäÿØ</label> <input type="number" class="form-input" id="paymentAmount" required>
     </div>
     <div class="form-group"><label class="form-label">ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™</label> <textarea class="form-input" id="paymentNotes" rows="3"></textarea>
     </div>
     <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('payDebtModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="submit" class="btn btn-success"> <i class="fas fa-check"></i> ÿ™ÿ≥ÿØŸäÿØ </button>
     </div>
    </form>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿØŸäÿØ ŸÇÿ≥ÿ∑ ÿ¥Ÿáÿ±Ÿä -->
  <div id="payInstallmentModal" class="modal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title"><i class="fas fa-money-check-alt"></i> ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä</h3><button class="close-btn" onclick="closeModal('payInstallmentModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <form id="payInstallmentForm" onsubmit="handlePayInstallment(event)">
     <div class="form-group"><label class="form-label">ÿßŸÑÿ¥Ÿáÿ±</label> <input type="text" class="form-input" id="installmentMonthDisplay" readonly>
     </div>
     <div class="form-group"><label class="form-label">ŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÇÿ≥ÿ∑</label> <input type="text" class="form-input" id="installmentAmountDisplay" readonly>
     </div>
     <div class="form-group"><label class="form-label">ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)</label> <textarea class="form-input" id="installmentNotes" rows="3" placeholder="ÿ£ÿ∂ŸÅ ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ•ÿ∞ÿß ÿ£ÿ±ÿØÿ™..."></textarea>
     </div>
     <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('payInstallmentModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="submit" class="btn btn-success"> <i class="fas fa-check"></i> ÿ™ÿ≥ÿØŸäÿØ </button>
     </div>
    </form>
   </div>
  </div><!-- ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≠ÿ∞ŸÅ -->
  <div id="confirmDeleteModal" class="modal">
   <div class="modal-content" style="max-width: 500px;">
    <div class="modal-header">
     <h3 class="modal-title" style="color: var(--danger-color);"><i class="fas fa-exclamation-triangle"></i> ÿ™ÿ≠ÿ∞Ÿäÿ±: ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ</h3><button class="close-btn" onclick="closeModal('confirmDeleteModal')"> <i class="fas fa-times"></i> </button>
    </div>
    <div style="padding: 1rem 0;">
     <div style="background: var(--danger-gradient); opacity: 0.1; padding: 2rem; border-radius: 12px; text-align: center; margin-bottom: 1.5rem;"><i class="fas fa-exclamation-circle" style="font-size: 4rem; color: var(--danger-color);"></i>
     </div>
     <div style="text-align: center; margin-bottom: 1.5rem;">
      <h4 style="font-size: 1.25rem; margin-bottom: 0.5rem; color: var(--theme-text-primary);">ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿØŸäŸÜÿü</h4>
      <p style="color: var(--theme-text-secondary); font-size: 0.95rem;">ÿßŸÑÿπŸÖŸäŸÑ: <strong id="deleteDebtCustomerName" style="color: var(--theme-text-primary);"></strong></p>
     </div>
     <div style="background: var(--theme-bg-secondary); border-right: 4px solid var(--danger-color); padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
      <p style="font-weight: 600; margin-bottom: 0.75rem; color: var(--danger-color);"><i class="fas fa-info-circle"></i> ÿ≥Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅ:</p>
      <ul style="list-style: none; padding-right: 1.5rem; color: var(--theme-text-secondary); font-size: 0.9rem;">
       <li style="margin-bottom: 0.5rem;"><i class="fas fa-check" style="color: var(--danger-color); margin-left: 0.5rem;"></i> ÿ¨ŸÖŸäÿπ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿØŸäŸÜ</li>
       <li style="margin-bottom: 0.5rem;"><i class="fas fa-check" style="color: var(--danger-color); margin-left: 0.5rem;"></i> ÿ¨ŸÖŸäÿπ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</li>
       <li style="margin-bottom: 0.5rem;"><i class="fas fa-check" style="color: var(--danger-color); margin-left: 0.5rem;"></i> ÿ¨ŸÖŸäÿπ ÿ≥ÿ¨ŸÑÿßÿ™ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™</li>
      </ul>
      <p style="margin-top: 1rem; font-weight: 600; color: var(--danger-color); font-size: 0.9rem;"><i class="fas fa-exclamation-triangle"></i> Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜŸá!</p>
     </div>
    </div>
    <div class="form-actions"><button type="button" class="btn btn-secondary" onclick="closeModal('confirmDeleteModal')"> <i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ° </button> <button type="button" class="btn btn-danger" onclick="executeDeleteDebt()" style="background: var(--danger-gradient);"> <i class="fas fa-trash-alt"></i> ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≠ÿ∞ŸÅ </button>
    </div>
   </div>
  </div>
  <script>
        // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        let cart = [];
        let products = [];
        let categories = [];
        let salesData = [];
        let debtsData = [];
        let selectedPaymentMethod = 'ŸÜŸÇÿØŸä';
        let isLoading = false;
        let currentCategory = 'all';
        let notifications = [];
        let currentTheme = 'dark';
        let sidebarCollapsed = false;
        
        // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑŸÇÿ≥ÿ∑
        let currentInstallmentDebtId = null;
        let currentInstallmentMonth = null;
        
        // ŸÖÿ™ÿ∫Ÿäÿ± ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ
        let debtToDelete = null;

        // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
        const defaultConfig = {
            store_name: 'ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿ™ŸÇŸÜŸäÿ© ÿßŸÑÿ≠ÿØŸäÿ´ÿ©',
            store_address: 'ÿ®ÿ∫ÿØÿßÿØ - ÿßŸÑŸÖŸÜÿµŸàÿ±',
            store_phone: '07901234567',
            tax_rate: '0'
        };

        // ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™ ÿßŸÑŸÖÿ™ÿßÿ≠ÿ©
        const availableIcons = [
            // ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸäÿßÿ™ Ÿàÿ≠Ÿàÿßÿ≥Ÿäÿ®
            'fas fa-laptop', 'fas fa-desktop', 'fas fa-tablet-alt', 'fas fa-mobile-alt',
            'fas fa-keyboard', 'fas fa-mouse', 'fas fa-headphones', 'fas fa-microphone',
            'fas fa-camera', 'fas fa-video', 'fas fa-webcam', 'fas fa-gamepad',
            'fas fa-headset', 'fas fa-microchip', 'fas fa-memory', 'fas fa-hdd',
            'fas fa-sim-card', 'fas fa-sd-card', 'fas fa-save', 'fas fa-compact-disc',
            'fas fa-server', 'fas fa-database', 'fas fa-network-wired', 'fas fa-ethernet',
            'fas fa-wifi', 'fas fa-bluetooth', 'fas fa-satellite-dish', 'fas fa-router',
            'fas fa-usb', 'fas fa-plug', 'fas fa-power-off', 'fas fa-print',
            'fas fa-scanner', 'fas fa-fax', 'fas fa-calculator', 'fas fa-cash-register',
            
            // ÿ£ÿ¨Ÿáÿ≤ÿ© ŸÉŸáÿ±ÿ®ÿßÿ¶Ÿäÿ© ŸÖŸÜÿ≤ŸÑŸäÿ©
            'fas fa-tv', 'fas fa-blender', 'fas fa-lightbulb', 'fas fa-fan', 
            'fas fa-snowflake', 'fas fa-fire', 'fas fa-temperature-high', 'fas fa-temperature-low',
            'fas fa-thermometer-half', 'fas fa-wind', 'fas fa-bolt', 'fas fa-charging-station',
            'fas fa-battery-full', 'fas fa-battery-half', 'fas fa-battery-quarter', 'fas fa-solar-panel',
            'fas fa-broadcast-tower', 'fas fa-satellite', 'fas fa-coffee', 'fas fa-mug-hot',
            'fas fa-blender-phone', 'fas fa-utensils', 'fas fa-sink', 'fas fa-toilet',
            'fas fa-shower', 'fas fa-bath', 'fas fa-pump-soap', 'fas fa-spray-can',
            
            // ŸÖŸÉÿ™ÿ®Ÿäÿßÿ™ ŸàŸÇÿ±ÿ∑ÿßÿ≥Ÿäÿ©
            'fas fa-book', 'fas fa-book-open', 'fas fa-bookmark', 'fas fa-books',
            'fas fa-pen', 'fas fa-pencil-alt', 'fas fa-pen-fancy', 'fas fa-pen-nib',
            'fas fa-marker', 'fas fa-highlighter', 'fas fa-eraser', 'fas fa-ruler',
            'fas fa-ruler-combined', 'fas fa-ruler-horizontal', 'fas fa-ruler-vertical', 'fas fa-drafting-compass',
            'fas fa-paperclip', 'fas fa-thumbtack', 'fas fa-sticky-note', 'fas fa-clipboard',
            'fas fa-clipboard-list', 'fas fa-paste', 'fas fa-file', 'fas fa-file-alt',
            'fas fa-folder', 'fas fa-folder-open', 'fas fa-archive', 'fas fa-envelope',
            'fas fa-envelope-open', 'fas fa-stamp', 'fas fa-stapler', 'fas fa-scissors',
            
            // ÿ£ÿ´ÿßÿ´ ŸàŸÖŸÉÿßÿ™ÿ®
            'fas fa-chair', 'fas fa-couch', 'fas fa-bed', 'fas fa-door-open',
            'fas fa-door-closed', 'fas fa-table', 'fas fa-desktop', 'fas fa-lamp',
            'fas fa-warehouse', 'fas fa-store', 'fas fa-store-alt', 'fas fa-building',
            
            // ŸÖŸÑÿßÿ®ÿ≥ Ÿàÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™
            'fas fa-tshirt', 'fas fa-hat-cowboy', 'fas fa-hat-wizard', 'fas fa-glasses',
            'fas fa-sunglasses', 'fas fa-ring', 'fas fa-gem', 'fas fa-crown',
            'fas fa-user-tie', 'fas fa-shoe-prints', 'fas fa-socks', 'fas fa-mitten',
            'fas fa-watch', 'fas fa-clock', 'fas fa-stopwatch', 'fas fa-hourglass',
            
            // ÿ±Ÿäÿßÿ∂ÿ© ŸàŸÑŸäÿßŸÇÿ©
            'fas fa-dumbbell', 'fas fa-running', 'fas fa-walking', 'fas fa-biking',
            'fas fa-swimming-pool', 'fas fa-bicycle', 'fas fa-football-ball', 'fas fa-basketball-ball',
            'fas fa-baseball-ball', 'fas fa-volleyball-ball', 'fas fa-table-tennis', 'fas fa-bowling-ball',
            'fas fa-skating', 'fas fa-skiing', 'fas fa-snowboarding', 'fas fa-heart',
            
            // ÿ£ÿØŸàÿßÿ™ ŸàÿµŸäÿßŸÜÿ©
            'fas fa-tools', 'fas fa-wrench', 'fas fa-screwdriver', 'fas fa-hammer',
            'fas fa-toolbox', 'fas fa-cog', 'fas fa-cogs', 'fas fa-paint-roller',
            'fas fa-brush', 'fas fa-magic', 'fas fa-spray-can', 'fas fa-fire-extinguisher',
            'fas fa-flashlight', 'fas fa-oil-can', 'fas fa-tape', 'fas fa-shield-alt',
            
            // ÿ∑ÿ®Ÿäÿ© Ÿàÿµÿ≠Ÿäÿ©
            'fas fa-medkit', 'fas fa-first-aid', 'fas fa-pills', 'fas fa-prescription-bottle',
            'fas fa-syringe', 'fas fa-thermometer', 'fas fa-heartbeat', 'fas fa-stethoscope',
            'fas fa-hospital', 'fas fa-ambulance', 'fas fa-wheelchair', 'fas fa-hand-holding-medical',
            
            // ÿ≥Ÿäÿßÿ±ÿßÿ™ ŸàŸÖÿ±ŸÉÿ®ÿßÿ™
            'fas fa-car', 'fas fa-car-side', 'fas fa-car-alt', 'fas fa-truck',
            'fas fa-motorcycle', 'fas fa-bus', 'fas fa-taxi', 'fas fa-shuttle-van',
            'fas fa-oil-can', 'fas fa-gas-pump', 'fas fa-tire', 'fas fa-wheel',
            
            // ÿ∑ÿπÿßŸÖ ŸàŸÖÿ¥ÿ±Ÿàÿ®ÿßÿ™
            'fas fa-utensils', 'fas fa-utensil-spoon', 'fas fa-utensil-fork', 'fas fa-pizza-slice',
            'fas fa-hamburger', 'fas fa-hotdog', 'fas fa-ice-cream', 'fas fa-cake',
            'fas fa-birthday-cake', 'fas fa-cookie', 'fas fa-apple-alt', 'fas fa-lemon',
            'fas fa-carrot', 'fas fa-pepper-hot', 'fas fa-cheese', 'fas fa-bread-slice',
            'fas fa-coffee', 'fas fa-mug-hot', 'fas fa-wine-glass', 'fas fa-glass-martini',
            'fas fa-beer', 'fas fa-wine-bottle', 'fas fa-flask', 'fas fa-blender',
            
            // ÿ≠ŸäŸàÿßŸÜÿßÿ™ ŸàŸÜÿ®ÿßÿ™ÿßÿ™
            'fas fa-dog', 'fas fa-cat', 'fas fa-fish', 'fas fa-dove',
            'fas fa-spider', 'fas fa-frog', 'fas fa-horse', 'fas fa-crow',
            'fas fa-seedling', 'fas fa-tree', 'fas fa-leaf', 'fas fa-cannabis',
            
            // ÿ™ÿ±ŸÅŸäŸá ŸàŸÅŸÜŸàŸÜ
            'fas fa-music', 'fas fa-guitar', 'fas fa-drum', 'fas fa-film',
            'fas fa-photo-video', 'fas fa-palette', 'fas fa-paint-brush', 'fas fa-theater-masks',
            'fas fa-ticket-alt', 'fas fa-trophy', 'fas fa-medal', 'fas fa-award',
            
            // ÿ™ÿπŸÑŸäŸÖ ŸàÿπŸÑŸàŸÖ
            'fas fa-graduation-cap', 'fas fa-school', 'fas fa-chalkboard', 'fas fa-chalkboard-teacher',
            'fas fa-user-graduate', 'fas fa-flask', 'fas fa-microscope', 'fas fa-atom',
            'fas fa-dna', 'fas fa-vial', 'fas fa-vials', 'fas fa-magnet',
            
            // ÿπÿßŸÖÿ© ŸàŸÖÿ™ŸÜŸàÿπÿ©
            'fas fa-box', 'fas fa-boxes', 'fas fa-cube', 'fas fa-cubes',
            'fas fa-shopping-bag', 'fas fa-shopping-cart', 'fas fa-shopping-basket', 'fas fa-gift',
            'fas fa-tag', 'fas fa-tags', 'fas fa-barcode', 'fas fa-qrcode',
            'fas fa-star', 'fas fa-crown', 'fas fa-gem', 'fas fa-key',
            'fas fa-lock', 'fas fa-unlock', 'fas fa-shield-alt', 'fas fa-home',
            'fas fa-map-marker-alt', 'fas fa-phone', 'fas fa-envelope', 'fas fa-globe',
            'fas fa-flag', 'fas fa-bell', 'fas fa-comment', 'fas fa-comments',
            'fas fa-umbrella', 'fas fa-sun', 'fas fa-moon', 'fas fa-cloud',
            'fas fa-snowflake', 'fas fa-rainbow', 'fas fa-fire', 'fas fa-water'
        ];

        // ŸÖÿπÿßŸÑÿ¨ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑŸÄ Data SDK
        const dataHandler = {
            onDataChanged(data) {
                // ÿ™ÿµŸÜŸäŸÅ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÜŸàÿπ
                products = data.filter(item => item.type === 'product');
                categories = data.filter(item => item.type === 'category');
                salesData = data.filter(item => item.type === 'sale');
                debtsData = data.filter(item => item.type === 'debt');
                
                console.log('Data changed - debtsData:', debtsData);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿßÿ™
                updateAllViews();
                updateNotifications();
            }
        };

        // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        async function initApp() {
            try {
                // ÿ™ŸáŸäÿ¶ÿ© Data SDK
                if (window.dataSdk) {
                    const initResult = await window.dataSdk.init(dataHandler);
                    if (!initResult.isOk) {
                        console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ŸáŸäÿ¶ÿ© ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™');
                        return;
                    }
                }

                // ÿ™ŸáŸäÿ¶ÿ© Element SDK
                if (window.elementSdk) {
                    await window.elementSdk.init({
                        defaultConfig,
                        onConfigChange: async (config) => {
                            document.getElementById('storeName').textContent = config.store_name || defaultConfig.store_name;
                            document.getElementById('taxRate').textContent = config.tax_rate || defaultConfig.tax_rate;
                            
                            // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
                            updateInvoicePreview(config);
                            updateCartSummary();
                        },
                        mapToCapabilities: (config) => ({
                            recolorables: [],
                            borderables: [],
                            fontEditable: undefined,
                            fontSizeable: undefined
                        }),
                        mapToEditPanelValues: (config) => new Map([
                            ['store_name', config.store_name || defaultConfig.store_name],
                            ['store_address', config.store_address || defaultConfig.store_address],
                            ['store_phone', config.store_phone || defaultConfig.store_phone],
                            ['tax_rate', config.tax_rate || defaultConfig.tax_rate]
                        ])
                    });
                }

                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ£ŸàŸÑ ŸÖÿ±ÿ© ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ
                const isFirstRun = !localStorage.getItem('appInitialized');
                
                // ÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿ©
                if (categories.length === 0) {
                    await addSampleCategories();
                }
                
                if (products.length === 0) {
                    await addSampleProducts();
                }
                
                // ÿ•ÿµŸÑÿßÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÇÿØŸäŸÖÿ©
                await fixOldDebtsData();

                // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
                loadPrinterSettings();
                
                // ÿ™ÿ≠ŸÖŸäŸÑ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                loadAllSettings();

                setupEventListeners();
                updateAllViews();
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ©
                updateQuickStats();
                
                // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ≥ÿßÿπÿ© ŸÅŸä ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÜŸàÿßŸÜ
                startTitlebarClock();
                
                // ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ≥ÿßÿπÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©
                updateDigitalClock();
                setInterval(updateDigitalClock, 1000);
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ŸÉŸÑ 5 ÿ´ŸàÿßŸÜŸä
                setInterval(updateQuickStats, 5000);
                
                // ÿ±ÿ≥ÿßŸÑÿ© ÿ™ÿ±ÿ≠Ÿäÿ® ŸÑŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖŸäŸÜ ÿßŸÑÿ¨ÿØÿØ
                if (isFirstRun) {
                    localStorage.setItem('appInitialized', 'true');
                    setTimeout(() => {
                        showWelcomeMessage();
                    }, 1000);
                }
                
                console.log('‚úÖ ÿ™ŸÖ ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿ®ŸÜÿ¨ÿßÿ≠');
                
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ:', error);
            }
        }

        // Ÿàÿ∏ŸäŸÅÿ© ÿßŸÑÿ≥ÿßÿπÿ© ŸÅŸä ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿπŸÜŸàÿßŸÜ
        function startTitlebarClock() {
            function updateClock() {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                const clockElement = document.getElementById('titlebarClock');
                if (clockElement) {
                    clockElement.textContent = `${hours}:${minutes}:${seconds}`;
                }
            }
            
            updateClock();
            setInterval(updateClock, 1000);
        }

        // Ÿàÿ∏ŸäŸÅÿ© ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
        function refreshApp() {
            const btn = event.target.closest('.titlebar-refresh');
            const icon = btn.querySelector('i');
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿßŸÑÿØŸàÿ±ÿßŸÜ
            icon.style.transform = 'rotate(360deg)';
            btn.disabled = true;
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            setTimeout(async () => {
                try {
                    await updateAllViews();
                    showToast('ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                } catch (error) {
                    showToast('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿ≠ÿØŸäÿ´', 'error');
                }
                
                icon.style.transform = 'rotate(0deg)';
                btn.disabled = false;
            }, 800);
        }

        // ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
        async function addSampleCategories() {
            const sampleCategories = [
                { type: 'category', category_id: '1', category_name: 'ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸäÿßÿ™', category_icon: 'fas fa-laptop', timestamp: new Date().toISOString() },
                { type: 'category', category_id: '2', category_name: 'ÿ•ŸÉÿ≥ÿ≥Ÿàÿßÿ±ÿßÿ™', category_icon: 'fas fa-headphones', timestamp: new Date().toISOString() },
                { type: 'category', category_id: '3', category_name: 'ÿ£ÿ¨Ÿáÿ≤ÿ© ÿ∞ŸÉŸäÿ©', category_icon: 'fas fa-mobile-alt', timestamp: new Date().toISOString() }
            ];

            if (window.dataSdk) {
                for (const category of sampleCategories) {
                    await window.dataSdk.create(category);
                }
            }
        }

        // ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
        async function addSampleProducts() {
            const sampleProducts = [
                { 
                    type: 'product', 
                    product_id: '1', 
                    product_name: 'ŸÑÿßÿ®ÿ™Ÿàÿ® Dell XPS 13', 
                    product_barcode: '1234567890123',
                    product_price_retail: 2500000, 
                    product_price_wholesale: 2300000,
                    product_cost_retail: 2000000, 
                    product_cost_wholesale: 1800000,
                    stock_quantity: 10,
                    min_stock: 5,
                    product_category: '1',
                    supplier: 'ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿ™ŸÇŸÜŸäÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©',
                    timestamp: new Date().toISOString() 
                },
                { 
                    type: 'product', 
                    product_id: '2', 
                    product_name: 'Ÿáÿßÿ™ŸÅ Samsung Galaxy S23', 
                    product_barcode: '2345678901234',
                    product_price_retail: 1200000, 
                    product_price_wholesale: 1100000,
                    product_cost_retail: 900000, 
                    product_cost_wholesale: 800000,
                    stock_quantity: 25,
                    min_stock: 10,
                    product_category: '3',
                    supplier: 'ŸÖŸàÿ≤ÿπ ÿ≥ÿßŸÖÿ≥ŸàŸÜÿ¨',
                    timestamp: new Date().toISOString() 
                },
                { 
                    type: 'product', 
                    product_id: '3', 
                    product_name: 'ÿ≥ŸÖÿßÿπÿßÿ™ Sony WH-1000XM4', 
                    product_barcode: '3456789012345',
                    product_price_retail: 150000, 
                    product_price_wholesale: 140000,
                    product_cost_retail: 100000, 
                    product_cost_wholesale: 90000,
                    stock_quantity: 50,
                    min_stock: 15,
                    product_category: '2',
                    supplier: 'ÿ¥ÿ±ŸÉÿ© ÿßŸÑÿµŸàÿ™Ÿäÿßÿ™',
                    timestamp: new Date().toISOString() 
                }
            ];

            if (window.dataSdk) {
                for (const product of sampleProducts) {
                    await window.dataSdk.create(product);
                }
            }
        }
        
        // ÿ•ÿµŸÑÿßÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÇÿØŸäŸÖÿ© ŸÑŸÑÿØŸäŸàŸÜ
        async function fixOldDebtsData() {
            console.log('Checking and fixing old debts data...');
            
            for (const debt of debtsData) {
                let needsUpdate = false;
                const updates = {};
                
                // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ÿ© ÿ£ŸàŸÑÿßŸã
                const relatedSale = salesData.find(s => s.invoice_id === debt.invoice_id);
                
                // ÿ•ÿµŸÑÿßÿ≠ total_amount
                if (!debt.total_amount) {
                    if (debt.final_total) {
                        updates.total_amount = debt.final_total;
                    } else if (relatedSale && relatedSale.final_total) {
                        updates.total_amount = relatedSale.final_total;
                    }
                    if (updates.total_amount) needsUpdate = true;
                }
                
                // ÿ•ÿµŸÑÿßÿ≠ remaining_amount
                if (debt.remaining_amount === undefined || debt.remaining_amount === null) {
                    const totalAmt = updates.total_amount || debt.total_amount || debt.final_total || 0;
                    updates.remaining_amount = totalAmt;
                    needsUpdate = true;
                }
                
                // ÿ•ÿµŸÑÿßÿ≠ monthly_amount
                if (!debt.monthly_amount) {
                    const totalAmt = updates.total_amount || debt.total_amount || debt.final_total || 0;
                    const months = debt.installment_months || relatedSale?.installment_months || 1;
                    
                    if (relatedSale && relatedSale.monthly_amount) {
                        updates.monthly_amount = relatedSale.monthly_amount;
                    } else if (totalAmt > 0 && months > 0) {
                        updates.monthly_amount = totalAmt / months;
                    }
                    
                    if (updates.monthly_amount) needsUpdate = true;
                }
                
                // ÿ•ÿµŸÑÿßÿ≠ installment_months
                if (!debt.installment_months && relatedSale?.installment_months) {
                    updates.installment_months = relatedSale.installment_months;
                    needsUpdate = true;
                }
                
                // ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿßŸã
                if ((!debt.installments || debt.installments.length === 0) && debt.installment_months > 0) {
                    const monthlyAmt = updates.monthly_amount || debt.monthly_amount || 0;
                    const installments = [];
                    
                    for (let i = 1; i <= debt.installment_months; i++) {
                        installments.push({
                            month: i,
                            amount: monthlyAmt,
                            due_date: new Date(new Date(debt.timestamp).getTime() + (i * 30 * 24 * 60 * 60 * 1000)).toISOString(),
                            status: 'pending',
                            paid_date: null,
                            paid_amount: 0
                        });
                    }
                    
                    updates.installments = installments;
                    needsUpdate = true;
                }
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                if (needsUpdate && window.dataSdk && (debt.id || debt.__backendId)) {
                    const debtId = debt.id || debt.__backendId;
                    console.log('Updating debt:', debtId, updates);
                    await window.dataSdk.update(debtId, updates);
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÉÿßÿ¶ŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä
                    Object.assign(debt, updates);
                }
            }
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            if (window.dataSdk) {
                const allData = await window.dataSdk.query();
                if (allData.isOk) {
                    debtsData = allData.data.filter(item => item.type === 'debt');
                    console.log('Reloaded debts data:', debtsData);
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿ±ÿ∂
                    renderDebtsTable();
                    updateStatistics();
                }
            }
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿ¨ŸÖŸäÿπ ÿßŸÑŸàÿßÿ¨Ÿáÿßÿ™
        function updateAllViews() {
            renderProducts();
            renderCategoryFilters();
            renderProductsTable();
            renderInventoryTable();
            renderInvoicesTable();
            renderDebtsTable();
            updateStatistics();
            updateCartCount();
            populateCategorySelects();
            updateQuickStats();
            updateSettingsStats();
        }

        // ÿπÿ±ÿ∂ ŸÅŸÑÿßÿ™ÿ± ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
        function renderCategoryFilters() {
            const filtersContainer = document.getElementById('categoryFilters');
            if (!filtersContainer) return;
            
            const allBtn = `
                <div class="category-btn ${currentCategory === 'all' ? 'active' : ''}" data-category="all">
                    <i class="fas fa-th-large"></i> ÿßŸÑŸÉŸÑ
                </div>
            `;
            
            const categoryBtns = categories.map(category => `
                <div class="category-btn ${currentCategory === category.category_id ? 'active' : ''}" data-category="${category.category_id}">
                    <i class="${category.category_icon}"></i> ${category.category_name}
                </div>
            `).join('');
            
            filtersContainer.innerHTML = allBtn + categoryBtns;
            
            // ÿ•ÿπÿßÿØÿ© ÿ±ÿ®ÿ∑ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
            filtersContainer.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentCategory = btn.dataset.category;
                    renderProducts();
                });
            });
        }

        // ÿπÿ±ÿ∂ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÅŸä ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            if (!grid) return;
            
            const filteredProducts = currentCategory === 'all' 
                ? products 
                : products.filter(p => p.product_category === currentCategory);
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÖŸÜ ÿÆÿßŸÜÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ
            const posSearchTerm = document.getElementById('posSearchInput')?.value.toLowerCase() || '';
            const searchedProducts = posSearchTerm 
                ? filteredProducts.filter(p => 
                    p.product_name.toLowerCase().includes(posSearchTerm) ||
                    p.product_barcode?.toLowerCase().includes(posSearchTerm) ||
                    p.supplier?.toLowerCase().includes(posSearchTerm)
                  )
                : filteredProducts;
            
            grid.innerHTML = searchedProducts.map(product => {
                const category = categories.find(c => c.category_id === product.product_category);
                const icon = category ? category.category_icon : 'fas fa-box';
                const stockStatus = product.stock_quantity < product.min_stock ? 'ŸÖÿÆÿ≤ŸàŸÜ ŸÇŸÑŸäŸÑ' : `ŸÖÿ™ŸàŸÅÿ± (${product.stock_quantity})`;
                const stockClass = product.stock_quantity < product.min_stock ? 'text-warning' : 'text-success';
                
                return `
                    <div class="product-card animate__animated animate__fadeInUp" onclick="addToCart('${product.product_id}')">
                        <div class="product-icon">
                            <i class="${icon}"></i>
                        </div>
                        <div class="product-name">${product.product_name}</div>
                        <div class="product-price">${formatCurrency(product.product_price_retail)}</div>
                        <div class="product-stock ${stockClass}">${stockStatus}</div>
                    </div>
                `;
            }).join('');
        }

        // ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨ ŸÑŸÑÿ≥ŸÑÿ©
        function addToCart(productId) {
            const product = products.find(p => p.product_id === productId);
            if (!product) return;
            
            if (product.stock_quantity <= 0) {
                showToast('ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ± ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.product_id === productId);
            
            if (existingItem) {
                if (existingItem.quantity >= product.stock_quantity) {
                    showToast('ŸÑÿß ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸÖŸäÿ© ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿßŸÑŸÖÿ™ŸàŸÅÿ±', 'warning');
                    return;
                }
                existingItem.quantity += 1;
            } else {
                cart.push({ 
                    product_id: productId,
                    product_name: product.product_name,
                    product_price: product.product_price_retail,
                    quantity: 1 
                });
            }
            
            console.log('‚ûï Product added to cart:', product.product_name);
            
            renderCart();
            updateCartSummary();
            updateCartCount();
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑŸÑÿ£ÿ≥ŸÅŸÑ ÿ®ÿπÿØ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ©
            console.log('‚è∞ Setting timeout for scroll...');
            setTimeout(() => {
                console.log('‚è∞ Timeout executed, scrolling...');
                scrollCartToBottom();
            }, 500);
            
            // ÿ™ÿ£ÿ´Ÿäÿ± ÿ®ÿµÿ±Ÿä
            showToast('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÑŸÑÿ≥ŸÑÿ©', 'success');
        }



        // ÿπÿ±ÿ∂ ÿßŸÑÿ≥ŸÑÿ©
        function renderCart() {
            const cartContainer = document.getElementById('cartItems');
            if (!cartContainer) return;
            
            if (cart.length === 0) {
                cartContainer.innerHTML = `
                    <div class="cart-empty">
                        <i class="fas fa-shopping-cart"></i>
                        <p>ÿßŸÑÿ≥ŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©</p>
                        <small>ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÑÿ•ÿ∂ÿßŸÅÿ™Ÿáÿß</small>
                    </div>
                `;
                return;
            }
            
            cartContainer.innerHTML = cart.map(item => {
                const product = products.find(p => p.product_id === item.product_id);
                const category = product ? product.category : 'other';
                
                return `
                <div class="cart-item animate__animated animate__fadeInRight" data-category="${category}">
                    <div class="cart-item-content">
                        <div class="item-header">
                            <div class="item-info">
                                <h4 data-quantity="${item.quantity}">${item.product_name}</h4>
                                <div class="item-price">${formatCurrency(item.product_price)}</div>
                            </div>
                            <button class="remove-btn" onclick="removeFromCart('${item.product_id}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="quantity-controls">
                            <div class="qty-controls">
                                <button class="qty-btn" onclick="updateQuantity('${item.product_id}', -1)">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity">${item.quantity}</span>
                                <button class="qty-btn" onclick="updateQuantity('${item.product_id}', 1)">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <div class="item-total">${formatCurrency(item.product_price * item.quantity)}</div>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
            
            console.log('üì¶ Cart rendered with', cart.length, 'items');
            
            // ÿ™ŸÖÿ±Ÿäÿ± ÿ™ŸÑŸÇÿßÿ¶Ÿä ŸÑŸÑÿ£ÿ≥ŸÅŸÑ ŸÅŸàÿ±ÿßŸã
            scrollCartToBottom();
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ Ÿàÿ¨ŸàÿØ ŸÖÿ≠ÿ™ŸàŸâ ŸÑŸÑÿ™ŸÖÿ±Ÿäÿ± Ÿàÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÉŸÑÿßÿ≥
            setTimeout(() => {
                const hasScroll = cartContainer.scrollHeight > cartContainer.clientHeight;
                if (hasScroll) {
                    cartContainer.classList.add('has-scroll');
                } else {
                    cartContainer.classList.remove('has-scroll');
                }
                
                console.log('üîÑ Confirming scroll...');
                // ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ
                scrollCartToBottom();
            }, 100);
            
            // ÿ™ŸÖÿ±Ÿäÿ± ÿ•ÿ∂ÿßŸÅŸä ÿ®ÿπÿØ ÿ™ÿ£ÿÆŸäÿ± ÿ£ÿ∑ŸàŸÑ
            setTimeout(() => {
                console.log('üîÑ Final scroll confirmation...');
                scrollCartToBottom();
            }, 300);
        }

        // ÿØÿßŸÑÿ© ŸÑŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑÿ£ÿ≥ŸÅŸÑ ÿßŸÑÿ≥ŸÑÿ© - ŸÖÿ≠ÿ≥ŸëŸÜÿ©
        function scrollCartToBottom() {
            const cartContainer = document.getElementById('cartItems');
            if (!cartContainer) {
                console.log('‚ùå cartContainer not found');
                return;
            }
            
            console.log('üîÑ Scrolling to bottom...');
            console.log('ScrollHeight:', cartContainer.scrollHeight);
            console.log('ClientHeight:', cartContainer.clientHeight);
            
            // ÿ™ŸÖÿ±Ÿäÿ± ŸÅŸàÿ±Ÿä ŸÑŸÑÿ£ÿ≥ŸÅŸÑ
            setTimeout(() => {
                const maxScroll = cartContainer.scrollHeight - cartContainer.clientHeight;
                console.log('MaxScroll:', maxScroll);
                
                if (maxScroll > 0) {
                    cartContainer.scrollTop = maxScroll;
                    console.log('‚úÖ Scrolled to:', cartContainer.scrollTop);
                }
            }, 50);
        }

        // ÿØÿßŸÑÿ© ŸÑŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑÿ£ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©
        function scrollCartToTop() {
            const cartContainer = document.getElementById('cartItems');
            if (!cartContainer) return;
            
            cartContainer.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØ ÿßŸÑÿ≥ŸÑÿ©
        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            if (cartCount) {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                
                if (totalItems > 0) {
                    cartCount.classList.add('pulse');
                } else {
                    cartCount.classList.remove('pulse');
                }
            }
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÉŸÖŸäÿ©
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.product_id === productId);
            const product = products.find(p => p.product_id === productId);
            
            if (item && product) {
                const newQuantity = item.quantity + change;
                
                if (newQuantity <= 0) {
                    removeFromCart(productId);
                } else if (newQuantity > product.stock_quantity) {
                    showToast('ŸÑÿß ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸÖŸäÿ© ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿßŸÑŸÖÿ™ŸàŸÅÿ±', 'warning');
                } else {
                    item.quantity = newQuantity;
                    renderCart();
                    updateCartSummary();
                    updateCartCount();
                }
            }
        }

        // ÿ≠ÿ∞ŸÅ ŸÖŸÜ ÿßŸÑÿ≥ŸÑÿ©
        function removeFromCart(productId) {
            cart = cart.filter(item => item.product_id !== productId);
            renderCart();
            updateCartSummary();
            updateCartCount();
            showToast('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ÿßŸÑÿ≥ŸÑÿ©', 'info');
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖŸÑÿÆÿµ ÿßŸÑÿ≥ŸÑÿ©
        function updateCartSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.product_price * item.quantity), 0);
            const discountPercent = parseFloat(document.getElementById('discountInput')?.value) || 0;
            const discountAmount = subtotal * (discountPercent / 100);
            const afterDiscount = subtotal - discountAmount;
            const taxRate = parseFloat(getCurrentTaxRate()) / 100;
            const taxAmount = afterDiscount * taxRate;
            const finalTotal = afterDiscount + taxAmount;
            
            updateElement('subtotal', formatCurrency(subtotal));
            updateElement('discountAmount', formatCurrency(discountAmount));
            updateElement('taxAmount', formatCurrency(taxAmount));
            updateElement('finalTotal', formatCurrency(finalTotal));
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ≥ŸÑÿ© ŸÅŸä ÿßŸÑÿ±ÿ£ÿ≥
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            updateElement('cartItemsCount', totalItems);
            updateElement('cartTotalPrice', formatCurrency(finalTotal));
            
            const checkoutBtn = document.getElementById('checkoutBtn');
            if (checkoutBtn) {
                checkoutBtn.disabled = cart.length === 0;
            }
        }
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ≥ÿ±Ÿäÿπÿ©
        function updateQuickStats() {
            // ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            const totalProducts = products.length;
            updateElement('quickTotalProducts', totalProducts);
            
            // ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ (ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© √ó ÿßŸÑŸÉŸÖŸäÿ©)
            const totalValue = products.reduce((sum, p) => {
                const costPrice = p.product_cost_retail || p.purchase_price || 0;
                const quantity = p.stock_quantity || p.product_quantity || 0;
                return sum + (costPrice * quantity);
            }, 0);
            updateElement('quickTotalValue', formatCurrency(totalValue));
            
            // ÿπÿØÿØ ÿßŸÑÿØŸäŸàŸÜ
            const totalDebts = debtsData.length;
            updateElement('quickDebtsCount', totalDebts);
            
            // ÿπÿØÿØ ÿßŸÑŸÖÿØŸäŸàŸÜŸäŸÜ (ÿßŸÑÿ£ÿ¥ÿÆÿßÿµ ÿßŸÑŸÅÿ±ŸäÿØŸäŸÜ)
            const uniqueDebtors = new Set(debtsData.map(d => d.customer_name)).size;
            updateElement('quickDebtorsCount', uniqueDebtors);
            
            // ŸÇŸäŸÖÿ© ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸäÿ©
            const totalDebtsValue = debtsData.reduce((sum, d) => {
                const remaining = d.remaining_amount || 0;
                return sum + remaining;
            }, 0);
            updateElement('quickDebtsValue', formatCurrency(totalDebtsValue));
        }
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿµŸÅÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
        function updateSettingsStats() {
            // ÿπÿØÿØ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            updateElement('settingsProductCount', products.length);
            
            // ÿπÿØÿØ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
            updateElement('settingsCategoryCount', categories.length);
            
            // ÿπÿØÿØ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
            updateElement('settingsInvoiceCount', salesData.length);
            
            // ŸÇŸäŸÖÿ© ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
            const totalSales = salesData.reduce((sum, s) => sum + (s.total_amount || 0), 0);
            updateElement('settingsSalesValue', formatCurrency(totalSales));
            
            // ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÜÿ¥ÿ∑ÿ©
            const activeProducts = products.filter(p => (p.stock_quantity || 0) > 0).length;
            updateElement('activeProductsCount', activeProducts);
            
            // ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÇÿßÿ±ÿ®ÿ™ ÿßŸÑŸÜŸÅÿßÿ∞
            const lowStockProducts = products.filter(p => {
                const qty = p.stock_quantity || 0;
                const min = p.min_stock_quantity || 10;
                return qty > 0 && qty <= min;
            }).length;
            updateElement('lowStockCount', lowStockProducts);
            
            // ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÜŸÅÿ∞ÿ™
            const outOfStockProducts = products.filter(p => (p.stock_quantity || 0) === 0).length;
            updateElement('outOfStockCount', outOfStockProducts);
            
            // ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
            updateElement('totalInvoicesCount', salesData.length);
            
            // ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™
            updateElement('totalSalesAmount', formatCurrency(totalSales));
            
            // ŸÖÿ™Ÿàÿ≥ÿ∑ ŸÇŸäŸÖÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            const averageInvoice = salesData.length > 0 ? totalSales / salesData.length : 0;
            updateElement('averageInvoice', formatCurrency(averageInvoice));
            
            // ÿπÿØÿØ ÿßŸÑŸÖÿØŸäŸÜŸäŸÜ
            const uniqueDebtors = new Set(debtsData.map(d => d.customer_name)).size;
            updateElement('totalDebtorsCount', uniqueDebtors);
            
            // ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿØŸäŸàŸÜ
            const totalDebts = debtsData.reduce((sum, d) => sum + (d.remaining_amount || 0), 0);
            updateElement('totalDebtsAmount', formatCurrency(totalDebts));
            
            // ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±ÿ©
            const overdueDebts = debtsData.filter(d => {
                if (!d.installments || d.installments.length === 0) return false;
                const now = new Date();
                return d.installments.some(inst => {
                    if (inst.paid) return false;
                    const dueDate = new Date(inst.due_date);
                    return dueDate < now;
                });
            }).length;
            updateElement('overdueDebtsCount', overdueDebts);
            
            // ÿ¢ÿÆÿ± ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
            const lastBackup = localStorage.getItem('lastBackupDate');
            if (lastBackup) {
                const date = new Date(lastBackup);
                updateElement('lastBackupDate', date.toLocaleDateString('ar-IQ'));
            }
        }
        
        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≥ÿßÿπÿ© ÿßŸÑÿ±ŸÇŸÖŸäÿ©
        function updateDigitalClock() {
            const now = new Date();
            
            // ÿßŸÑŸàŸÇÿ™
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const timeString = `${hours}:${minutes}:${seconds}`;
            updateElement('digitalClockTime', timeString);
            
            // ÿßŸÑŸäŸàŸÖ
            const days = ['ÿßŸÑÿ£ÿ≠ÿØ', 'ÿßŸÑÿßÿ´ŸÜŸäŸÜ', 'ÿßŸÑÿ´ŸÑÿßÿ´ÿßÿ°', 'ÿßŸÑÿ£ÿ±ÿ®ÿπÿßÿ°', 'ÿßŸÑÿÆŸÖŸäÿ≥', 'ÿßŸÑÿ¨ŸÖÿπÿ©', 'ÿßŸÑÿ≥ÿ®ÿ™'];
            const dayName = days[now.getDay()];
            updateElement('digitalClockDay', dayName);
            
            // ÿßŸÑÿ™ÿßÿ±ŸäÿÆ
            const day = now.getDate();
            const months = ['ŸäŸÜÿßŸäÿ±', 'ŸÅÿ®ÿ±ÿßŸäÿ±', 'ŸÖÿßÿ±ÿ≥', 'ÿ£ÿ®ÿ±ŸäŸÑ', 'ŸÖÿßŸäŸà', 'ŸäŸàŸÜŸäŸà', 
                          'ŸäŸàŸÑŸäŸà', 'ÿ£ÿ∫ÿ≥ÿ∑ÿ≥', 'ÿ≥ÿ®ÿ™ŸÖÿ®ÿ±', 'ÿ£ŸÉÿ™Ÿàÿ®ÿ±', 'ŸÜŸàŸÅŸÖÿ®ÿ±', 'ÿØŸäÿ≥ŸÖÿ®ÿ±'];
            const month = months[now.getMonth()];
            const year = now.getFullYear();
            const dateString = `${day} ${month} ${year}`;
            updateElement('digitalClockDate', dateString);
        }

        // ÿ•ÿπÿØÿßÿØ ŸÖÿ≥ÿ™ŸÖÿπŸä ÿßŸÑÿ£ÿ≠ÿØÿßÿ´
        function setupEventListeners() {
            // ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä
            const sidebarToggle = document.getElementById('sidebarToggle');
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', toggleSidebar);
            }

            // ÿÆÿµŸÖ
            const discountInput = document.getElementById('discountInput');
            if (discountInput) {
                discountInput.addEventListener('input', updateCartSummary);
            }
            
            // ÿßŸÑÿ®ÿ≠ÿ´
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', renderProducts);
            }
            
            // ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ
            document.querySelectorAll('.payment-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.payment-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedPaymentMethod = btn.dataset.method;
                });
            });
            
            // ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ
            const checkoutBtn = document.getElementById('checkoutBtn');
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', () => showModal('paymentModal'));
            }

            // ŸÜŸÖÿßÿ∞ÿ¨
            const addProductForm = document.getElementById('addProductForm');
            if (addProductForm) {
                addProductForm.addEventListener('submit', handleAddProduct);
            }

            const addCategoryForm = document.getElementById('addCategoryForm');
            if (addCategoryForm) {
                addCategoryForm.addEventListener('submit', handleAddCategory);
            }

            const payDebtForm = document.getElementById('payDebtForm');
            if (payDebtForm) {
                payDebtForm.addEventListener('submit', handlePayDebt);
            }

            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
            const installmentInputs = ['installmentMonths', 'additionalAmount', 'downPayment'];
            installmentInputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateInstallment);
                }
            });
            
            // ÿ≤ÿ± ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
            const notificationBtn = document.getElementById('notificationBtn');
            if (notificationBtn) {
                notificationBtn.addEventListener('click', showNotificationsPanel);
            }

            // ŸÅŸÑÿßÿ™ÿ± ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
            const inventoryCategory = document.getElementById('inventoryCategory');
            const stockStatus = document.getElementById('stockStatus');
            if (inventoryCategory) inventoryCategory.addEventListener('change', renderInventoryTable);
            if (stockStatus) stockStatus.addEventListener('change', renderInventoryTable);
            
            // ÿ•ÿÆŸÅÿßÿ° ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ± ÿÆÿßÿ±ÿ¨Ÿáÿß
            document.addEventListener('click', (e) => {
                const searchBox = document.querySelector('.search-box');
                const searchResults = document.getElementById('searchResults');
                if (searchResults && searchBox && !searchBox.contains(e.target)) {
                    searchResults.classList.remove('active');
                }
            });
        }

        // ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿä
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('sidebarToggle');
            
            if (sidebar && toggleBtn) {
                sidebarCollapsed = !sidebarCollapsed;
                
                if (sidebarCollapsed) {
                    sidebar.classList.add('collapsed');
                    toggleBtn.innerHTML = '<i class="fas fa-angle-double-left"></i>';
                } else {
                    sidebar.classList.remove('collapsed');
                    toggleBtn.innerHTML = '<i class="fas fa-angle-double-right"></i>';
                }
            }
        }

        // ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ´ŸäŸÖ
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (currentTheme === 'dark') {
                body.setAttribute('data-theme', 'light');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                currentTheme = 'light';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                currentTheme = 'dark';
            }
            
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ´ŸäŸÖ ŸÅŸä ÿßŸÑÿ™ÿÆÿ≤ŸäŸÜ ÿßŸÑŸÖÿ≠ŸÑŸä
            localStorage.setItem('theme', currentTheme);
        }

        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿ®ÿ¥ŸÉŸÑ ÿ®ÿ±ŸÖÿ¨Ÿä (ÿ®ÿØŸàŸÜ event)
        function navigateTo(pageId) {
            // ÿ•ÿÆŸÅÿßÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿµŸÅÿ≠ÿßÿ™
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑŸÖÿ≠ÿØÿØÿ©
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }
        }

        // ÿπÿ±ÿ∂ ÿµŸÅÿ≠ÿ©
        function showPage(pageId) {
            console.log('üìÑ Showing page:', pageId);
            
            // ÿ•ÿÆŸÅÿßÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ (ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© ŸàÿßŸÑŸÅÿ±ÿπŸäÿ©)
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
                page.style.display = ''; // ÿ•ÿ≤ÿßŸÑÿ© inline style
            });
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑŸÖÿ≠ÿØÿØÿ©
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.style.display = ''; // ÿ•ÿ≤ÿßŸÑÿ© inline style
                targetPage.classList.add('active');
                console.log('‚úÖ Page shown:', pageId);
            } else {
                console.error('‚ùå Page not found:', pageId);
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ŸÜŸÇŸÑ
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // ÿ•ÿ∂ÿßŸÅÿ© active ŸÑŸÑÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ≠ÿßŸÑŸä
            const activeLink = document.querySelector(`.nav-link[onclick*="'${pageId}'"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿµŸÅÿ≠ÿ©
            const pageTitles = {
                'pos': 'ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ',
                'products': 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™',
                'inventory': 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿ≤ŸÜ',
                'invoices': 'ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±',
                'debts': 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ',
                'printer': 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿ©',
                'settings': 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©'
            };
            
            const titleElement = document.getElementById('currentPageTitle');
            if (titleElement) {
                titleElement.textContent = pageTitles[pageId] || 'ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ';
            }
            
            // ÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™ ÿÆÿßÿµÿ© ÿ®ÿßŸÑÿµŸÅÿ≠ÿßÿ™
            if (pageId === 'printer') {
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© Ÿàÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿπÿßŸäŸÜÿ©
                setTimeout(() => {
                    loadPrinterSettings();
                    updatePreview();
                    updatePrinterStats();
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
                    const totalPrints = localStorage.getItem('totalPrints') || '0';
                    const todayPrints = localStorage.getItem('todayPrints') || '0';
                    if (document.getElementById('totalPrints')) {
                        document.getElementById('totalPrints').textContent = totalPrints;
                    }
                    if (document.getElementById('todayPrints')) {
                        document.getElementById('todayPrints').textContent = todayPrints;
                    }
                }, 100);
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿµŸÅÿ≠ÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
            if (pageId === 'settings') {
                setTimeout(() => {
                    updateSettingsStats();
                }, 100);
            }
        }

        // ÿ•ÿ∏Ÿáÿßÿ± ŸÜÿßŸÅÿ∞ÿ© ŸÖŸÜÿ®ÿ´ŸÇÿ©
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('active');
                
                // ÿ•ÿπÿØÿßÿØ ÿÆÿßÿµ ŸÑŸÜÿßŸÅÿ∞ÿ© ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ
                if (modalId === 'addCategoryModal') {
                    renderCategoryIcons();
                }
            }
        }

        // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ŸÖŸÜÿ®ÿ´ŸÇÿ©
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÜŸÖÿßÿ∞ÿ¨
                const form = modal.querySelector('form');
                if (form) {
                    form.reset();
                }
                
                // ÿ•ÿÆŸÅÿßÿ° ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                if (modalId === 'paymentModal') {
                    const installmentForm = document.getElementById('installmentForm');
                    if (installmentForm) {
                        installmentForm.style.display = 'none';
                    }
                }
            }
        }

        // ÿ•ÿ∏Ÿáÿßÿ± ŸÜÿßŸÅÿ∞ÿ© ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨
        function showAddProductModal() {
            showModal('addProductModal');
        }

        // ÿ•ÿ∏Ÿáÿßÿ± ŸÜÿßŸÅÿ∞ÿ© ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅ
        function showAddCategoryModal() {
            showModal('addCategoryModal');
        }

        // ÿπÿ±ÿ∂ ÿ£ŸäŸÇŸàŸÜÿßÿ™ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
        function renderCategoryIcons() {
            const iconGrid = document.getElementById('categoryIconGrid');
            if (!iconGrid) return;
            
            iconGrid.innerHTML = availableIcons.map(icon => `
                <div class="category-icon-btn" data-icon="${icon}" onclick="selectCategoryIcon('${icon}')">
                    <i class="${icon}"></i>
                </div>
            `).join('');
            
            // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
            selectCategoryIcon('fas fa-box');
        }

        // ÿßÿÆÿ™Ÿäÿßÿ± ÿ£ŸäŸÇŸàŸÜÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ
        function selectCategoryIcon(icon) {
            document.querySelectorAll('.category-icon-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            const selectedBtn = document.querySelector(`[data-icon="${icon}"]`);
            if (selectedBtn) {
                selectedBtn.classList.add('selected');
                document.getElementById('selectedCategoryIcon').value = icon;
            }
        }

        // ÿ™ŸàŸÑŸäÿØ ÿ®ÿßÿ±ŸÉŸàÿØ
        function generateBarcode() {
            const barcodeInput = document.getElementById('productBarcode');
            if (barcodeInput) {
                const barcode = Date.now().toString() + Math.floor(Math.random() * 1000).toString().padStart(3, '0');
                barcodeInput.value = barcode;
            }
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨
        async function handleAddProduct(event) {
            event.preventDefault();
            
            if (isLoading) return;
            setLoading(true);
            
            const productData = {
                type: 'product',
                product_id: Date.now().toString(),
                product_name: document.getElementById('productName').value,
                product_barcode: document.getElementById('productBarcode').value || generateBarcodeString(),
                product_cost_retail: parseFloat(document.getElementById('productCostRetail').value),
                product_cost_wholesale: parseFloat(document.getElementById('productCostWholesale').value) || parseFloat(document.getElementById('productCostRetail').value),
                product_price_retail: parseFloat(document.getElementById('productPriceRetail').value),
                product_price_wholesale: parseFloat(document.getElementById('productPriceWholesale').value) || parseFloat(document.getElementById('productPriceRetail').value),
                stock_quantity: parseInt(document.getElementById('productStock').value),
                min_stock: parseInt(document.getElementById('productMinStock').value),
                product_category: document.getElementById('productCategory').value,
                supplier: document.getElementById('productSupplier').value || '',
                timestamp: new Date().toISOString()
            };

            if (window.dataSdk) {
                const result = await window.dataSdk.create(productData);
                if (result.isOk) {
                    closeModal('addProductModal');
                    document.getElementById('addProductForm').reset();
                    showToast('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                } else {
                    showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨', 'error');
                }
            }
            
            setLoading(false);
        }

        // ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨
        function showEditProductModal(productId) {
            const product = products.find(p => p.product_id === productId);
            if (!product) {
                showToast('ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ŸÖŸÑÿ° ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸä ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨
            document.getElementById('editProductId').value = productId;
            document.getElementById('editProductName').value = product.product_name;
            document.getElementById('editProductBarcode').value = product.product_barcode || '';
            document.getElementById('editProductCategory').value = product.product_category || '';
            document.getElementById('editProductSupplier').value = product.supplier || '';
            document.getElementById('editProductCostRetail').value = product.product_cost_retail;
            document.getElementById('editProductCostWholesale').value = product.product_cost_wholesale || '';
            document.getElementById('editProductPriceRetail').value = product.product_price_retail;
            document.getElementById('editProductPriceWholesale').value = product.product_price_wholesale || '';
            document.getElementById('editProductStock').value = product.stock_quantity;
            document.getElementById('editProductMinStock').value = product.min_stock;
            
            // ŸÖŸÑÿ° ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
            populateCategorySelects();
            document.getElementById('editProductCategory').value = product.product_category || '';
            
            showModal('editProductModal');
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨
        async function handleEditProduct(event) {
            event.preventDefault();
            
            if (isLoading) return;
            setLoading(true);
            
            const productId = document.getElementById('editProductId').value;
            const product = products.find(p => p.product_id === productId);
            
            if (!product) {
                showToast('ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                setLoading(false);
                return;
            }
            
            const updatedData = {
                product_name: document.getElementById('editProductName').value,
                product_barcode: document.getElementById('editProductBarcode').value,
                product_category: document.getElementById('editProductCategory').value,
                supplier: document.getElementById('editProductSupplier').value || '',
                product_cost_retail: parseFloat(document.getElementById('editProductCostRetail').value),
                product_cost_wholesale: parseFloat(document.getElementById('editProductCostWholesale').value) || parseFloat(document.getElementById('editProductCostRetail').value),
                product_price_retail: parseFloat(document.getElementById('editProductPriceRetail').value),
                product_price_wholesale: parseFloat(document.getElementById('editProductPriceWholesale').value) || parseFloat(document.getElementById('editProductPriceRetail').value),
                stock_quantity: parseInt(document.getElementById('editProductStock').value),
                min_stock: parseInt(document.getElementById('editProductMinStock').value)
            };
            
            if (window.dataSdk && (product.id || product.__backendId)) {
                const updateId = product.id || product.__backendId;
                const result = await window.dataSdk.update(updateId, updatedData);
                
                if (result.isOk) {
                    closeModal('editProductModal');
                    showToast('ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                } else {
                    showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨', 'error');
                }
            }
            
            setLoading(false);
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿ•ÿ∂ÿßŸÅÿ© ÿ™ÿµŸÜŸäŸÅ
        async function handleAddCategory(event) {
            event.preventDefault();
            
            if (isLoading) return;
            setLoading(true);
            
            const categoryName = document.getElementById('categoryName').value;
            const categoryIcon = document.getElementById('selectedCategoryIcon').value;
            
            // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            if (!categoryName || !categoryName.trim()) {
                showToast('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿßÿ≥ŸÖ ÿßŸÑÿ™ÿµŸÜŸäŸÅ', 'error');
                setLoading(false);
                return;
            }
            
            const categoryData = {
                type: 'category',
                category_id: Date.now().toString(),
                category_name: categoryName.trim(),
                category_icon: categoryIcon || 'fas fa-box',
                timestamp: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.create(categoryData);
                    if (result.isOk) {
                        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ ŸÑŸÑŸÖÿµŸÅŸàŸÅÿ© ÿßŸÑŸÖÿ≠ŸÑŸäÿ©
                        categories.push(categoryData);
                        
                        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                        updateAllViews();
                        
                        // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© Ÿàÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑŸÜŸÖŸàÿ∞ÿ¨
                        closeModal('addCategoryModal');
                        document.getElementById('addCategoryForm').reset();
                        
                        showToast('ÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                    } else {
                        showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ: ' + (result.error || 'ÿÆÿ∑ÿ£ ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ'), 'error');
                    }
                } else {
                    showToast('ÿÆÿ∑ÿ£: ŸÜÿ∏ÿßŸÖ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠', 'error');
                }
            } catch (error) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ:', error);
                showToast('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ™ÿµŸÜŸäŸÅ', 'error');
            }
            
            setLoading(false);
        }

        // ÿ™ŸàŸÑŸäÿØ ÿ®ÿßÿ±ŸÉŸàÿØ ŸÉŸÜÿµ
        function generateBarcodeString() {
            return Date.now().toString() + Math.floor(Math.random() * 1000).toString().padStart(3, '0');
        }

        // ŸÖŸÑÿ° ŸÇŸàÿßÿ¶ŸÖ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
        function populateCategorySelects() {
            const selects = ['productCategory', 'inventoryCategory'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    
                    if (selectId === 'inventoryCategory') {
                        select.innerHTML = '<option value="all">ÿ¨ŸÖŸäÿπ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™</option>';
                    } else {
                        select.innerHTML = '<option value="">ÿßÿÆÿ™ÿ± ÿßŸÑÿ™ÿµŸÜŸäŸÅ</option>';
                    }
                    
                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.category_id;
                        option.textContent = category.category_name;
                        select.appendChild(option);
                    });
                    
                    if (currentValue) {
                        select.value = currentValue;
                    }
                }
            });
        }

        // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
        function renderProductsTable() {
            const tbody = document.getElementById('productsTableBody');
            if (!tbody) return;
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            const searchTerm = document.getElementById('productsSearchInput')?.value.toLowerCase() || '';
            const filteredProducts = searchTerm 
                ? products.filter(product => 
                    (product.product_name && product.product_name.toLowerCase().includes(searchTerm)) ||
                    (product.product_barcode && product.product_barcode.toLowerCase().includes(searchTerm)) ||
                    (product.supplier && product.supplier.toLowerCase().includes(searchTerm))
                  )
                : products;
            
            tbody.innerHTML = filteredProducts.map(product => {
                const category = categories.find(c => c.category_id === product.product_category);
                const categoryName = category ? category.category_name : 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
                const stockClass = product.stock_quantity < product.min_stock ? 'text-warning' : 'text-success';
                
                return `
                    <tr>
                        <td>${product.product_barcode || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</td>
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <i class="${category ? category.category_icon : 'fas fa-box'}"></i>
                                ${product.product_name}
                            </div>
                        </td>
                        <td>${categoryName}</td>
                        <td>${formatCurrency(product.product_price_retail)}</td>
                        <td>${formatCurrency(product.product_cost_retail)}</td>
                        <td>
                            <span class="${stockClass}">
                                ${product.stock_quantity}
                            </span>
                        </td>
                        <td>
                            <button class="action-btn view-btn" onclick="showProductDetails('${product.product_id}')" title="ÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn edit-btn" onclick="showEditProductModal('${product.product_id}')" title="ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteProduct('${product.product_id}')" title="ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        function renderInventoryTable() {
            const tbody = document.getElementById('inventoryTableBody');
            if (!tbody) return;
            
            const categoryFilter = document.getElementById('inventoryCategory')?.value || 'all';
            const statusFilter = document.getElementById('stockStatus')?.value || 'all';
            const searchTerm = document.getElementById('inventorySearchInput')?.value.toLowerCase() || '';
            
            let filteredProducts = products;
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    (product.product_name && product.product_name.toLowerCase().includes(searchTerm)) ||
                    (product.product_barcode && product.product_barcode.toLowerCase().includes(searchTerm)) ||
                    (product.supplier && product.supplier.toLowerCase().includes(searchTerm))
                );
            }
            
            if (categoryFilter !== 'all') {
                filteredProducts = filteredProducts.filter(p => p.product_category === categoryFilter);
            }
            
            if (statusFilter !== 'all') {
                filteredProducts = filteredProducts.filter(p => {
                    if (statusFilter === 'in-stock') return p.stock_quantity > p.min_stock;
                    if (statusFilter === 'low-stock') return p.stock_quantity <= p.min_stock && p.stock_quantity > 0;
                    if (statusFilter === 'out-of-stock') return p.stock_quantity === 0;
                    return true;
                });
            }
            
            tbody.innerHTML = filteredProducts.map(product => {
                const category = categories.find(c => c.category_id === product.product_category);
                const categoryName = category ? category.category_name : 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
                const totalCost = product.stock_quantity * product.product_cost_retail;
                const totalValue = product.stock_quantity * product.product_price_retail;
                const profit = totalValue - totalCost;
                
                let status = 'ŸÖÿ™ŸàŸÅÿ±';
                let statusClass = 'text-success';
                
                if (product.stock_quantity === 0) {
                    status = 'ŸÜŸÅÿØ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ';
                    statusClass = 'text-danger';
                } else if (product.stock_quantity <= product.min_stock) {
                    status = 'ŸÖÿÆÿ≤ŸàŸÜ ŸÇŸÑŸäŸÑ';
                    statusClass = 'text-warning';
                }
                
                return `
                    <tr data-product-id="${product.product_id}">
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <i class="${category ? category.category_icon : 'fas fa-box'}"></i>
                                ${product.product_name}
                            </div>
                        </td>
                        <td>${categoryName}</td>
                        <td>${product.stock_quantity}</td>
                        <td>${formatCurrency(totalCost)}</td>
                        <td>${formatCurrency(totalValue)}</td>
                        <td class="text-success">${formatCurrency(profit)}</td>
                        <td>
                            <span class="${statusClass}">${status}</span>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
        function renderInvoicesTable() {
            const tbody = document.getElementById('invoicesTableBody');
            if (!tbody) return;
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
            const searchTerm = document.getElementById('invoicesSearchInput')?.value.toLowerCase() || '';
            const filteredSales = searchTerm 
                ? salesData.filter(sale => 
                    (sale.invoice_id && sale.invoice_id.toLowerCase().includes(searchTerm)) ||
                    (sale.customer_name && sale.customer_name.toLowerCase().includes(searchTerm)) ||
                    (sale.payment_method && sale.payment_method.toLowerCase().includes(searchTerm))
                  )
                : salesData;
            
            tbody.innerHTML = filteredSales.map(sale => `
                <tr>
                    <td>${sale.invoice_id}</td>
                    <td>${new Date(sale.timestamp).toLocaleDateString('ar-IQ')}</td>
                    <td>${sale.customer_name || 'ÿπŸÖŸäŸÑ ŸÜŸÇÿØŸä'}</td>
                    <td>${formatCurrency(sale.final_total)}</td>
                    <td>
                        <span style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-${sale.payment_method === 'ŸÜŸÇÿØŸä' ? 'money-bill-wave' : 'credit-card'}"></i>
                            ${sale.payment_type || sale.payment_method}
                        </span>
                    </td>
                    <td>
                        <button class="action-btn view-btn" onclick="showInvoiceDetails('${sale.invoice_id}')" title="ÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="action-btn view-btn" onclick="printInvoice('${sale.invoice_id}')" title="ÿ∑ÿ®ÿßÿπÿ©">
                            <i class="fas fa-print"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑÿØŸäŸàŸÜ
        function renderDebtsTable() {
            const tbody = document.getElementById('debtsTableBody');
            if (!tbody) return;
            
            console.log('Rendering debts:', debtsData);
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿØŸäŸàŸÜ
            const searchTerm = document.getElementById('debtsSearchInput')?.value.toLowerCase() || '';
            const filteredDebts = searchTerm 
                ? debtsData.filter(debt => 
                    (debt.customer_name && debt.customer_name.toLowerCase().includes(searchTerm)) ||
                    (debt.customer_phone && debt.customer_phone.toLowerCase().includes(searchTerm)) ||
                    (debt.customer_address && debt.customer_address.toLowerCase().includes(searchTerm))
                  )
                : debtsData;
            
            tbody.innerHTML = filteredDebts.map(debt => {
                console.log('Debt data:', debt);
                
                // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
                const totalAmount = debt.total_amount || debt.final_total || 0;
                
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ ŸÖŸÜ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                let paidAmount = 0;
                let paidMonths = 0;
                
                if (debt.installments && Array.isArray(debt.installments) && debt.installments.length > 0) {
                    debt.installments.forEach(inst => {
                        if (inst.status === 'paid') {
                            paidAmount += parseFloat(inst.paid_amount || inst.amount || 0);
                            paidMonths++;
                        }
                    });
                } else if (debt.paid_amount !== undefined && debt.paid_amount !== null) {
                    paidAmount = parseFloat(debt.paid_amount) || 0;
                }
                
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä
                let remainingAmount = totalAmount - paidAmount;
                if (remainingAmount < 0) remainingAmount = 0;
                
                // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä
                let monthlyAmount = debt.monthly_amount || 0;
                
                // ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸáŸÜÿßŸÉ ŸÇÿ≥ÿ∑ ÿ¥Ÿáÿ±Ÿä ŸÖÿ≠ÿ≥Ÿàÿ®ÿå ÿßÿ≠ÿ≥ÿ®Ÿá ŸÖŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
                if (!monthlyAmount && totalAmount > 0 && debt.installment_months > 0) {
                    monthlyAmount = totalAmount / debt.installment_months;
                }
                
                // ÿ≠ÿ≥ÿßÿ® ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ±
                let totalMonths = debt.installment_months || 0;
                if (debt.installments && Array.isArray(debt.installments)) {
                    totalMonths = debt.installments.length;
                }
                
                let isPaid = paidMonths === totalMonths && totalMonths > 0;
                
                const isOverdue = new Date(debt.due_date) < new Date();
                
                console.log('Debt:', debt.customer_name, '- Total:', totalAmount, 'Paid:', paidAmount, 'Remaining:', remainingAmount, 'Monthly:', monthlyAmount);
                console.log('Paid months:', paidMonths, '/', totalMonths, 'isPaid:', isPaid);
                
                let status = `${paidMonths}/${totalMonths} ÿ¥Ÿáÿ±`;
                let statusClass = 'debt-status active';
                
                if (isPaid) {
                    status = 'ŸÖÿ≥ÿØÿØ';
                    statusClass = 'debt-status paid';
                } else if (isOverdue) {
                    status = `ŸÖÿ™ÿ£ÿÆÿ± (${paidMonths}/${totalMonths})`;
                    statusClass = 'debt-status overdue';
                }
                
                return `
                    <tr data-debt-id="${debt.id || debt.__backendId}">
                        <td>
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-user"></i>
                                ${debt.customer_name}
                            </div>
                        </td>
                        <td>${debt.customer_phone}</td>
                        <td>${formatCurrency(remainingAmount)}</td>
                        <td>${formatCurrency(monthlyAmount)}</td>
                        <td>${new Date(debt.due_date).toLocaleDateString('ar-IQ')}</td>
                        <td>
                            <span class="${statusClass}">${status}</span>
                        </td>
                        <td>
                            <button class="action-btn view-btn" onclick="showDebtDetails('${debt.id || debt.__backendId || debt.debt_id}')" title="ÿπÿ±ÿ∂ ÿßŸÑÿ™ŸÅÿßÿµŸäŸÑ">
                                <i class="fas fa-eye"></i>
                            </button>
                            ${!isPaid ? `
                                <button class="action-btn edit-btn" onclick="showQuickPayModal('${debt.id || debt.__backendId || debt.debt_id}')" title="ÿ™ÿ≥ÿØŸäÿØ ŸÇÿ≥ÿ∑">
                                    <i class="fas fa-money-bill-wave"></i>
                                </button>
                            ` : ''}
                            <button class="action-btn delete-btn" onclick="confirmDeleteDebt('${debt.id || debt.__backendId || debt.debt_id}', '${debt.customer_name}')" title="ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™
        function updateStatistics() {
            // ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            const totalProducts = products.length;
            const totalValue = products.reduce((sum, p) => sum + (p.stock_quantity * p.product_cost_retail), 0);
            const lowStockItems = products.filter(p => p.stock_quantity <= p.min_stock).length;
            const totalCategories = categories.length;
            
            updateElement('totalProducts', totalProducts);
            updateElement('totalValue', formatCurrency(totalValue));
            updateElement('lowStockItems', lowStockItems);
            updateElement('totalCategories', totalCategories);
            
            // ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
            const totalCost = products.reduce((sum, p) => sum + (p.stock_quantity * p.product_cost_retail), 0);
            const totalProfit = products.reduce((sum, p) => sum + (p.stock_quantity * (p.product_price_retail - p.product_cost_retail)), 0);
            const profitMargin = totalCost > 0 ? ((totalProfit / totalCost) * 100).toFixed(1) : 0;
            
            updateElement('totalCost', formatCurrency(totalCost));
            updateElement('totalProfit', formatCurrency(totalProfit));
            updateElement('profitMargin', profitMargin + '%');
            
            // ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
            const totalInvoices = salesData.length;
            const totalSales = salesData.reduce((sum, s) => sum + s.final_total, 0);
            const today = new Date().toDateString();
            const todaySales = salesData
                .filter(s => new Date(s.timestamp).toDateString() === today)
                .reduce((sum, s) => sum + s.final_total, 0);
            
            updateElement('totalInvoices', totalInvoices);
            updateElement('totalSales', formatCurrency(totalSales));
            updateElement('todaySales', formatCurrency(todaySales));
            
            // ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿØŸäŸàŸÜ - ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä (ÿßŸÑŸÖÿ™ŸÜÿßŸÇÿµ)
            console.log('Calculating debt statistics from:', debtsData);
            const totalDebts = debtsData.reduce((sum, d) => {
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ ŸÖŸÜ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                let paidAmount = 0;
                if (d.installments && Array.isArray(d.installments) && d.installments.length > 0) {
                    d.installments.forEach(inst => {
                        if (inst.status === 'paid') {
                            paidAmount += parseFloat(inst.paid_amount || inst.amount || 0);
                        }
                    });
                } else if (d.paid_amount !== undefined && d.paid_amount !== null) {
                    paidAmount = parseFloat(d.paid_amount) || 0;
                }
                
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä
                const totalAmount = d.total_amount || d.final_total || 0;
                const remainingAmount = totalAmount - paidAmount;
                
                console.log('Debt:', d.customer_name, 'Total:', totalAmount, 'Paid:', paidAmount, 'Remaining:', remainingAmount);
                return sum + (remainingAmount > 0 ? remainingAmount : 0);
            }, 0);
            console.log('Total remaining debts calculated:', totalDebts);
            const debtCustomers = [...new Set(debtsData.map(d => d.customer_phone))].length;
            const overdueDebts = debtsData.filter(d => {
                // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÑŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ™ÿ£ÿÆŸäÿ±
                let paidAmount = 0;
                if (d.installments && Array.isArray(d.installments)) {
                    d.installments.forEach(inst => {
                        if (inst.status === 'paid') {
                            paidAmount += parseFloat(inst.paid_amount || inst.amount || 0);
                        }
                    });
                }
                const totalAmount = d.total_amount || d.final_total || 0;
                const remaining = totalAmount - paidAmount;
                return new Date(d.due_date) < new Date() && remaining > 0;
            }).length;
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ≥ÿØÿØÿ© ÿ®ÿßŸÑŸÉÿßŸÖŸÑ (ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ŸÖÿ≥ÿØÿØÿ©)
            const paidDebts = debtsData.filter(d => {
                // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                if (d.installments && Array.isArray(d.installments) && d.installments.length > 0) {
                    // ŸÖÿ≥ÿØÿØ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ = ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ŸÖÿØŸÅŸàÿπÿ©
                    return d.installments.every(inst => inst.status === 'paid');
                } else {
                    // ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™Ÿàÿ¨ÿØ ÿ£ŸÇÿ≥ÿßÿ∑ÿå ŸÜÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä
                    const remaining = d.remaining_amount !== undefined ? d.remaining_amount : (d.total_amount || d.final_total || 0);
                    return remaining <= 0;
                }
            }).length;
            
            console.log('Debts statistics - Total:', totalDebts, 'Customers:', debtCustomers, 'Overdue:', overdueDebts, 'Paid:', paidDebts);
            
            updateElement('totalDebts', formatCurrency(totalDebts));
            updateElement('debtCustomers', debtCustomers);
            updateElement('overdueDebts', overdueDebts);
            updateElement('paidDebts', paidDebts);
        }

        // ÿ•ÿ∏Ÿáÿßÿ± ŸÜŸÖŸàÿ∞ÿ¨ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
        function showInstallmentForm() {
            document.getElementById('installmentForm').style.display = 'block';
            calculateInstallment();
        }

        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
        function calculateInstallment() {
            const subtotal = cart.reduce((sum, item) => sum + (item.product_price * item.quantity), 0);
            const discountPercent = parseFloat(document.getElementById('discountInput')?.value) || 0;
            const discountAmount = subtotal * (discountPercent / 100);
            const afterDiscount = subtotal - discountAmount;
            const taxRate = parseFloat(getCurrentTaxRate()) / 100;
            const taxAmount = afterDiscount * taxRate;
            const originalAmount = afterDiscount + taxAmount;
            
            const months = parseInt(document.getElementById('installmentMonths')?.value) || 12;
            const additionalAmount = parseFloat(document.getElementById('additionalAmount')?.value) || 0;
            const downPayment = parseFloat(document.getElementById('downPayment')?.value) || 0;
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ŸÇÿ®ŸÑ ÿÆÿµŸÖ ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©
            const totalBeforeDown = originalAmount + additionalAmount;
            
            // ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ÿ®ÿπÿØ ÿÆÿµŸÖ ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©
            const remainingAmount = totalBeforeDown - downPayment;
            
            // ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä = ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä / ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ±
            const monthlyPayment = remainingAmount > 0 ? remainingAmount / months : 0;
            
            updateElement('originalAmount', formatCurrency(originalAmount));
            updateElement('addedProfit', formatCurrency(additionalAmount));
            updateElement('totalInstallmentAmount', formatCurrency(totalBeforeDown));
            updateElement('monthlyPayment', formatCurrency(monthlyPayment));
            
            // ÿπÿ±ÿ∂/ÿ•ÿÆŸÅÿßÿ° ÿßŸÑÿØŸÅÿπÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©
            const downPaymentRow = document.getElementById('downPaymentRow');
            if (downPayment > 0) {
                downPaymentRow.style.display = 'flex';
                updateElement('downPaymentDisplay', formatCurrency(downPayment));
            } else {
                downPaymentRow.style.display = 'none';
            }
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑŸÜŸÇÿØŸä
        async function processCashPayment() {
            await processPayment('ŸÜŸÇÿØŸä', 'ŸÜŸÇÿØŸä');
            closeModal('paymentModal');
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿØŸÅÿπ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
        async function processInstallmentPayment() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            
            if (!customerName || !customerPhone) {
                showToast('Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ', 'error');
                return;
            }
            
            const additionalAmount = parseFloat(document.getElementById('additionalAmount').value) || 0;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 0;
            const totalAmount = parseFloat(document.getElementById('totalInstallmentAmount').textContent.replace(/[^\d.]/g, ''));
            const monthlyAmount = parseFloat(document.getElementById('monthlyPayment').textContent.replace(/[^\d.]/g, ''));
            
            await processPayment('ÿ£ŸÇÿ≥ÿßÿ∑', 'ÿ£ŸÇÿ≥ÿßÿ∑', {
                customer_name: customerName,
                customer_phone: customerPhone,
                installment_months: parseInt(document.getElementById('installmentMonths').value),
                additional_amount: additionalAmount,
                down_payment: downPayment,
                monthly_amount: monthlyAmount,
                remaining_amount: totalAmount - downPayment
            });
            
            closeModal('paymentModal');
        }

        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿØŸÅÿπ
        async function processPayment(paymentMethod, paymentType, extraData = {}) {
            if (cart.length === 0 || isLoading) return;
            
            setLoading(true);
            
            const subtotal = cart.reduce((sum, item) => sum + (item.product_price * item.quantity), 0);
            const discountPercent = parseFloat(document.getElementById('discountInput')?.value) || 0;
            const discountAmount = subtotal * (discountPercent / 100);
            const afterDiscount = subtotal - discountAmount;
            const taxRate = parseFloat(getCurrentTaxRate()) / 100;
            const taxAmount = afterDiscount * taxRate;
            const finalTotal = afterDiscount + taxAmount;
            
            const saleData = {
                type: 'sale',
                invoice_id: 'INV-' + Date.now(),
                items: JSON.stringify(cart),
                subtotal: subtotal,
                tax: taxAmount,
                discount: discountAmount,
                final_total: finalTotal,
                payment_method: paymentMethod,
                payment_type: paymentType,
                timestamp: new Date().toISOString(),
                ...extraData
            };
            
            if (window.dataSdk) {
                const result = await window.dataSdk.create(saleData);
                if (result.isOk) {
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
                    await updateProductStock();
                    
                    // ÿ•ŸÜÿ¥ÿßÿ° ÿØŸäŸÜ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑÿØŸÅÿπ ÿ®ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                    if (paymentType === 'ÿ£ŸÇÿ≥ÿßÿ∑') {
                        // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ£ÿµŸÑŸä (ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä ŸÑŸÑŸÅÿßÿ™Ÿàÿ±ÿ©)
                        const totalAmount = finalTotal;
                        // ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä
                        const monthlyAmount = extraData.monthly_amount;
                        // ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ±
                        const installmentMonths = extraData.installment_months;
                        
                        // ÿ•ŸÜÿ¥ÿßÿ° ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
                        const installments = [];
                        for (let i = 1; i <= installmentMonths; i++) {
                            installments.push({
                                month: i,
                                amount: monthlyAmount,
                                due_date: new Date(Date.now() + (i * 30 * 24 * 60 * 60 * 1000)).toISOString(),
                                status: 'pending',
                                paid_date: null,
                                paid_amount: 0
                            });
                        }
                        
                        const debtData = {
                            type: 'debt',
                            invoice_id: saleData.invoice_id,
                            customer_name: extraData.customer_name,
                            customer_phone: extraData.customer_phone,
                            total_amount: totalAmount,
                            final_total: totalAmount,
                            remaining_amount: totalAmount,
                            paid_amount: 0,
                            monthly_amount: monthlyAmount,
                            installment_months: installmentMonths,
                            additional_amount: extraData.additional_amount || 0,
                            installments: installments,
                            due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
                            status: 'ŸÜÿ¥ÿ∑',
                            timestamp: new Date().toISOString()
                        };
                        
                        console.log('Creating debt with data:', debtData);
                        await window.dataSdk.create(debtData);
                    }
                    
                    showSuccessMessage('ÿ™ŸÖ ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ ÿ®ŸÜÿ¨ÿßÿ≠!');
                    clearCart();
                    updateQuickStats();
                    
                    // ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿµÿßŸÖÿ™ÿ© ŸÖŸÅÿπŸÑÿ©
                    const printType = document.querySelector('input[name="printType"]:checked')?.value;
                    if (printType === 'silent') {
                        printInvoice(saleData.invoice_id, true);
                    }
                } else {
                    showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ', 'error');
                }
            }
            
            setLoading(false);
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
        async function updateProductStock() {
            for (const item of cart) {
                const product = products.find(p => p.product_id === item.product_id);
                if (product && window.dataSdk && product.id) {
                    const newQuantity = (product.stock_quantity || product.product_quantity || 0) - item.quantity;
                    await window.dataSdk.update(product.id, { 
                        stock_quantity: newQuantity,
                        product_quantity: newQuantity
                    });
                }
            }
        }

        // ÿ≠ÿ∞ŸÅ ŸÖŸÜÿ™ÿ¨
        async function deleteProduct(productId) {
            const product = products.find(p => p.product_id === productId);
            if (product && window.dataSdk && product.id) {
                const result = await window.dataSdk.delete(product.id);
                if (result.isOk) {
                    showToast('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                    updateQuickStats();
                } else {
                    showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨', 'error');
                }
            } else {
                showToast('ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
            }
        }

        // ÿ•ÿ∏Ÿáÿßÿ± ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨
        function showProductDetails(productId) {
            const product = products.find(p => p.product_id === productId);
            const category = categories.find(c => c.category_id === product.product_category);
            
            if (product) {
                const content = `
                    <div class="detail-row">
                        <span class="detail-label">ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨:</span>
                        <span class="detail-value">${product.product_name}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ:</span>
                        <span class="detail-value">${product.product_barcode || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿßŸÑÿ™ÿµŸÜŸäŸÅ:</span>
                        <span class="detail-value">${category ? category.category_name : 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿßŸÑŸÖŸàÿ±ÿØ:</span>
                        <span class="detail-value">${product.supplier || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿ≥ÿπÿ± ÿßŸÑÿ™ŸÉŸÑŸÅÿ© (ŸÖŸÅÿ±ÿØ):</span>
                        <span class="detail-value">${formatCurrency(product.product_cost_retail)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ (ŸÖŸÅÿ±ÿØ):</span>
                        <span class="detail-value">${formatCurrency(product.product_price_retail)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿßŸÑŸÉŸÖŸäÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©:</span>
                        <span class="detail-value">${product.stock_quantity}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑŸÖÿÆÿ≤ŸàŸÜ:</span>
                        <span class="detail-value">${product.min_stock}</span>
                    </div>
                `;
                
                document.getElementById('productDetailsContent').innerHTML = content;
                showModal('productDetailsModal');
            }
        }

        // Helper functions
        function formatCurrency(amount) {
            // ÿßŸÑÿ™ÿπÿßŸÖŸÑ ŸÖÿπ ÿßŸÑŸÇŸäŸÖ ÿ∫Ÿäÿ± ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©
            const num = parseFloat(amount) || 0;
            return new Intl.NumberFormat('ar-IQ', {
                style: 'decimal',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(num) + ' ÿØŸäŸÜÿßÿ±';
        }

        function updateElement(id, value) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
            }
        }

        function getCurrentTaxRate() {
            return document.getElementById('taxRate')?.textContent || '0';
        }

        function setLoading(loading) {
            isLoading = loading;
        }

        function clearCart() {
            cart = [];
            renderCart();
            updateCartSummary();
            updateCartCount();
        }

        function showSuccessMessage(message) {
            const successMsg = document.getElementById('successMessage');
            if (successMsg) {
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);
            }
        }

        function showToast(message, type = 'info') {
            console.log(`[${type}] ${message}`);
            
            // ÿ•ŸÜÿ¥ÿßÿ° ÿπŸÜÿµÿ± Toast
            const toast = document.createElement('div');
            toast.className = `toast-notification toast-${type}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <span class="toast-icon">${getToastIcon(type)}</span>
                    <span class="toast-message">${message}</span>
                </div>
            `;
            
            // ÿ•ÿ∂ÿßŸÅÿ© Toast ÿ•ŸÑŸâ ÿßŸÑÿµŸÅÿ≠ÿ©
            document.body.appendChild(toast);
            
            // ÿ•ÿ∏Ÿáÿßÿ± Toast
            setTimeout(() => toast.classList.add('show'), 100);
            
            // ÿ•ÿÆŸÅÿßÿ° Ÿàÿ≠ÿ∞ŸÅ Toast
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        function getToastIcon(type) {
            const icons = {
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };
            return icons[type] || icons['info'];
        }
        
        function showWelcomeMessage() {
            const welcomeHTML = `
                <div class="welcome-overlay">
                    <div class="welcome-card">
                        <div class="welcome-header">
                            <h2>üéâ ÿ£ŸáŸÑÿßŸã ÿ®ŸÉ ŸÅŸä ŸÜÿ∏ÿßŸÖ ŸÜŸÇÿßÿ∑ ÿßŸÑÿ®Ÿäÿπ</h2>
                        </div>
                        <div class="welcome-body">
                            <p>‚ú® ŸÜÿ∏ÿßŸÖ ŸÖÿ™ŸÉÿßŸÖŸÑ ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</p>
                            <div class="welcome-features">
                                <div class="welcome-feature">
                                    <span>üì¶</span>
                                    <p>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸàÿßŸÑŸÖÿÆÿ≤ŸàŸÜ</p>
                                </div>
                                <div class="welcome-feature">
                                    <span>üí∞</span>
                                    <p>ŸÖÿ™ÿßÿ®ÿπÿ© ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</p>
                                </div>
                                <div class="welcome-feature">
                                    <span>üë•</span>
                                    <p>ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ≤ÿ®ÿßÿ¶ŸÜ ŸàÿßŸÑÿØŸäŸàŸÜ</p>
                                </div>
                                <div class="welcome-feature">
                                    <span>üìä</span>
                                    <p>ÿ™ŸÇÿßÿ±Ÿäÿ± ŸÖŸÅÿµŸÑÿ© Ÿàÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™</p>
                                </div>
                                <div class="welcome-feature">
                                    <span>üé®</span>
                                    <p>12 ÿ´ŸäŸÖ ŸÖÿπ ÿ™ÿÆÿµŸäÿµ ÿßŸÑÿ£ŸÑŸàÿßŸÜ</p>
                                </div>
                                <div class="welcome-feature">
                                    <span>üåê</span>
                                    <p>ÿØÿπŸÖ ÿ´ŸÑÿßÿ´ ŸÑÿ∫ÿßÿ™</p>
                                </div>
                            </div>
                            <p class="welcome-note">üí° ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÑŸÑÿ®ÿØÿ°</p>
                            <p class="welcome-hint">ŸäŸÖŸÉŸÜŸÉ ÿ≠ÿ∞ŸÅŸáÿß ŸÖŸÜ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ‚Üí ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ</p>
                        </div>
                        <div class="welcome-footer">
                            <button class="welcome-btn" onclick="closeWelcome()">ÿßÿ®ÿØÿ£ ÿßŸÑÿ¢ŸÜ</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', welcomeHTML);
        }
        
        function closeWelcome() {
            const overlay = document.querySelector('.welcome-overlay');
            if (overlay) {
                overlay.classList.add('fade-out');
                setTimeout(() => overlay.remove(), 300);
            }
        }
        
        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑÿ¥ÿßŸÖŸÑ
        function handleGlobalSearch(event) {
            const searchTerm = event.target.value.trim().toLowerCase();
            const searchResults = document.getElementById('searchResults');
            
            if (searchTerm.length === 0) {
                searchResults.classList.remove('active');
                return;
            }
            
            if (searchTerm.length < 2) {
                return;
            }
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            const results = {
                products: [],
                sales: [],
                debts: [],
                categories: []
            };
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            products.forEach(product => {
                if ((product.name && product.name.toLowerCase().includes(searchTerm)) ||
                    (product.barcode && product.barcode.toLowerCase().includes(searchTerm)) ||
                    (product.supplier && product.supplier.toLowerCase().includes(searchTerm))) {
                    results.products.push(product);
                }
            });
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
            salesData.forEach(sale => {
                if ((sale.invoice_id && sale.invoice_id.toLowerCase().includes(searchTerm)) ||
                    (sale.customer_name && sale.customer_name.toLowerCase().includes(searchTerm)) ||
                    (sale.payment_method && sale.payment_method.toLowerCase().includes(searchTerm))) {
                    results.sales.push(sale);
                }
            });
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿØŸäŸàŸÜ
            debtsData.forEach(debt => {
                if ((debt.customer_name && debt.customer_name.toLowerCase().includes(searchTerm)) ||
                    (debt.customer_phone && debt.customer_phone.toLowerCase().includes(searchTerm)) ||
                    (debt.customer_address && debt.customer_address.toLowerCase().includes(searchTerm))) {
                    results.debts.push(debt);
                }
            });
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
            categories.forEach(category => {
                if (category.name && category.name.toLowerCase().includes(searchTerm)) {
                    results.categories.push(category);
                }
            });
            
            // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
            renderSearchResults(results, searchTerm);
        }
        
        // ÿπÿ±ÿ∂ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function renderSearchResults(results, searchTerm) {
            const searchResults = document.getElementById('searchResults');
            let html = '';
            
            const totalResults = results.products.length + results.sales.length + 
                               results.debts.length + results.categories.length;
            
            if (totalResults === 0) {
                html = `
                    <div class="search-empty">
                        <i class="fas fa-search-minus"></i>
                        <p>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨ ŸÑŸÑÿ®ÿ≠ÿ´ ÿπŸÜ "<strong>${searchTerm}</strong>"</p>
                        <small style="opacity: 0.7; margin-top: 0.5rem; display: block;">ÿ¨ÿ±ÿ® ŸÉŸÑŸÖÿßÿ™ ŸÖÿÆÿ™ŸÑŸÅÿ© ÿ£Ÿà ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ•ŸÖŸÑÿßÿ°</small>
                    </div>
                `;
            } else {
                // ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
                html += `
                    <div class="search-header">
                        <span><i class="fas fa-search"></i> ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´</span>
                        <span class="search-total">${totalResults} ŸÜÿ™Ÿäÿ¨ÿ©</span>
                    </div>
                `;
                
                // ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
                if (results.products.length > 0) {
                    html += '<div class="search-category">';
                    html += `
                        <div class="search-category-title">
                            <i class="fas fa-box"></i>
                            <span>ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</span>
                            <span class="count">${results.products.length}</span>
                        </div>
                    `;
                    results.products.slice(0, 5).forEach(product => {
                        const stockStatus = product.stock_quantity <= product.min_stock ? 
                            '<span class="search-result-badge" style="background: #fee; color: #c33;">ŸÖÿÆÿ≤ŸàŸÜ ŸÖŸÜÿÆŸÅÿ∂</span>' : '';
                        html += `
                            <div class="search-result-item" onclick="goToProductDetails('${product.product_id}')">
                                <div class="search-result-icon">
                                    <i class="fas fa-box"></i>
                                </div>
                                <div class="search-result-info">
                                    <div class="search-result-title">${product.name}</div>
                                    <div class="search-result-subtitle">
                                        <span><i class="fas fa-barcode"></i> ${product.barcode || 'ÿ®ÿØŸàŸÜ ÿ®ÿßÿ±ŸÉŸàÿØ'}</span>
                                        <span><i class="fas fa-tag"></i> ${formatCurrency(product.selling_price)}</span>
                                        <span><i class="fas fa-boxes"></i> ${product.stock_quantity} ŸÇÿ∑ÿπÿ©</span>
                                        ${stockStatus}
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    if (results.products.length > 5) {
                        html += `<div style="padding: 0.75rem 1.25rem; text-align: center; color: var(--theme-text-secondary); font-size: 0.85rem;">Ÿà ${results.products.length - 5} ŸÜÿ™ÿßÿ¶ÿ¨ ÿ£ÿÆÿ±Ÿâ...</div>`;
                    }
                    html += '</div>';
                }
                
                // ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
                if (results.sales.length > 0) {
                    html += '<div class="search-category">';
                    html += `
                        <div class="search-category-title">
                            <i class="fas fa-receipt"></i>
                            <span>ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±</span>
                            <span class="count">${results.sales.length}</span>
                        </div>
                    `;
                    results.sales.slice(0, 5).forEach(sale => {
                        const paymentBadge = sale.payment_method === 'ŸÜŸÇÿØŸä' ? 
                            '<span class="search-result-badge" style="background: #e6ffe6; color: #2d7a2d;">ŸÜŸÇÿØŸä</span>' : 
                            '<span class="search-result-badge" style="background: #fff4e6; color: #b36200;">ŸÇÿ≥ÿ∑</span>';
                        html += `
                            <div class="search-result-item" onclick="goToInvoiceDetails('${sale.sale_id}')">
                                <div class="search-result-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                                    <i class="fas fa-receipt"></i>
                                </div>
                                <div class="search-result-info">
                                    <div class="search-result-title">ŸÅÿßÿ™Ÿàÿ±ÿ© #${sale.invoice_id || sale.sale_id.substring(0, 8)}</div>
                                    <div class="search-result-subtitle">
                                        <span><i class="fas fa-user"></i> ${sale.customer_name || 'ÿ≤ÿ®ŸàŸÜ ÿπÿßŸÖ'}</span>
                                        <span><i class="fas fa-money-bill"></i> ${formatCurrency(sale.total_amount)}</span>
                                        <span><i class="fas fa-calendar"></i> ${new Date(sale.sale_date).toLocaleDateString('ar-EG')}</span>
                                        ${paymentBadge}
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    if (results.sales.length > 5) {
                        html += `<div style="padding: 0.75rem 1.25rem; text-align: center; color: var(--theme-text-secondary); font-size: 0.85rem;">Ÿà ${results.sales.length - 5} ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ£ÿÆÿ±Ÿâ...</div>`;
                    }
                    html += '</div>';
                }
                
                // ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿØŸäŸàŸÜ
                if (results.debts.length > 0) {
                    html += '<div class="search-category">';
                    html += `
                        <div class="search-category-title">
                            <i class="fas fa-money-bill-wave"></i>
                            <span>ÿßŸÑÿØŸäŸàŸÜ</span>
                            <span class="count">${results.debts.length}</span>
                        </div>
                    `;
                    results.debts.slice(0, 5).forEach(debt => {
                        const isOverdue = debt.due_date && new Date(debt.due_date) < new Date();
                        const statusBadge = debt.remaining_amount <= 0 ? 
                            '<span class="search-result-badge" style="background: #e6ffe6; color: #2d7a2d;">ŸÖÿ≥ÿØÿØ</span>' :
                            isOverdue ? 
                            '<span class="search-result-badge" style="background: #ffe6e6; color: #c33;">ŸÖÿ™ÿ£ÿÆÿ±</span>' :
                            '<span class="search-result-badge" style="background: #fff4e6; color: #b36200;">ŸÜÿ¥ÿ∑</span>';
                        html += `
                            <div class="search-result-item" onclick="goToDebtDetails('${debt.debt_id}')">
                                <div class="search-result-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="search-result-info">
                                    <div class="search-result-title">${debt.customer_name}</div>
                                    <div class="search-result-subtitle">
                                        <span><i class="fas fa-phone"></i> ${debt.customer_phone || 'ÿ®ÿØŸàŸÜ Ÿáÿßÿ™ŸÅ'}</span>
                                        <span><i class="fas fa-dollar-sign"></i> ${formatCurrency(debt.remaining_amount)} ŸÖÿ™ÿ®ŸÇŸä</span>
                                        ${statusBadge}
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    if (results.debts.length > 5) {
                        html += `<div style="padding: 0.75rem 1.25rem; text-align: center; color: var(--theme-text-secondary); font-size: 0.85rem;">Ÿà ${results.debts.length - 5} ÿØŸäŸÜ ÿ¢ÿÆÿ±...</div>`;
                    }
                    html += '</div>';
                }
                
                // ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™
                if (results.categories.length > 0) {
                    html += '<div class="search-category">';
                    html += `
                        <div class="search-category-title">
                            <i class="fas fa-tags"></i>
                            <span>ÿßŸÑÿ™ÿµŸÜŸäŸÅÿßÿ™</span>
                            <span class="count">${results.categories.length}</span>
                        </div>
                    `;
                    results.categories.slice(0, 3).forEach(category => {
                        const categoryProducts = products.filter(p => p.category_id === category.category_id);
                        html += `
                            <div class="search-result-item" onclick="goToCategory('${category.category_id}')">
                                <div class="search-result-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                                    <i class="${category.icon || 'fas fa-tag'}"></i>
                                </div>
                                <div class="search-result-info">
                                    <div class="search-result-title">${category.name}</div>
                                    <div class="search-result-subtitle">
                                        <span><i class="fas fa-box"></i> ${categoryProducts.length} ŸÖŸÜÿ™ÿ¨</span>
                                        <span>${category.description || 'ÿ™ÿµŸÜŸäŸÅ ŸÖŸÜÿ™ÿ¨ÿßÿ™'}</span>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    if (results.categories.length > 3) {
                        html += `<div style="padding: 0.75rem 1.25rem; text-align: center; color: var(--theme-text-secondary); font-size: 0.85rem;">Ÿà ${results.categories.length - 3} ÿ™ÿµŸÜŸäŸÅÿßÿ™ ÿ£ÿÆÿ±Ÿâ...</div>`;
                    }
                    html += '</div>';
                }
            }
            
            searchResults.innerHTML = html;
            searchResults.classList.add('active');
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÖŸÜ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function goToProductDetails(productId) {
            hideSearchResults();
            navigateTo('products');
            setTimeout(() => showProductDetails(productId), 100);
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÖŸÜ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function goToInvoiceDetails(saleId) {
            hideSearchResults();
            navigateTo('invoices');
            setTimeout(() => showInvoiceDetails(saleId), 100);
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ ŸÖŸÜ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function goToDebtDetails(debtId) {
            hideSearchResults();
            navigateTo('debts');
            setTimeout(() => showDebtDetails(debtId), 100);
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑÿ™ÿµŸÜŸäŸÅ ŸÖŸÜ ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function goToCategory(categoryId) {
            hideSearchResults();
            navigateTo('pos');
            currentCategory = categoryId;
            renderProducts();
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÅŸÑÿ™ÿ± ÿßŸÑŸÜÿ¥ÿ∑
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.category === categoryId) {
                    btn.classList.add('active');
                }
            });
        }
        
        // ÿ•ÿÆŸÅÿßÿ° ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑÿ®ÿ≠ÿ´
        function hideSearchResults() {
            const searchResults = document.getElementById('searchResults');
            searchResults.classList.remove('active');
            document.getElementById('globalSearchInput').value = '';
        }

        function showNotificationsPanel() {
            if (notifications.length === 0) {
                showToast('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿ¨ÿØŸäÿØÿ©', 'info');
                return;
            }
            
            let notificationsHTML = notifications.map((notif, index) => {
                return `
                    <div class="notification-card" style="background: var(--theme-bg-secondary); padding: 1rem; border-radius: 12px; margin-bottom: 1rem; border-right: 4px solid var(--${notif.type}-color); cursor: pointer; transition: all 0.3s ease;" onclick="showNotificationDetails(${index})" onmouseenter="this.style.transform='translateX(-5px)'" onmouseleave="this.style.transform='translateX(0)'">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="font-size: 2rem; color: var(--${notif.type}-color);">
                                <i class="fas fa-${notif.icon}"></i>
                            </div>
                            <div style="flex: 1;">
                                <h4 style="margin-bottom: 0.5rem; color: var(--theme-text-primary); font-size: 1.1rem;">${notif.title}</h4>
                                <p style="color: var(--theme-text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">${notif.message}</p>
                                <span style="background: var(--${notif.type}-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.8rem; display: inline-block;">
                                    ${notif.count} ${notif.category === 'debts' ? 'ÿØŸäŸÜ' : 'ŸÖŸÜÿ™ÿ¨'}
                                </span>
                            </div>
                            <div>
                                <i class="fas fa-chevron-left" style="color: var(--theme-text-secondary);"></i>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'notificationsModal';
            modal.innerHTML = `
                <div class="modal-content animate__animated animate__fadeInDown" style="max-width: 700px;">
                    <div class="modal-header">
                        <h3 class="modal-title"><i class="fas fa-bell"></i> ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ (${notifications.length})</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div style="max-height: 70vh; overflow-y: auto; padding: 1rem;">
                        ${notificationsHTML}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // ÿπÿ±ÿ∂ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±
        function showNotificationDetails(notificationIndex) {
            const notif = notifications[notificationIndex];
            if (!notif || !notif.items || notif.items.length === 0) return;
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
            const mainModal = document.getElementById('notificationsModal');
            if (mainModal) mainModal.remove();
            
            let itemsHTML = '';
            
            if (notif.category === 'debts') {
                // ÿπÿ±ÿ∂ ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±ÿ©
                itemsHTML = notif.items.map(debt => {
                    const totalAmount = debt.total_amount || debt.final_total || 0;
                    let paidAmount = 0;
                    let paidMonths = 0;
                    
                    if (debt.installments && Array.isArray(debt.installments)) {
                        debt.installments.forEach(inst => {
                            if (inst.status === 'paid') {
                                paidAmount += parseFloat(inst.paid_amount || inst.amount || 0);
                                paidMonths++;
                            }
                        });
                    }
                    
                    const remainingAmount = totalAmount - paidAmount;
                    const totalMonths = debt.installment_months || 0;
                    const daysOverdue = Math.floor((new Date() - new Date(debt.due_date)) / (1000 * 60 * 60 * 24));
                    
                    return `
                        <div class="notification-detail-item" style="background: var(--theme-bg-secondary); padding: 1.25rem; border-radius: 12px; margin-bottom: 1rem; border-right: 4px solid var(--danger-color); cursor: pointer; transition: all 0.3s ease;" onclick="goToDebt('${debt.id || debt.__backendId}')" onmouseenter="this.style.transform='scale(1.02)'" onmouseleave="this.style.transform='scale(1)'">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div style="flex: 1;">
                                    <h4 style="color: var(--theme-text-primary); font-size: 1.1rem; margin-bottom: 0.5rem;">
                                        <i class="fas fa-user-circle" style="color: var(--danger-color);"></i>
                                        ${debt.customer_name}
                                    </h4>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.9rem; margin-bottom: 0.25rem;">
                                        <i class="fas fa-phone"></i> ${debt.customer_phone}
                                    </p>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.85rem;">
                                        <i class="fas fa-map-marker-alt"></i> ${debt.customer_address || 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ'}
                                    </p>
                                </div>
                                <div style="text-align: left;">
                                    <span style="background: var(--danger-color); color: white; padding: 0.35rem 0.85rem; border-radius: 20px; font-size: 0.85rem; display: inline-block; margin-bottom: 0.5rem;">
                                        <i class="fas fa-exclamation-triangle"></i> ŸÖÿ™ÿ£ÿÆÿ± ${daysOverdue} ŸäŸàŸÖ
                                    </span>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; background: var(--theme-bg-primary); padding: 1rem; border-radius: 8px;">
                                <div>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</p>
                                    <p style="color: var(--theme-text-primary); font-size: 1rem; font-weight: bold;">${formatCurrency(totalAmount)}</p>
                                </div>
                                <div>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä</p>
                                    <p style="color: var(--danger-color); font-size: 1rem; font-weight: bold;">${formatCurrency(remainingAmount)}</p>
                                </div>
                                <div>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä</p>
                                    <p style="color: var(--theme-text-primary); font-size: 1rem; font-weight: bold;">${formatCurrency(debt.monthly_amount || 0)}</p>
                                </div>
                                <div>
                                    <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿßŸÑŸÖÿØŸÅŸàÿπÿ©</p>
                                    <p style="color: var(--success-color); font-size: 1rem; font-weight: bold;">${paidMonths}/${totalMonths}</p>
                                </div>
                            </div>
                            <div style="text-align: center; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--theme-border);">
                                <span style="color: var(--primary-color); font-size: 0.9rem;">
                                    <i class="fas fa-hand-pointer"></i> ÿßŸÜŸÇÿ± ŸÑŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ
                                </span>
                            </div>
                        </div>
                    `;
                }).join('');
                
            } else if (notif.category === 'outOfStock' || notif.category === 'lowStock') {
                // ÿπÿ±ÿ∂ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿ£Ÿà ÿßŸÑŸÇÿ±Ÿäÿ®ÿ© ŸÖŸÜ ÿßŸÑŸÜŸÅÿßÿ∞
                itemsHTML = notif.items.map(product => {
                    const category = categories.find(c => c.category_id === product.product_category);
                    const categoryName = category ? category.category_name : 'ÿ∫Ÿäÿ± ŸÖÿ≠ÿØÿØ';
                    const categoryIcon = category ? category.category_icon : 'fas fa-box';
                    const isOutOfStock = product.stock_quantity === 0;
                    
                    return `
                        <div class="notification-detail-item" style="background: var(--theme-bg-secondary); padding: 1.25rem; border-radius: 12px; margin-bottom: 1rem; border-right: 4px solid var(--${isOutOfStock ? 'danger' : 'warning'}-color); cursor: pointer; transition: all 0.3s ease;" onclick="goToProduct('${product.product_id}')" onmouseenter="this.style.transform='scale(1.02)'" onmouseleave="this.style.transform='scale(1)'">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div style="font-size: 3rem; color: var(--${isOutOfStock ? 'danger' : 'warning'}-color); min-width: 60px; text-align: center;">
                                    <i class="${categoryIcon}"></i>
                                </div>
                                <div style="flex: 1;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem;">
                                        <div>
                                            <h4 style="color: var(--theme-text-primary); font-size: 1.1rem; margin-bottom: 0.5rem;">
                                                ${product.product_name}
                                            </h4>
                                            <p style="color: var(--theme-text-secondary); font-size: 0.9rem;">
                                                <i class="fas fa-tag"></i> ${categoryName}
                                            </p>
                                        </div>
                                        <span style="background: var(--${isOutOfStock ? 'danger' : 'warning'}-color); color: white; padding: 0.35rem 0.85rem; border-radius: 20px; font-size: 0.85rem;">
                                            <i class="fas fa-${isOutOfStock ? 'times-circle' : 'exclamation-triangle'}"></i>
                                            ${isOutOfStock ? 'ŸÜŸÅÿ∞ ŸÖŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ' : 'ŸÇÿßÿ±ÿ® ÿπŸÑŸâ ÿßŸÑŸÜŸÅÿßÿ∞'}
                                        </span>
                                    </div>
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; background: var(--theme-bg-primary); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                                        <div>
                                            <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑŸÉŸÖŸäÿ© ÿßŸÑŸÖÿ™ŸàŸÅÿ±ÿ©</p>
                                            <p style="color: var(--${isOutOfStock ? 'danger' : 'warning'}-color); font-size: 1.1rem; font-weight: bold;">
                                                ${product.stock_quantity}
                                            </p>
                                        </div>
                                        <div>
                                            <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ</p>
                                            <p style="color: var(--theme-text-primary); font-size: 1.1rem; font-weight: bold;">
                                                ${product.min_stock}
                                            </p>
                                        </div>
                                        <div>
                                            <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.25rem;">ÿßŸÑÿ≥ÿπÿ±</p>
                                            <p style="color: var(--theme-text-primary); font-size: 1.1rem; font-weight: bold;">
                                                ${formatCurrency(product.product_price_retail)}
                                            </p>
                                        </div>
                                    </div>
                                    ${product.product_barcode ? `
                                        <p style="color: var(--theme-text-secondary); font-size: 0.85rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-barcode"></i> ${product.product_barcode}
                                        </p>
                                    ` : ''}
                                    ${product.supplier ? `
                                        <p style="color: var(--theme-text-secondary); font-size: 0.85rem;">
                                            <i class="fas fa-truck"></i> ${product.supplier}
                                        </p>
                                    ` : ''}
                                    <div style="text-align: center; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--theme-border);">
                                        <span style="color: var(--primary-color); font-size: 0.9rem;">
                                            <i class="fas fa-hand-pointer"></i> ÿßŸÜŸÇÿ± ŸÑŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content animate__animated animate__zoomIn" style="max-width: 900px;">
                    <div class="modal-header">
                        <h3 class="modal-title">
                            <i class="fas fa-${notif.icon}" style="color: var(--${notif.type}-color);"></i>
                            ${notif.title} (${notif.count})
                        </h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div style="max-height: 70vh; overflow-y: auto; padding: 1rem;">
                        ${itemsHTML}
                    </div>
                    <div style="padding: 1rem; border-top: 1px solid var(--theme-border); text-align: center;">
                        <button onclick="this.closest('.modal').remove()" style="padding: 0.75rem 2rem; background: var(--theme-bg-secondary); color: var(--theme-text-primary); border: none; border-radius: 8px; cursor: pointer; font-size: 1rem;">
                            <i class="fas fa-times"></i> ÿ•ÿ∫ŸÑÿßŸÇ
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑÿØŸäŸÜ
        function goToDebt(debtId) {
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => modal.remove());
            
            // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿßŸÑÿØŸäŸàŸÜ
            showPage('debts');
            
            // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑÿØŸäŸÜ ÿßŸÑŸÖÿ≠ÿØÿØ
            setTimeout(() => {
                const debtRow = document.querySelector(`tr[data-debt-id="${debtId}"]`);
                if (debtRow) {
                    debtRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    debtRow.style.background = 'var(--primary-color)';
                    debtRow.style.transition = 'all 0.5s ease';
                    setTimeout(() => {
                        debtRow.style.background = '';
                    }, 2000);
                }
            }, 300);
        }
        
        // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖŸÜÿ™ÿ¨ ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        function goToProduct(productId) {
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => modal.remove());
            
            // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
            showPage('inventory');
            
            // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ÿ•ŸÑŸâ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿßŸÑŸÖÿ≠ÿØÿØ
            setTimeout(() => {
                const productRow = document.querySelector(`tr[data-product-id="${productId}"]`);
                if (productRow) {
                    productRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    productRow.style.background = 'var(--warning-color)';
                    productRow.style.transition = 'all 0.5s ease';
                    setTimeout(() => {
                        productRow.style.background = '';
                    }, 2000);
                }
            }, 300);
        }
        
        function updateNotifications() {
            notifications = [];
            
            // ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑÿØŸäŸàŸÜ ÿßŸÑŸÖÿ™ÿ£ÿÆÿ±ÿ©
            const overdueDebts = debtsData.filter(d => {
                let paidAmount = 0;
                if (d.installments && Array.isArray(d.installments)) {
                    d.installments.forEach(inst => {
                        if (inst.status === 'paid') {
                            paidAmount += parseFloat(inst.paid_amount || inst.amount || 0);
                        }
                    });
                }
                const totalAmount = d.total_amount || d.final_total || 0;
                const remaining = totalAmount - paidAmount;
                return new Date(d.due_date) < new Date() && remaining > 0;
            });
            
            if (overdueDebts.length > 0) {
                notifications.push({
                    type: 'danger',
                    icon: 'exclamation-triangle',
                    title: 'ÿØŸäŸàŸÜ ŸÖÿ™ÿ£ÿÆÿ±ÿ©',
                    message: `ŸÑÿØŸäŸÉ ${overdueDebts.length} ÿØŸäŸÜ ŸÖÿ™ÿ£ÿÆÿ± ÿπŸÜ ÿßŸÑŸÖŸàÿπÿØ ÿßŸÑŸÖÿ≠ÿØÿØ`,
                    count: overdueDebts.length,
                    items: overdueDebts,
                    category: 'debts'
                });
            }
            
            // ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿßŸÑŸÖŸÜÿÆŸÅÿ∂
            const lowStockProducts = products.filter(p => p.stock_quantity > 0 && p.stock_quantity <= p.min_stock);
            
            if (lowStockProducts.length > 0) {
                notifications.push({
                    type: 'warning',
                    icon: 'box-open',
                    title: 'ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÇÿßÿ±ÿ®ÿ™ ÿπŸÑŸâ ÿßŸÑŸÜŸÅÿßÿ∞',
                    message: `ŸÑÿØŸäŸÉ ${lowStockProducts.length} ŸÖŸÜÿ™ÿ¨ ŸÇÿßÿ±ÿ® ÿπŸÑŸâ ÿßŸÑŸÜŸÅÿßÿ∞ ŸÖŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ`,
                    count: lowStockProducts.length,
                    items: lowStockProducts,
                    category: 'lowStock'
                });
            }
            
            // ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
            const outOfStockProducts = products.filter(p => p.stock_quantity === 0);
            
            if (outOfStockProducts.length > 0) {
                notifications.push({
                    type: 'danger',
                    icon: 'times-circle',
                    title: 'ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÜŸÅÿ∞ÿ™ ŸÖŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ',
                    message: `ŸÑÿØŸäŸÉ ${outOfStockProducts.length} ŸÖŸÜÿ™ÿ¨ ŸÜŸÅÿ∞ ŸÖŸÜ ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ`,
                    count: outOfStockProducts.length,
                    items: outOfStockProducts,
                    category: 'outOfStock'
                });
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ¥ÿßÿ±ÿ© ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
            const notificationBadge = document.querySelector('.notification-badge');
            if (notificationBadge) {
                if (notifications.length > 0) {
                    notificationBadge.textContent = notifications.length;
                    notificationBadge.style.display = 'flex';
                } else {
                    notificationBadge.style.display = 'none';
                }
            }
        }

        function updateInvoicePreview(config) {
            const elements = {
                'previewStoreName': config.store_name,
                'previewStoreAddress': config.store_address,
                'previewStorePhone': config.store_phone
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                updateElement(id, value);
            });
        }

        // ÿπÿ±ÿ∂ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
        function showInvoiceDetails(invoiceId) {
            const sale = salesData.find(s => s.invoice_id === invoiceId);
            if (!sale) {
                showToast('ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØÿ©', 'error');
                return;
            }
            
            const content = document.getElementById('invoiceDetailsContent');
            if (!content) return;
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ items ŸÖÿµŸÅŸàŸÅÿ©
            let items = [];
            if (sale.items && Array.isArray(sale.items)) {
                items = sale.items;
            } else if (typeof sale.items === 'string') {
                try {
                    items = JSON.parse(sale.items);
                } catch (e) {
                    items = [];
                }
            }
            
            const itemsHTML = items.length > 0 ? items.map(item => {
                const price = item.product_price || item.price || 0;
                const quantity = item.quantity || 1;
                const total = quantity * price;
                return `
                <tr>
                    <td>${item.product_name || item.name || 'ŸÖŸÜÿ™ÿ¨'}</td>
                    <td style="text-align: center;">${quantity}</td>
                    <td>${formatCurrency(price)}</td>
                    <td style="font-weight: bold; color: var(--primary-color);">${formatCurrency(total)}</td>
                </tr>
                `;
            }).join('') : '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--theme-text-secondary);">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™</td></tr>';
            
            content.innerHTML = `
                <div style="padding: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div style="background: var(--theme-bg-secondary); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</div>
                            <div style="font-size: 18px; font-weight: bold;">${sale.invoice_id}</div>
                        </div>
                        <div style="background: var(--theme-bg-secondary); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</div>
                            <div style="font-size: 16px; font-weight: 500;">${new Date(sale.timestamp).toLocaleString('ar-IQ')}</div>
                        </div>
                        <div style="background: var(--theme-bg-secondary); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ</div>
                            <div style="font-size: 16px; font-weight: 500;">${sale.customer_name || 'ÿπŸÖŸäŸÑ ŸÜŸÇÿØŸä'}</div>
                        </div>
                        <div style="background: var(--theme-bg-secondary); padding: 15px; border-radius: 8px;">
                            <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ</div>
                            <div style="font-size: 16px; font-weight: 500;">
                                <i class="fas fa-${sale.payment_method === 'ŸÜŸÇÿØŸä' ? 'money-bill-wave' : 'credit-card'}"></i>
                                ${sale.payment_type || sale.payment_method}
                            </div>
                        </div>
                    </div>
                    
                    ${sale.customer_phone ? `
                    <div style="background: var(--theme-bg-secondary); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ</div>
                        <div style="font-size: 16px; font-weight: 500;">${sale.customer_phone}</div>
                    </div>
                    ` : ''}
                    
                    ${sale.payment_type === 'ÿ£ŸÇÿ≥ÿßÿ∑' ? `
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 10px 0;"><i class="fas fa-calendar-alt"></i> ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                            <div>
                                <div style="font-size: 12px; opacity: 0.9;">ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ±</div>
                                <div style="font-size: 18px; font-weight: bold;">${sale.installment_months || 0}</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; opacity: 0.9;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ∂ÿßŸÅŸä</div>
                                <div style="font-size: 18px; font-weight: bold;">${formatCurrency(sale.additional_amount || 0)}</div>
                            </div>
                            <div>
                                <div style="font-size: 12px; opacity: 0.9;">ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä</div>
                                <div style="font-size: 18px; font-weight: bold;">${formatCurrency(sale.monthly_amount || 0)}</div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    
                    <h4 style="margin: 20px 0 10px 0; color: var(--primary-color);"><i class="fas fa-shopping-cart"></i> ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™</h4>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: var(--theme-bg-secondary);">
                                    <th style="padding: 10px; text-align: right; border-bottom: 2px solid var(--primary-color);">ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
                                    <th style="padding: 10px; text-align: center; border-bottom: 2px solid var(--primary-color);">ÿßŸÑŸÉŸÖŸäÿ©</th>
                                    <th style="padding: 10px; text-align: right; border-bottom: 2px solid var(--primary-color);">ÿßŸÑÿ≥ÿπÿ±</th>
                                    <th style="padding: 10px; text-align: right; border-bottom: 2px solid var(--primary-color);">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${itemsHTML || '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--theme-text-secondary);">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™</td></tr>'}
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: var(--theme-bg-secondary); border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä:</span>
                            <span style="font-weight: bold;">${formatCurrency(sale.subtotal || 0)}</span>
                        </div>
                        ${(sale.discount_amount || sale.discount) ? `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: var(--success-color);">
                            <span>ÿßŸÑÿÆÿµŸÖ:</span>
                            <span style="font-weight: bold;">-${formatCurrency(sale.discount_amount || sale.discount || 0)}</span>
                        </div>
                        ` : ''}
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©:</span>
                            <span style="font-weight: bold;">${formatCurrency(sale.tax_amount || sale.tax || 0)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding-top: 10px; border-top: 2px solid var(--primary-color); font-size: 20px; font-weight: bold; color: var(--primary-color);">
                            <span>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä:</span>
                            <span>${formatCurrency(sale.final_total || 0)}</span>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-primary" onclick="printInvoice('${sale.invoice_id}')">
                            <i class="fas fa-print"></i> ÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
                        </button>
                        <button class="btn btn-secondary" onclick="closeModal('invoiceDetailsModal')" style="margin-right: 10px;">
                            <i class="fas fa-times"></i> ÿ•ÿ∫ŸÑÿßŸÇ
                        </button>
                    </div>
                </div>
            `;
            
            showModal('invoiceDetailsModal');
        }

        // ========================================
        // ŸÜÿ∏ÿßŸÖ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑŸÖÿ™ŸÇÿØŸÖ
        // ========================================

        // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
        const defaultPrinterSettings = {
            printerType: 'default',
            printMode: 'preview',
            paperSize: '80mm',
            storeTitleSize: 24,
            storeInfoSize: 14,
            invoiceTextSize: 13,
            tableTextSize: 12,
            totalTextSize: 16,
            footerTextSize: 11,
            lineHeight: 1.4,
            sidePadding: 15,
            topBottomPadding: 15,
            borderStyle: 'dashed',
            borderWidth: 1,
            titleAlign: 'center',
            showLogo: false,
            showDateTime: true,
            showInvoiceNumber: true,
            showProductsTable: true,
            showFooter: true,
            customFooter: 'ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ\nŸÜÿ™ÿ∑ŸÑÿπ ŸÑÿÆÿØŸÖÿ™ŸÉŸÖ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ'
        };

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ© ÿπŸÜÿØ ÿ®ÿØÿ° ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        function loadPrinterSettings() {
            const saved = localStorage.getItem('printerSettings');
            const settings = saved ? JSON.parse(saved) : defaultPrinterSettings;
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿπŸÜÿßÿµÿ±
            if (document.getElementById('printerType')) {
                document.getElementById('printerType').value = settings.printerType || 'default';
                document.getElementById('paperSize').value = settings.paperSize || '80mm';
                
                // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿÆÿ∑Ÿàÿ∑
                document.getElementById('storeTitleSize').value = settings.storeTitleSize || 24;
                document.getElementById('storeTitleSizeValue').textContent = settings.storeTitleSize || 24;
                
                document.getElementById('storeInfoSize').value = settings.storeInfoSize || 14;
                document.getElementById('storeInfoSizeValue').textContent = settings.storeInfoSize || 14;
                
                document.getElementById('invoiceTextSize').value = settings.invoiceTextSize || 13;
                document.getElementById('invoiceTextSizeValue').textContent = settings.invoiceTextSize || 13;
                
                document.getElementById('tableTextSize').value = settings.tableTextSize || 12;
                document.getElementById('tableTextSizeValue').textContent = settings.tableTextSize || 12;
                
                document.getElementById('totalTextSize').value = settings.totalTextSize || 16;
                document.getElementById('totalTextSizeValue').textContent = settings.totalTextSize || 16;
                
                document.getElementById('footerTextSize').value = settings.footerTextSize || 11;
                document.getElementById('footerTextSizeValue').textContent = settings.footerTextSize || 11;
                
                // ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ
                document.getElementById('lineHeight').value = settings.lineHeight || 1.4;
                document.getElementById('lineHeightValue').textContent = settings.lineHeight || 1.4;
                
                document.getElementById('sidePadding').value = settings.sidePadding || 15;
                document.getElementById('sidePaddingValue').textContent = settings.sidePadding || 15;
                
                document.getElementById('topBottomPadding').value = settings.topBottomPadding || 15;
                document.getElementById('topBottomPaddingValue').textContent = settings.topBottomPadding || 15;
                
                document.getElementById('borderStyle').value = settings.borderStyle || 'dashed';
                document.getElementById('borderWidth').value = settings.borderWidth || 1;
                document.getElementById('borderWidthValue').textContent = settings.borderWidth || 1;
                
                document.getElementById('titleAlign').value = settings.titleAlign || 'center';
                
                // ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅŸäÿ©
                document.getElementById('showLogo').checked = settings.showLogo || false;
                document.getElementById('showDateTime').checked = settings.showDateTime !== false;
                document.getElementById('showInvoiceNumber').checked = settings.showInvoiceNumber !== false;
                document.getElementById('showProductsTable').checked = settings.showProductsTable !== false;
                document.getElementById('showFooter').checked = settings.showFooter !== false;
                document.getElementById('customFooter').value = settings.customFooter || '';
                
                // Ÿàÿ∂ÿπ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
                const printMode = settings.printMode || 'preview';
                document.querySelector(`input[name="printMode"][value="${printMode}"]`).checked = true;
                
                // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
                updatePrinterStats();
            }
            
            return settings;
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
        function savePrinterSettings() {
            const settings = {
                printerType: document.getElementById('printerType').value,
                printMode: document.querySelector('input[name="printMode"]:checked').value,
                paperSize: document.getElementById('paperSize').value,
                storeTitleSize: parseInt(document.getElementById('storeTitleSize').value),
                storeInfoSize: parseInt(document.getElementById('storeInfoSize').value),
                invoiceTextSize: parseInt(document.getElementById('invoiceTextSize').value),
                tableTextSize: parseInt(document.getElementById('tableTextSize').value),
                totalTextSize: parseInt(document.getElementById('totalTextSize').value),
                footerTextSize: parseInt(document.getElementById('footerTextSize').value),
                lineHeight: parseFloat(document.getElementById('lineHeight').value),
                sidePadding: parseInt(document.getElementById('sidePadding').value),
                topBottomPadding: parseInt(document.getElementById('topBottomPadding').value),
                borderStyle: document.getElementById('borderStyle').value,
                borderWidth: parseInt(document.getElementById('borderWidth').value),
                titleAlign: document.getElementById('titleAlign').value,
                showLogo: document.getElementById('showLogo').checked,
                showDateTime: document.getElementById('showDateTime').checked,
                showInvoiceNumber: document.getElementById('showInvoiceNumber').checked,
                showProductsTable: document.getElementById('showProductsTable').checked,
                showFooter: document.getElementById('showFooter').checked,
                customFooter: document.getElementById('customFooter').value
            };
            
            localStorage.setItem('printerSettings', JSON.stringify(settings));
            showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
            updatePrinterStats();
        }

        // ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
        function resetPrinterSettings() {
            if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©ÿü')) {
                localStorage.setItem('printerSettings', JSON.stringify(defaultPrinterSettings));
                loadPrinterSettings();
                updatePreview();
                showToast('ÿ™ŸÖ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©', 'info');
            }
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ∑ÿßÿ®ÿπÿ©
        function updatePrinterStats() {
            const settings = JSON.parse(localStorage.getItem('printerSettings') || '{}');
            const printerTypeNames = {
                'default': 'ÿπÿßÿØŸäÿ©',
                'thermal': 'ÿ≠ÿ±ÿßÿ±Ÿäÿ© 80mm',
                'thermal-58': 'ÿ≠ÿ±ÿßÿ±Ÿäÿ© 58mm'
            };
            
            if (document.getElementById('activePrinterType')) {
                document.getElementById('activePrinterType').textContent = 
                    printerTypeNames[settings.printerType] || 'ÿπÿßÿØŸäÿ©';
            }
            if (document.getElementById('activePaperSize')) {
                document.getElementById('activePaperSize').textContent = settings.paperSize || '80mm';
            }
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©
        function updatePreview() {
            const settings = {
                printerType: document.getElementById('printerType')?.value || 'default',
                paperSize: document.getElementById('paperSize')?.value || '80mm',
                storeTitleSize: parseInt(document.getElementById('storeTitleSize')?.value || 24),
                storeInfoSize: parseInt(document.getElementById('storeInfoSize')?.value || 14),
                invoiceTextSize: parseInt(document.getElementById('invoiceTextSize')?.value || 13),
                tableTextSize: parseInt(document.getElementById('tableTextSize')?.value || 12),
                totalTextSize: parseInt(document.getElementById('totalTextSize')?.value || 16),
                footerTextSize: parseInt(document.getElementById('footerTextSize')?.value || 11),
                lineHeight: parseFloat(document.getElementById('lineHeight')?.value || 1.4),
                sidePadding: parseInt(document.getElementById('sidePadding')?.value || 15),
                topBottomPadding: parseInt(document.getElementById('topBottomPadding')?.value || 15),
                borderStyle: document.getElementById('borderStyle')?.value || 'dashed',
                borderWidth: parseInt(document.getElementById('borderWidth')?.value || 1),
                titleAlign: document.getElementById('titleAlign')?.value || 'center',
                showLogo: document.getElementById('showLogo')?.checked || false,
                showDateTime: document.getElementById('showDateTime')?.checked !== false,
                showInvoiceNumber: document.getElementById('showInvoiceNumber')?.checked !== false,
                showProductsTable: document.getElementById('showProductsTable')?.checked !== false,
                showFooter: document.getElementById('showFooter')?.checked !== false,
                customFooter: document.getElementById('customFooter')?.value || ''
            };
            
            const preview = document.getElementById('receiptPreview');
            if (!preview) return;
            
            // ÿ™ÿ≠ÿØŸäÿØ ÿπÿ±ÿ∂ ÿßŸÑÿ•ŸäÿµÿßŸÑ ÿ®ŸÜÿßÿ°Ÿã ÿπŸÑŸâ ÿ≠ÿ¨ŸÖ ÿßŸÑŸàÿ±ŸÇ
            let receiptWidth = '80mm';
            if (settings.paperSize === '58mm' || settings.printerType === 'thermal-58') {
                receiptWidth = '58mm';
            } else if (settings.paperSize === 'A4') {
                receiptWidth = '210mm';
            } else if (settings.paperSize === 'A5') {
                receiptWidth = '148mm';
            }
            
            // ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±
            const storeName = localStorage.getItem('storeName') || 'ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿ™ŸÇŸÜŸäÿ© ÿßŸÑÿ≠ÿØŸäÿ´ÿ©';
            const storeAddress = localStorage.getItem('storeAddress') || 'ÿ®ÿ∫ÿØÿßÿØ - ÿßŸÑŸÖŸÜÿµŸàÿ±';
            const storePhone = localStorage.getItem('storePhone') || '07901234567';
            
            // ÿ™ÿßÿ±ŸäÿÆ ŸàŸàŸÇÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            const now = new Date();
            const dateStr = now.toLocaleDateString('ar-IQ');
            const timeStr = now.toLocaleTimeString('ar-IQ', { hour: '2-digit', minute: '2-digit' });
            
            // ÿ®ŸÜÿßÿ° HTML ÿßŸÑÿ•ŸäÿµÿßŸÑ
            let receiptHTML = `
                <div style="
                    width: ${receiptWidth};
                    padding: ${settings.topBottomPadding}px ${settings.sidePadding}px;
                    font-family: 'Cairo', sans-serif;
                    line-height: ${settings.lineHeight};
                    font-size: ${settings.invoiceTextSize}px;
                ">
            `;
            
            // ÿßŸÑÿ¥ÿπÿßÿ± (ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖŸÅÿπŸÑÿßŸã)
            if (settings.showLogo) {
                receiptHTML += `
                    <div style="text-align: ${settings.titleAlign}; margin-bottom: 10px;">
                        <i class="fas fa-store" style="font-size: ${settings.storeTitleSize * 1.5}px; color: #6366f1;"></i>
                    </div>
                `;
            }
            
            // ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ±
            receiptHTML += `
                <div style="text-align: ${settings.titleAlign}; margin-bottom: 15px;">
                    <h2 style="
                        margin: 0 0 8px 0;
                        font-size: ${settings.storeTitleSize}px;
                        font-weight: bold;
                    ">${storeName}</h2>
                    <p style="margin: 4px 0; font-size: ${settings.storeInfoSize}px;">${storeAddress}</p>
                    <p style="margin: 4px 0; font-size: ${settings.storeInfoSize}px;">üìû ${storePhone}</p>
                </div>
            `;
            
            // ÿÆÿ∑ ŸÅÿßÿµŸÑ ÿπŸÑŸàŸä
            receiptHTML += `
                <div style="
                    border-top: ${settings.borderWidth}px ${settings.borderStyle} #000;
                    margin: 15px 0;
                "></div>
            `;
            
            // ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            receiptHTML += `<div style="margin: 10px 0; font-size: ${settings.invoiceTextSize}px;">`;
            
            if (settings.showInvoiceNumber) {
                receiptHTML += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©:</span>
                        <span style="font-weight: bold;">INV-${String(Math.floor(Math.random() * 10000)).padStart(4, '0')}</span>
                    </div>
                `;
            }
            
            if (settings.showDateTime) {
                receiptHTML += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>ÿßŸÑÿ™ÿßÿ±ŸäÿÆ:</span>
                        <span>${dateStr}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>ÿßŸÑŸàŸÇÿ™:</span>
                        <span>${timeStr}</span>
                    </div>
                `;
            }
            
            receiptHTML += `</div>`;
            
            // ÿÆÿ∑ ŸÅÿßÿµŸÑ
            receiptHTML += `
                <div style="
                    border-top: ${settings.borderWidth}px ${settings.borderStyle} #000;
                    margin: 15px 0;
                "></div>
            `;
            
            // ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            if (settings.showProductsTable) {
                receiptHTML += `
                    <table style="
                        width: 100%;
                        border-collapse: collapse;
                        font-size: ${settings.tableTextSize}px;
                        margin: 10px 0;
                    ">
                        <thead>
                            <tr style="border-bottom: ${settings.borderWidth}px solid #000;">
                                <th style="text-align: right; padding: 5px 0; font-weight: bold;">ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
                                <th style="text-align: center; padding: 5px 0; font-weight: bold;">ÿßŸÑŸÉŸÖŸäÿ©</th>
                                <th style="text-align: left; padding: 5px 0; font-weight: bold;">ÿßŸÑÿ≥ÿπÿ±</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 8px 0; border-bottom: 1px dotted #ccc;">ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 1</td>
                                <td style="text-align: center; padding: 8px 0; border-bottom: 1px dotted #ccc;">2</td>
                                <td style="text-align: left; padding: 8px 0; border-bottom: 1px dotted #ccc;">20,000</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; border-bottom: 1px dotted #ccc;">ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 2</td>
                                <td style="text-align: center; padding: 8px 0; border-bottom: 1px dotted #ccc;">1</td>
                                <td style="text-align: left; padding: 8px 0; border-bottom: 1px dotted #ccc;">15,000</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0;">ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 3</td>
                                <td style="text-align: center; padding: 8px 0;">3</td>
                                <td style="text-align: left; padding: 8px 0;">45,000</td>
                            </tr>
                        </tbody>
                    </table>
                `;
            }
            
            // ÿÆÿ∑ ŸÅÿßÿµŸÑ
            receiptHTML += `
                <div style="
                    border-top: ${settings.borderWidth}px ${settings.borderStyle} #000;
                    margin: 15px 0;
                "></div>
            `;
            
            // ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
            receiptHTML += `
                <div style="
                    font-size: ${settings.totalTextSize}px;
                    font-weight: bold;
                    margin: 15px 0;
                ">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑÿ¨ÿ≤ÿ¶Ÿä:</span>
                        <span>80,000 ÿØŸäŸÜÿßÿ±</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>ÿßŸÑÿÆÿµŸÖ:</span>
                        <span style="color: #10b981;">- 5,000 ÿØŸäŸÜÿßÿ±</span>
                    </div>
                    <div style="
                        display: flex;
                        justify-content: space-between;
                        padding-top: 8px;
                        border-top: 2px solid #000;
                    ">
                        <span>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä:</span>
                        <span>75,000 ÿØŸäŸÜÿßÿ±</span>
                    </div>
                </div>
            `;
            
            // ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ
            if (settings.showFooter) {
                const footerText = settings.customFooter || 'ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ\nŸÜÿ™ÿ∑ŸÑÿπ ŸÑÿÆÿØŸÖÿ™ŸÉŸÖ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ';
                const footerLines = footerText.split('\n');
                
                receiptHTML += `
                    <div style="
                        text-align: center;
                        margin-top: 20px;
                        font-size: ${settings.footerTextSize}px;
                        color: #666;
                    ">
                `;
                
                footerLines.forEach(line => {
                    receiptHTML += `<p style="margin: 4px 0;">${line}</p>`;
                });
                
                receiptHTML += `
                        <p style="margin-top: 10px;">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</p>
                    </div>
                `;
            }
            
            receiptHTML += `</div>`;
            
            preview.innerHTML = receiptHTML;
        }

        // ÿ∑ÿ®ÿßÿπÿ© ŸÅÿßÿ™Ÿàÿ±ÿ© ŸÅÿπŸÑŸäÿ©
        function printInvoice(invoiceId, silent = false) {
            const settings = JSON.parse(localStorage.getItem('printerSettings') || '{}');
            const sale = salesData.find(s => s.invoice_id === invoiceId);
            
            if (!sale) {
                showToast('ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØÿ©', 'error');
                return;
            }
            
            // ÿ®ŸÜÿßÿ° ŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ•ŸäÿµÿßŸÑ ŸÑŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÅÿπŸÑŸäÿ©
            const receiptContent = generateInvoiceReceipt(sale, settings);
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿßŸÅÿ∞ÿ© ÿ∑ÿ®ÿßÿπÿ©
            const printWindow = window.open('', '_blank', 'width=800,height=600');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html dir="rtl" lang="ar">
                <head>
                    <meta charset="UTF-8">
                    <title>ÿ∑ÿ®ÿßÿπÿ© ŸÅÿßÿ™Ÿàÿ±ÿ© ${sale.invoice_id}</title>
                    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Cairo', sans-serif;
                            direction: rtl;
                            background: white;
                        }
                        @media print {
                            body { margin: 0; }
                            @page { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${receiptContent}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            
            // ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿäÿ© ÿ£Ÿà ÿßŸÑŸÖÿπÿßŸäŸÜÿ©
            if (settings.printMode === 'direct' || silent) {
                printWindow.print();
                printWindow.close();
            } else {
                printWindow.focus();
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
            updatePrintStats();
            
            showToast('ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ŸÑŸÑÿ∑ÿ®ÿßÿπÿ©', 'success');
        }

        // ÿ™ŸàŸÑŸäÿØ ŸÖÿ≠ÿ™ŸàŸâ ÿ•ŸäÿµÿßŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
        function generateInvoiceReceipt(sale, settings) {
            const storeName = localStorage.getItem('storeName') || 'ŸÖÿ™ÿ¨ÿ± ÿßŸÑÿ™ŸÇŸÜŸäÿ© ÿßŸÑÿ≠ÿØŸäÿ´ÿ©';
            const storeAddress = localStorage.getItem('storeAddress') || 'ÿ®ÿ∫ÿØÿßÿØ - ÿßŸÑŸÖŸÜÿµŸàÿ±';
            const storePhone = localStorage.getItem('storePhone') || '07901234567';
            
            // ÿ™ÿ≠ÿØŸäÿØ ÿπÿ±ÿ∂ ÿßŸÑÿ•ŸäÿµÿßŸÑ
            let receiptWidth = '80mm';
            if (settings.paperSize === '58mm' || settings.printerType === 'thermal-58') {
                receiptWidth = '58mm';
            } else if (settings.paperSize === 'A4') {
                receiptWidth = '210mm';
            } else if (settings.paperSize === 'A5') {
                receiptWidth = '148mm';
            }
            
            const saleDate = new Date(sale.date);
            const dateStr = saleDate.toLocaleDateString('ar-IQ');
            const timeStr = saleDate.toLocaleTimeString('ar-IQ', { hour: '2-digit', minute: '2-digit' });
            
            let html = `
                <div style="
                    width: ${receiptWidth};
                    margin: 0 auto;
                    padding: ${settings.topBottomPadding || 15}px ${settings.sidePadding || 15}px;
                    font-family: 'Cairo', sans-serif;
                    line-height: ${settings.lineHeight || 1.4};
                    font-size: ${settings.invoiceTextSize || 13}px;
                ">
            `;
            
            // ÿßŸÑÿ¥ÿπÿßÿ±
            if (settings.showLogo) {
                html += `
                    <div style="text-align: ${settings.titleAlign || 'center'}; margin-bottom: 10px;">
                        <div style="font-size: ${(settings.storeTitleSize || 24) * 1.5}px; color: #6366f1;">‚òÖ</div>
                    </div>
                `;
            }
            
            // ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖÿ™ÿ¨ÿ±
            html += `
                <div style="text-align: ${settings.titleAlign || 'center'}; margin-bottom: 15px;">
                    <h2 style="margin: 0 0 8px 0; font-size: ${settings.storeTitleSize || 24}px; font-weight: bold;">${storeName}</h2>
                    <p style="margin: 4px 0; font-size: ${settings.storeInfoSize || 14}px;">${storeAddress}</p>
                    <p style="margin: 4px 0; font-size: ${settings.storeInfoSize || 14}px;">üìû ${storePhone}</p>
                </div>
                <div style="border-top: ${settings.borderWidth || 1}px ${settings.borderStyle || 'dashed'} #000; margin: 15px 0;"></div>
            `;
            
            // ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            html += `<div style="margin: 10px 0; font-size: ${settings.invoiceTextSize || 13}px;">`;
            if (settings.showInvoiceNumber !== false) {
                html += `<div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                    <span>ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©:</span><span style="font-weight: bold;">${sale.invoice_id}</span>
                </div>`;
            }
            if (settings.showDateTime !== false) {
                html += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>ÿßŸÑÿ™ÿßÿ±ŸäÿÆ:</span><span>${dateStr}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>ÿßŸÑŸàŸÇÿ™:</span><span>${timeStr}</span>
                    </div>
                `;
            }
            html += `</div><div style="border-top: ${settings.borderWidth || 1}px ${settings.borderStyle || 'dashed'} #000; margin: 15px 0;"></div>`;
            
            // ÿ¨ÿØŸàŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
            if (settings.showProductsTable !== false && sale.items && sale.items.length > 0) {
                html += `
                    <table style="width: 100%; border-collapse: collapse; font-size: ${settings.tableTextSize || 12}px; margin: 10px 0;">
                        <thead>
                            <tr style="border-bottom: ${settings.borderWidth || 1}px solid #000;">
                                <th style="text-align: right; padding: 5px 0; font-weight: bold;">ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
                                <th style="text-align: center; padding: 5px 0; font-weight: bold;">ÿßŸÑŸÉŸÖŸäÿ©</th>
                                <th style="text-align: left; padding: 5px 0; font-weight: bold;">ÿßŸÑÿ≥ÿπÿ±</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                sale.items.forEach((item, index) => {
                    const borderStyle = index < sale.items.length - 1 ? 'border-bottom: 1px dotted #ccc;' : '';
                    html += `
                        <tr>
                            <td style="padding: 8px 0; ${borderStyle}">${item.name}</td>
                            <td style="text-align: center; padding: 8px 0; ${borderStyle}">${item.quantity}</td>
                            <td style="text-align: left; padding: 8px 0; ${borderStyle}">${(item.price * item.quantity).toLocaleString()}</td>
                        </tr>
                    `;
                });
                
                html += `</tbody></table>`;
            }
            
            html += `<div style="border-top: ${settings.borderWidth || 1}px ${settings.borderStyle || 'dashed'} #000; margin: 15px 0;"></div>`;
            
            // ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
            html += `
                <div style="font-size: ${settings.totalTextSize || 16}px; font-weight: bold; margin: 15px 0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑÿ¨ÿ≤ÿ¶Ÿä:</span>
                        <span>${(sale.total_amount || 0).toLocaleString()} ÿØŸäŸÜÿßÿ±</span>
                    </div>
            `;
            
            if (sale.discount && sale.discount > 0) {
                html += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>ÿßŸÑÿÆÿµŸÖ:</span>
                        <span style="color: #10b981;">- ${sale.discount.toLocaleString()} ÿØŸäŸÜÿßÿ±</span>
                    </div>
                `;
            }
            
            html += `
                    <div style="display: flex; justify-content: space-between; padding-top: 8px; border-top: 2px solid #000;">
                        <span>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä:</span>
                        <span>${(sale.final_total || sale.total_amount || 0).toLocaleString()} ÿØŸäŸÜÿßÿ±</span>
                    </div>
                </div>
            `;
            
            // ÿßŸÑÿ™ÿ∞ŸäŸäŸÑ
            if (settings.showFooter !== false) {
                const footerText = settings.customFooter || 'ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ≤Ÿäÿßÿ±ÿ™ŸÉŸÖ\nŸÜÿ™ÿ∑ŸÑÿπ ŸÑÿÆÿØŸÖÿ™ŸÉŸÖ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ';
                const footerLines = footerText.split('\n');
                
                html += `<div style="text-align: center; margin-top: 20px; font-size: ${settings.footerTextSize || 11}px; color: #666;">`;
                footerLines.forEach(line => {
                    html += `<p style="margin: 4px 0;">${line}</p>`;
                });
                html += `<p style="margin-top: 10px;">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</p></div>`;
            }
            
            html += `</div>`;
            return html;
        }

        // ÿ∑ÿ®ÿßÿπÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
        function testPrint() {
            const settings = JSON.parse(localStorage.getItem('printerSettings') || '{}');
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÅÿßÿ™Ÿàÿ±ÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©
            const testInvoice = {
                invoice_id: 'TEST-' + Date.now(),
                date: new Date().toISOString(),
                items: [
                    { name: 'ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 1', quantity: 2, price: 10000 },
                    { name: 'ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 2', quantity: 1, price: 15000 },
                    { name: 'ŸÖŸÜÿ™ÿ¨ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä 3', quantity: 3, price: 15000 }
                ],
                total_amount: 80000,
                discount: 5000,
                final_total: 75000
            };
            
            const receiptContent = generateInvoiceReceipt(testInvoice, settings);
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿßŸÅÿ∞ÿ© ÿ∑ÿ®ÿßÿπÿ©
            const printWindow = window.open('', '_blank', 'width=800,height=600');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html dir="rtl" lang="ar">
                <head>
                    <meta charset="UTF-8">
                    <title>ÿ∑ÿ®ÿßÿπÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©</title>
                    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
                    <style>
                        * { margin: 0; padding: 0; box-sizing: border-box; }
                        body { 
                            font-family: 'Cairo', sans-serif;
                            direction: rtl;
                            background: white;
                            padding: 20px;
                        }
                        @media print {
                            body { margin: 0; padding: 0; }
                            @page { margin: 0; }
                        }
                    </style>
                </head>
                <body>
                    ${receiptContent}
                    <div style="text-align: center; margin-top: 30px; padding: 20px; background: #f0f9ff; border-radius: 8px;">
                        <p style="color: #0369a1; font-weight: bold;">‚úì Ÿáÿ∞ÿß ÿ•ŸäÿµÿßŸÑ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿä</p>
                        <p style="color: #666; font-size: 14px; margin-top: 5px;">ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ¢ŸÜ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿ£Ÿà ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ©</p>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            showToast('ÿ™ŸÖ ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©', 'success');
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
        function updatePrintStats() {
            let totalPrints = parseInt(localStorage.getItem('totalPrints') || '0');
            totalPrints++;
            localStorage.setItem('totalPrints', totalPrints);
            
            const today = new Date().toDateString();
            const lastPrintDate = localStorage.getItem('lastPrintDate');
            let todayPrints = parseInt(localStorage.getItem('todayPrints') || '0');
            
            if (lastPrintDate !== today) {
                todayPrints = 1;
                localStorage.setItem('lastPrintDate', today);
            } else {
                todayPrints++;
            }
            localStorage.setItem('todayPrints', todayPrints);
            
            if (document.getElementById('totalPrints')) {
                document.getElementById('totalPrints').textContent = totalPrints;
            }
            if (document.getElementById('todayPrints')) {
                document.getElementById('todayPrints').textContent = todayPrints;
            }
        }

        function showDebtDetails(debtId) {
            const debt = debtsData.find(d => 
                d.id == debtId || 
                d.__backendId == debtId || 
                d.debt_id == debtId
            );
            if (!debt) {
                console.log('Debt not found. Looking for ID:', debtId);
                console.log('Available debts:', debtsData);
                showToast('ÿßŸÑÿØŸäŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ÿ≠ŸÅÿ∏ ŸÖÿπÿ±ŸÅ ÿßŸÑÿØŸäŸÜ ÿßŸÑÿ≠ÿßŸÑŸä
            window.currentDebtId = debtId;
            window.currentDebt = debt;
            
            // ÿßŸÑÿßŸÜÿ™ŸÇÿßŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿ© ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿØŸäŸÜ
            navigateTo('debtDetailsPage');
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ÿ©
            const relatedSale = salesData.find(s => s.invoice_id === debt.invoice_id);
            
            // ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ
            renderDebtCustomerInfo(debt);
            
            // ÿπÿ±ÿ∂ ŸÖŸÑÿÆÿµ ÿßŸÑÿØŸäŸÜ
            renderDebtSummary(debt);
            
            // ÿπÿ±ÿ∂ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
            renderDebtInvoiceDetails(relatedSale);
            
            // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
            renderInstallmentsTable(debt, relatedSale);
            
            // ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™
            renderPaymentsHistory(debt);
        }
        
        // ÿπÿ±ÿ∂ ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ
        function renderDebtCustomerInfo(debt) {
            const container = document.getElementById('debtCustomerInfo');
            if (!container) return;
            
            // ÿ≠ÿ≥ÿßÿ® ÿπÿØÿØ ÿßŸÑÿ£ÿ¥Ÿáÿ± ÿßŸÑŸÖÿ≥ÿØÿØÿ© ŸàÿßŸÑŸÖÿ™ÿ®ŸÇŸäÿ©
            let paidMonths = 0;
            let remainingMonths = 0;
            let isPaid = false;
            
            if (debt.installments && Array.isArray(debt.installments) && debt.installments.length > 0) {
                paidMonths = debt.installments.filter(inst => inst.status === 'paid').length;
                remainingMonths = debt.installments.length - paidMonths;
                isPaid = remainingMonths === 0;
            } else {
                // ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™Ÿàÿ¨ÿØ ÿ£ŸÇÿ≥ÿßÿ∑ÿå ŸÜÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑŸÇÿØŸäŸÖÿ©
                const remainingAmount = debt.remaining_amount !== undefined ? debt.remaining_amount : (debt.total_amount || debt.final_total || 0);
                isPaid = remainingAmount <= 0;
                remainingMonths = isPaid ? 0 : (debt.installment_months || 0);
            }
            
            const isOverdue = new Date(debt.due_date) < new Date() && !isPaid;
            
            console.log('Customer info - Paid months:', paidMonths, 'Remaining:', remainingMonths, 'isPaid:', isPaid);
            
            let statusColor = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            let statusText = `${paidMonths} ŸÖŸÜ ${debt.installment_months || 0} ÿ¥Ÿáÿ±`;
            let statusIcon = 'clock';
            
            if (isPaid) {
                statusColor = 'var(--success-gradient)';
                statusText = 'ŸÖÿ≥ÿØÿØ ÿ®ÿßŸÑŸÉÿßŸÖŸÑ';
                statusIcon = 'check-double';
            } else if (isOverdue) {
                statusColor = 'var(--danger-gradient)';
                statusText = `ŸÖÿ™ÿ£ÿÆÿ± - ${paidMonths}/${debt.installment_months || 0} ÿ¥Ÿáÿ±`;
                statusIcon = 'exclamation-triangle';
            }
            
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-user"></i></div>
                    <div class="stat-label">ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ</div>
                    <div class="stat-value" style="font-size: 1.5rem;">${debt.customer_name}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-phone"></i></div>
                    <div class="stat-label">ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ</div>
                    <div class="stat-value" style="font-size: 1.5rem;">${debt.customer_phone}</div>
                </div>
                <div class="stat-card" style="background: ${statusColor}; color: white;">
                    <div class="stat-icon"><i class="fas fa-${statusIcon}"></i></div>
                    <div class="stat-label">ÿßŸÑÿ≠ÿßŸÑÿ©</div>
                    <div class="stat-value">${statusText}</div>
                </div>
            `;
        }
        
        // ÿπÿ±ÿ∂ ŸÖŸÑÿÆÿµ ÿßŸÑÿØŸäŸÜ
        function renderDebtSummary(debt) {
            const container = document.getElementById('debtSummaryCard');
            if (!container) return;
            
            console.log('Debt summary data:', debt);
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ÿßŸÑÿ∫ ÿ®ÿØŸÇÿ©
            let totalAmount = debt.total_amount || debt.final_total || 0;
            
            // ÿ•ÿ∞ÿß ŸÑŸÖ ŸäŸÉŸÜ ŸáŸÜÿßŸÉ total_amountÿå ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ© ÿßŸÑŸÖÿ±ÿ™ÿ®ÿ∑ÿ©
            if (totalAmount === 0 && debt.invoice_id) {
                const relatedSale = salesData.find(s => s.invoice_id === debt.invoice_id);
                if (relatedSale) {
                    totalAmount = relatedSale.final_total || 0;
                }
            }
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ ŸÖŸÜ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
            let paidAmount = 0;
            let paidMonths = 0;
            
            if (debt.installments && Array.isArray(debt.installments) && debt.installments.length > 0) {
                debt.installments.forEach(inst => {
                    if (inst.status === 'paid') {
                        const instAmount = parseFloat(inst.paid_amount || inst.amount || 0);
                        paidAmount += instAmount;
                        paidMonths++;
                    }
                });
            } else if (debt.paid_amount !== undefined && debt.paid_amount !== null) {
                paidAmount = parseFloat(debt.paid_amount) || 0;
            }
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ
            totalAmount = parseFloat(totalAmount) || 0;
            paidAmount = parseFloat(paidAmount) || 0;
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä
            let remainingAmount = totalAmount - paidAmount;
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸÑÿß ŸäŸÉŸàŸÜ ÿ≥ÿßŸÑÿ®
            if (remainingAmount < 0) remainingAmount = 0;
            
            // ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÜÿ≥ÿ®ÿ© ÿßŸÑŸÖÿ¶ŸàŸäÿ© ŸÖÿπ ÿ≠ŸÖÿßŸäÿ© ŸÖŸÜ ÿßŸÑŸÇÿ≥ŸÖÿ© ÿπŸÑŸâ ÿµŸÅÿ±
            let percentage = 0;
            if (totalAmount > 0 && !isNaN(totalAmount) && !isNaN(paidAmount)) {
                percentage = ((paidAmount / totalAmount) * 100).toFixed(1);
            }
            
            console.log('Summary - Total:', totalAmount, 'Paid:', paidAmount, 'Remaining:', remainingAmount, 'Percentage:', percentage + '%', 'Paid months:', paidMonths);
            
            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div>
                        <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--primary-color);">${formatCurrency(totalAmount)}</div>
                    </div>
                    <div>
                        <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--success-color);">${formatCurrency(paidAmount)}</div>
                    </div>
                    <div>
                        <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä</div>
                        <div style="font-size: 24px; font-weight: bold; color: var(--danger-color);">${formatCurrency(remainingAmount)}</div>
                    </div>
                    <div>
                        <div style="color: var(--theme-text-secondary); font-size: 14px; margin-bottom: 5px;">ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ≥ÿØÿßÿØ</div>
                        <div style="font-size: 24px; font-weight: bold;">${percentage}%</div>
                        <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; margin-top: 10px; overflow: hidden;">
                            <div style="width: ${percentage}%; height: 100%; background: var(--success-gradient); transition: width 0.3s ease;"></div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ÿπÿ±ÿ∂ ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©
        function renderDebtInvoiceDetails(relatedSale) {
            const container = document.getElementById('debtInvoiceDetails');
            if (!container) return;
            
            if (!relatedSale) {
                container.innerHTML = '<p style="text-align: center; color: var(--theme-text-secondary); padding: 20px;">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÅÿßÿ™Ÿàÿ±ÿ© ŸÖÿ±ÿ™ÿ®ÿ∑ÿ©</p>';
                return;
            }
            
            // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ items ŸÖÿµŸÅŸàŸÅÿ©
            let items = [];
            if (relatedSale.items && Array.isArray(relatedSale.items)) {
                items = relatedSale.items;
            } else if (typeof relatedSale.items === 'string') {
                try {
                    items = JSON.parse(relatedSale.items);
                } catch (e) {
                    items = [];
                }
            }
            
            const itemsHTML = items.length > 0 ? items.map(item => {
                const price = item.product_price || item.price || 0;
                const quantity = item.quantity || 1;
                const total = quantity * price;
                return `
                <tr>
                    <td>${item.product_name || item.name || 'ŸÖŸÜÿ™ÿ¨'}</td>
                    <td style="text-align: center;">${quantity}</td>
                    <td>${formatCurrency(price)}</td>
                    <td style="font-weight: bold; color: var(--primary-color);">${formatCurrency(total)}</td>
                </tr>
                `;
            }).join('') : '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--theme-text-secondary);">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™</td></tr>';
            
            container.innerHTML = `
                <div style="background: var(--theme-bg-secondary); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: var(--theme-text-secondary); font-size: 14px;">ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©</div>
                            <div style="font-size: 18px; font-weight: bold; margin-top: 5px;">${relatedSale.invoice_id}</div>
                        </div>
                        <div>
                            <div style="color: var(--theme-text-secondary); font-size: 14px;">ÿßŸÑÿ™ÿßÿ±ŸäÿÆ</div>
                            <div style="font-size: 16px; font-weight: 500; margin-top: 5px;">${new Date(relatedSale.timestamp).toLocaleDateString('ar-IQ')}</div>
                        </div>
                        <div>
                            <div style="color: var(--theme-text-secondary); font-size: 14px;">ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ</div>
                            <div style="font-size: 16px; font-weight: 500; margin-top: 5px;">
                                <i class="fas fa-calendar-alt"></i> ${relatedSale.payment_type || 'ÿ£ŸÇÿ≥ÿßÿ∑'}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ÿßŸÑŸÖŸÜÿ™ÿ¨</th>
                                <th style="text-align: center;">ÿßŸÑŸÉŸÖŸäÿ©</th>
                                <th>ÿßŸÑÿ≥ÿπÿ±</th>
                                <th>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${itemsHTML}
                        </tbody>
                    </table>
                </div>
                
                <div style="margin-top: 20px; padding: 20px; background: var(--theme-bg-secondary); border-radius: 12px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>ÿßŸÑŸÖÿ¨ŸÖŸàÿπ ÿßŸÑŸÅÿ±ÿπŸä:</span>
                        <span style="font-weight: bold;">${formatCurrency(relatedSale.subtotal || 0)}</span>
                    </div>
                    ${(relatedSale.discount_amount || relatedSale.discount) ? `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: var(--success-color);">
                        <span>ÿßŸÑÿÆÿµŸÖ:</span>
                        <span style="font-weight: bold;">-${formatCurrency(relatedSale.discount_amount || relatedSale.discount || 0)}</span>
                    </div>
                    ` : ''}
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span>ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©:</span>
                        <span style="font-weight: bold;">${formatCurrency(relatedSale.tax_amount || relatedSale.tax || 0)}</span>
                    </div>
                    ${relatedSale.additional_amount ? `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; color: var(--warning-color);">
                        <span>ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ∂ÿßŸÅŸä (ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑):</span>
                        <span style="font-weight: bold;">+${formatCurrency(relatedSale.additional_amount)}</span>
                    </div>
                    ` : ''}
                    <div style="display: flex; justify-content: space-between; padding-top: 15px; border-top: 2px solid var(--primary-color); font-size: 20px; font-weight: bold; color: var(--primary-color);">
                        <span>ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÜŸáÿßÿ¶Ÿä:</span>
                        <span>${formatCurrency(relatedSale.final_total || 0)}</span>
                    </div>
                </div>
            `;
        }
        
        // ÿπÿ±ÿ∂ ÿ¨ÿØŸàŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
        function renderInstallmentsTable(debt, relatedSale) {
            const tbody = document.getElementById('installmentsTableBody');
            if (!tbody) return;
            
            console.log('Installments table - Debt:', debt);
            console.log('Installments table - Related Sale:', relatedSale);
            
            const months = debt.installment_months || relatedSale?.installment_months || 12;
            let monthlyAmount = debt.monthly_amount || relatedSale?.monthly_amount || 0;
            const totalAmount = debt.total_amount || relatedSale?.final_total || debt.remaining_amount || 0;
            
            // ÿ•ÿ∞ÿß ŸÉÿßŸÜ monthlyAmount Ÿäÿ≥ÿßŸàŸä 0ÿå ÿßÿ≠ÿ≥ÿ®Ÿá ŸÖŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
            if (monthlyAmount === 0 && totalAmount > 0) {
                monthlyAmount = totalAmount / months;
            }
            
            console.log('Months:', months, 'Monthly Amount:', monthlyAmount, 'Total:', totalAmount);
            
            // ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿµŸÅŸàŸÅÿ© ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿ£Ÿà ÿßÿ≥ÿ™ÿ±ÿ¨ÿßÿπŸáÿß ŸÖŸÜ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            let installments = debt.installments || [];
            
            // ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿ©ÿå ÿ•ŸÜÿ¥ÿßÿ§Ÿáÿß
            if (installments.length === 0) {
                const startDate = new Date(debt.timestamp || relatedSale?.timestamp);
                for (let i = 0; i < months; i++) {
                    const dueDate = new Date(startDate);
                    dueDate.setMonth(dueDate.getMonth() + i + 1);
                    
                    installments.push({
                        month: i + 1,
                        due_date: dueDate.toISOString(),
                        amount: monthlyAmount,
                        status: 'pending',
                        paid_date: null
                    });
                }
            }
            
            const now = new Date();
            tbody.innerHTML = installments.map(inst => {
                const dueDate = new Date(inst.due_date);
                const isPaid = inst.status === 'paid';
                const isOverdue = dueDate < now && !isPaid;
                
                let statusClass = 'installment-status pending';
                let statusText = 'ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±';
                let statusIcon = 'clock';
                
                if (isPaid) {
                    statusClass = 'installment-status paid';
                    statusText = 'ŸÖÿ≥ÿØÿØ';
                    statusIcon = 'check-circle';
                } else if (isOverdue) {
                    statusClass = 'installment-status overdue';
                    statusText = 'ŸÖÿ™ÿ£ÿÆÿ±';
                    statusIcon = 'exclamation-triangle';
                }
                
                return `
                    <tr>
                        <td><strong>ÿßŸÑÿ¥Ÿáÿ± ${inst.month}</strong></td>
                        <td>${dueDate.toLocaleDateString('ar-IQ')}</td>
                        <td style="font-weight: bold; color: var(--primary-color);">${formatCurrency(inst.amount)}</td>
                        <td>
                            <span class="${statusClass}">
                                <i class="fas fa-${statusIcon}"></i> ${statusText}
                            </span>
                        </td>
                        <td>${inst.paid_date ? new Date(inst.paid_date).toLocaleDateString('ar-IQ') : '-'}</td>
                        <td>
                            ${!isPaid ? `
                                <button class="payment-btn" onclick="payInstallment('${debt.id || debt.__backendId}', ${inst.month})">
                                    <i class="fas fa-money-check-alt"></i> ÿ™ÿ≥ÿØŸäÿØ
                                </button>
                            ` : `
                                <span style="color: var(--success-color); font-weight: bold;">
                                    <i class="fas fa-check-double"></i> ŸÖÿ≥ÿØÿØ
                                </span>
                            `}
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        // ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑ ÿßŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™
        function renderPaymentsHistory(debt) {
            const tbody = document.getElementById('paymentsHistoryBody');
            if (!tbody) return;
            
            const payments = debt.payments || [];
            
            if (payments.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px; color: var(--theme-text-secondary);">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ™ÿ≥ÿØŸäÿØÿßÿ™ ÿ≠ÿ™Ÿâ ÿßŸÑÿ¢ŸÜ</td></tr>';
                return;
            }
            
            tbody.innerHTML = payments.map(payment => `
                <tr>
                    <td>${new Date(payment.date).toLocaleString('ar-IQ')}</td>
                    <td style="font-weight: bold; color: var(--success-color);">${formatCurrency(payment.amount)}</td>
                    <td><strong>ÿßŸÑÿ¥Ÿáÿ± ${payment.month}</strong></td>
                    <td>${payment.notes || '-'}</td>
                </tr>
            `).join('');
        }
        
        // ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿØŸäÿØ ŸÇÿ≥ÿ∑ ÿ¥Ÿáÿ±Ÿä
        function payInstallment(debtId, monthNumber) {
            const debt = debtsData.find(d => 
                d.id == debtId || 
                d.__backendId == debtId || 
                d.debt_id == debtId
            );
            
            if (!debt) {
                showToast('ÿßŸÑÿØŸäŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ÿ•ÿ∞ÿß ŸÑŸÖ ÿ™ŸÉŸÜ ŸÖŸàÿ¨ŸàÿØÿ©
            const relatedSale = salesData.find(s => s.invoice_id === debt.invoice_id);
            
            if (!debt.installments || debt.installments.length === 0) {
                const months = debt.installment_months || relatedSale?.installment_months || 12;
                let monthlyAmount = debt.monthly_amount || relatedSale?.monthly_amount || 0;
                
                // ÿ•ÿ∞ÿß ŸÉÿßŸÜ monthlyAmount Ÿäÿ≥ÿßŸàŸä 0ÿå ÿßÿ≠ÿ≥ÿ®Ÿá ŸÖŸÜ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä
                if (monthlyAmount === 0) {
                    const totalAmount = debt.total_amount || debt.remaining_amount || relatedSale?.final_total || 0;
                    monthlyAmount = totalAmount / months;
                }
                
                console.log('Creating installments - Months:', months, 'Monthly Amount:', monthlyAmount);
                
                debt.installments = [];
                const startDate = new Date(debt.timestamp || relatedSale?.timestamp);
                for (let i = 0; i < months; i++) {
                    const dueDate = new Date(startDate);
                    dueDate.setMonth(dueDate.getMonth() + i + 1);
                    
                    debt.installments.push({
                        month: i + 1,
                        due_date: dueDate.toISOString(),
                        amount: monthlyAmount,
                        status: 'pending',
                        paid_date: null
                    });
                }
            }
            
            // ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÇÿ≥ÿ∑
            const installment = debt.installments.find(inst => inst.month === monthNumber);
            if (!installment) {
                showToast('ÿßŸÑŸÇÿ≥ÿ∑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            if (installment.status === 'paid') {
                showToast('Ÿáÿ∞ÿß ÿßŸÑŸÇÿ≥ÿ∑ ŸÖÿ≥ÿØÿØ ÿ®ÿßŸÑŸÅÿπŸÑ', 'info');
                return;
            }
            
            console.log('Installment to pay:', installment);
            
            // ÿ≠ŸÅÿ∏ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ≠ÿßŸÑŸä
            currentInstallmentDebtId = debtId;
            currentInstallmentMonth = monthNumber;
            
            // ŸÖŸÑÿ° ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
            document.getElementById('installmentMonthDisplay').value = `ÿßŸÑÿ¥Ÿáÿ± ${monthNumber}`;
            document.getElementById('installmentAmountDisplay').value = formatCurrency(installment.amount);
            document.getElementById('installmentNotes').value = '';
            
            // ŸÅÿ™ÿ≠ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
            showModal('payInstallmentModal');
        }
        
        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä
        async function handlePayInstallment(event) {
            event.preventDefault();
            
            const notes = document.getElementById('installmentNotes').value.trim();
            
            const debt = debtsData.find(d => 
                d.id == currentInstallmentDebtId || 
                d.__backendId == currentInstallmentDebtId || 
                d.debt_id == currentInstallmentDebtId
            );
            
            if (!debt) {
                showToast('ÿßŸÑÿØŸäŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿßŸÑŸÇÿ≥ÿ∑
            const installment = debt.installments.find(inst => inst.month === currentInstallmentMonth);
            if (!installment) {
                showToast('ÿßŸÑŸÇÿ≥ÿ∑ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÇÿ≥ÿ∑
            installment.status = 'paid';
            installment.paid_date = new Date().toISOString();
            installment.paid_amount = installment.amount;
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ≥ÿ¨ŸÑ ŸÑŸÑÿ™ÿ≥ÿØŸäÿØÿßÿ™
            if (!debt.payments) {
                debt.payments = [];
            }
            
            debt.payments.push({
                date: new Date().toISOString(),
                amount: installment.amount,
                month: currentInstallmentMonth,
                notes: notes || `ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä ÿ±ŸÇŸÖ ${currentInstallmentMonth}`
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä ŸàÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿØŸÅŸàÿπ
            const totalAmount = debt.total_amount || debt.final_total || 0;
            const currentPaid = debt.paid_amount || 0;
            debt.paid_amount = currentPaid + installment.amount;
            
            const currentRemaining = debt.remaining_amount !== undefined ? debt.remaining_amount : totalAmount;
            debt.remaining_amount = currentRemaining - installment.amount;
            if (debt.remaining_amount < 0) debt.remaining_amount = 0;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≠ÿßŸÑÿ© ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ≥ÿØÿßÿØ ŸÉŸÑ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑
            const allPaid = debt.installments.every(inst => inst.status === 'paid');
            if (allPaid) {
                debt.status = 'ŸÖÿ≥ÿØÿØ';
            }
            
            console.log('Payment processed - Paid:', debt.paid_amount, 'Remaining:', debt.remaining_amount);
            
            // ÿ≠ŸÅÿ∏ ŸÅŸä ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            if (window.dataSdk && debt.id) {
                await window.dataSdk.update(debt.id, {
                    installments: debt.installments,
                    payments: debt.payments,
                    remaining_amount: debt.remaining_amount,
                    paid_amount: debt.paid_amount,
                    total_amount: totalAmount,
                    status: debt.status
                });
                
                // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                const allData = await window.dataSdk.query();
                if (allData.isOk) {
                    debtsData = allData.data.filter(item => item.type === 'debt');
                    updateStatistics();
                    updateQuickStats();
                }
            }
            
            // ÿ•ÿ∫ŸÑÿßŸÇ ÿßŸÑŸÜÿßŸÅÿ∞ÿ© ÿßŸÑŸÖŸÜÿ®ÿ´ŸÇÿ©
            closeModal('payInstallmentModal');
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿπÿ±ÿ∂
            showToast('ÿ™ŸÖ ÿ™ÿ≥ÿØŸäÿØ ÿßŸÑŸÇÿ≥ÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
            showDebtDetails(currentInstallmentDebtId);
        }
        
        // ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿ™ÿ≥ÿØŸäÿØ ÿ≥ÿ±Ÿäÿπ ŸÖŸÜ ÿµŸÅÿ≠ÿ© ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ
        function showQuickPayModal(debtId) {
            const debt = debtsData.find(d => 
                d.id == debtId || 
                d.__backendId == debtId || 
                d.debt_id == debtId
            );
            
            if (!debt) {
                showToast('ÿßŸÑÿØŸäŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                return;
            }
            
            // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿ£ŸàŸÑ ŸÇÿ≥ÿ∑ ÿ∫Ÿäÿ± ŸÖÿØŸÅŸàÿπ
            let nextUnpaidInstallment = null;
            let nextUnpaidMonth = null;
            
            if (debt.installments && Array.isArray(debt.installments) && debt.installments.length > 0) {
                for (let inst of debt.installments) {
                    if (inst.status !== 'paid') {
                        nextUnpaidInstallment = inst;
                        nextUnpaidMonth = inst.month;
                        break;
                    }
                }
            }
            
            if (!nextUnpaidInstallment) {
                showToast('ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑ ŸÖÿ≥ÿØÿØÿ©', 'info');
                return;
            }
            
            // ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ™ÿ≥ÿØŸäÿØ ŸÑŸÑŸÇÿ≥ÿ∑ ÿ∫Ÿäÿ± ÿßŸÑŸÖÿØŸÅŸàÿπ
            payInstallment(debtId, nextUnpaidMonth);
        }
        
        // ÿ™ÿ£ŸÉŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ
        function confirmDeleteDebt(debtId, customerName) {
            // ÿ≠ŸÅÿ∏ ŸÖÿπÿ±ŸÅ ÿßŸÑÿØŸäŸÜ
            debtToDelete = debtId;
            
            // ÿπÿ±ÿ∂ ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ ŸÅŸä ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
            document.getElementById('deleteDebtCustomerName').textContent = customerName;
            
            // ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ÿßŸÑÿ™ÿ£ŸÉŸäÿØ
            showModal('confirmDeleteModal');
        }
        
        // ÿ™ŸÜŸÅŸäÿ∞ ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ ÿ®ÿπÿØ ÿßŸÑÿ™ÿ£ŸÉŸäÿØ
        function executeDeleteDebt() {
            if (debtToDelete) {
                closeModal('confirmDeleteModal');
                deleteDebt(debtToDelete);
                debtToDelete = null;
            }
        }
        
        // ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ
        async function deleteDebt(debtId) {
            try {
                const debt = debtsData.find(d => 
                    d.id == debtId || 
                    d.__backendId == debtId || 
                    d.debt_id == debtId
                );
                
                if (!debt) {
                    showToast('ÿßŸÑÿØŸäŸÜ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ', 'error');
                    return;
                }
                
                // ÿ≠ÿ∞ŸÅ ŸÖŸÜ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                if (window.dataSdk && (debt.id || debt.__backendId)) {
                    const deleteId = debt.id || debt.__backendId;
                    const result = await window.dataSdk.delete(deleteId);
                    
                    if (result.isOk) {
                        // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
                        const allData = await window.dataSdk.query();
                        if (allData.isOk) {
                            debtsData = allData.data.filter(item => item.type === 'debt');
                            
                            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                            renderDebtsTable();
                            updateStatistics();
                            updateQuickStats();
                            
                            showToast('ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                        }
                    } else {
                        showToast('ŸÅÿ¥ŸÑ ŸÅŸä ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ', 'error');
                    }
                } else {
                    showToast('ŸÑÿß ŸäŸÖŸÉŸÜ ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ', 'error');
                }
            } catch (error) {
                console.error('Error deleting debt:', error);
                showToast('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ≠ÿ∞ŸÅ ÿßŸÑÿØŸäŸÜ', 'error');
            }
        }
        
        // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ÿßŸÑÿ≥ÿ±Ÿäÿπ ŸÅŸä ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ
        function filterPOSProducts() {
            renderProducts();
        }
        
        // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±
        function filterInvoices() {
            renderInvoicesTable();
        }
        
        // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™
        function filterProducts() {
            renderProductsTable();
        }
        
        // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ
        function filterInventory() {
            renderInventoryTable();
        }
        
        // ÿØÿßŸÑÿ© ÿßŸÑÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑÿØŸäŸàŸÜ
        function filterDebts() {
            renderDebtsTable();
        }
        
        function showPayDebtModal(debtId) {
            console.log('Show pay debt modal:', debtId);
        }

        function handlePayDebt(event) {
            event.preventDefault();
            console.log('Handle pay debt');
        }

        // ÿßŸÑÿ™ŸÜŸÇŸÑ ÿ•ŸÑŸâ ÿµŸÅÿ≠ÿßÿ™ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÅÿ±ÿπŸäÿ©
        function showSettingsPage(pageName) {
            // ÿ•ÿÆŸÅÿßÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿµŸÅÿ≠ÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
                page.style.display = ''; // ÿ•ÿ≤ÿßŸÑÿ© inline style
            });
            
            // ÿ•ÿ∏Ÿáÿßÿ± ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©
            const targetPage = document.getElementById(`settings-${pageName}`);
            if (targetPage) {
                targetPage.style.display = ''; // ÿ•ÿ≤ÿßŸÑÿ© inline style
                targetPage.classList.add('active');
                setTimeout(() => {
                    targetPage.classList.add('animate__animated', 'animate__fadeIn');
                }, 10);
            }
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±
        function saveStoreSettings() {
            const storeSettings = {
                storeName: document.getElementById('settingsStoreName')?.value || '',
                ownerName: document.getElementById('settingsOwnerName')?.value || '',
                commercialReg: document.getElementById('settingsCommercialReg')?.value || '',
                taxNumber: document.getElementById('settingsTaxNumber')?.value || '',
                address: document.getElementById('settingsStoreAddress')?.value || '',
                phone1: document.getElementById('settingsStorePhone1')?.value || '',
                phone2: document.getElementById('settingsStorePhone2')?.value || '',
                email: document.getElementById('settingsStoreEmail')?.value || '',
                whatsapp: document.getElementById('settingsWhatsapp')?.value || '',
                website: document.getElementById('settingsWebsite')?.value || '',
                taxRate: parseFloat(document.getElementById('settingsTaxRate')?.value) || 0,
                currency: document.getElementById('settingsDefaultCurrency')?.value || 'IQD',
                minDebtAmount: parseFloat(document.getElementById('settingsMinDebtAmount')?.value) || 0,
                openTime: document.getElementById('settingsOpenTime')?.value || '09:00',
                closeTime: document.getElementById('settingsCloseTime')?.value || '22:00',
                closedFriday: document.getElementById('closedFriday')?.checked || false,
                closedSaturday: document.getElementById('closedSaturday')?.checked || false
            };

            // ŸÖÿπÿßŸÑÿ¨ÿ© ÿ±ŸÅÿπ ÿßŸÑÿ¥ÿπÿßÿ±
            const logoInput = document.getElementById('settingsStoreLogo');
            if (logoInput && logoInput.files && logoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    storeSettings.logo = e.target.result;
                    localStorage.setItem('storeSettings', JSON.stringify(storeSettings));
                    applyStoreSettings(storeSettings);
                    showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                };
                reader.readAsDataURL(logoInput.files[0]);
            } else {
                const savedSettings = JSON.parse(localStorage.getItem('storeSettings') || '{}');
                if (savedSettings.logo) {
                    storeSettings.logo = savedSettings.logo;
                }
                localStorage.setItem('storeSettings', JSON.stringify(storeSettings));
                applyStoreSettings(storeSettings);
                showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
            }
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ± ÿπŸÑŸâ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
        function applyStoreSettings(settings) {
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßÿ≥ŸÖ ÿßŸÑŸÖÿ™ÿ¨ÿ± ŸÅŸä ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ŸÖÿßŸÉŸÜ
            document.querySelectorAll('.store-name-display').forEach(el => {
                el.textContent = settings.storeName || 'ÿßŸÑŸÖÿ™ÿ¨ÿ±';
            });
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ¥ÿπÿßÿ±
            if (settings.logo) {
                document.querySelectorAll('.store-logo').forEach(img => {
                    img.src = settings.logo;
                });
            }
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿπŸÖŸÑÿ© ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
            window.currentCurrency = settings.currency || 'IQD';
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ŸÜÿ≥ÿ®ÿ© ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©
            window.defaultTaxRate = settings.taxRate || 0;
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑÿØŸäŸÜ
            window.minDebtAmount = settings.minDebtAmount || 0;
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ™ÿ¨ÿ±
        function loadStoreSettings() {
            const savedSettings = localStorage.getItem('storeSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (document.getElementById('settingsStoreName')) document.getElementById('settingsStoreName').value = settings.storeName || '';
                if (document.getElementById('settingsOwnerName')) document.getElementById('settingsOwnerName').value = settings.ownerName || '';
                if (document.getElementById('settingsCommercialReg')) document.getElementById('settingsCommercialReg').value = settings.commercialReg || '';
                if (document.getElementById('settingsTaxNumber')) document.getElementById('settingsTaxNumber').value = settings.taxNumber || '';
                if (document.getElementById('settingsStoreAddress')) document.getElementById('settingsStoreAddress').value = settings.address || '';
                if (document.getElementById('settingsStorePhone1')) document.getElementById('settingsStorePhone1').value = settings.phone1 || '';
                if (document.getElementById('settingsStorePhone2')) document.getElementById('settingsStorePhone2').value = settings.phone2 || '';
                if (document.getElementById('settingsStoreEmail')) document.getElementById('settingsStoreEmail').value = settings.email || '';
                if (document.getElementById('settingsWhatsapp')) document.getElementById('settingsWhatsapp').value = settings.whatsapp || '';
                if (document.getElementById('settingsWebsite')) document.getElementById('settingsWebsite').value = settings.website || '';
                if (document.getElementById('settingsTaxRate')) document.getElementById('settingsTaxRate').value = settings.taxRate || 0;
                if (document.getElementById('settingsDefaultCurrency')) document.getElementById('settingsDefaultCurrency').value = settings.currency || 'IQD';
                if (document.getElementById('settingsMinDebtAmount')) document.getElementById('settingsMinDebtAmount').value = settings.minDebtAmount || 0;
                if (document.getElementById('settingsOpenTime')) document.getElementById('settingsOpenTime').value = settings.openTime || '09:00';
                if (document.getElementById('settingsCloseTime')) document.getElementById('settingsCloseTime').value = settings.closeTime || '22:00';
                if (document.getElementById('closedFriday')) document.getElementById('closedFriday').checked = settings.closedFriday || false;
                if (document.getElementById('closedSaturday')) document.getElementById('closedSaturday').checked = settings.closedSaturday || false;
                
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
                applyStoreSettings(settings);
            }
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ
        function saveSystemSettings() {
            const systemSettings = {
                theme: document.getElementById('themeSelect')?.value || 'dark',
                colorScheme: document.getElementById('colorSchemeSelect')?.value || 'default',
                fontSize: document.getElementById('fontSizeSelect')?.value || 'medium',
                compactMode: document.getElementById('compactModeCheck')?.checked || false,
                language: document.getElementById('languageSelect')?.value || 'ar',
                dateFormat: document.getElementById('dateFormatSelect')?.value || 'DD/MM/YYYY',
                timeFormat: document.getElementById('timeFormatSelect')?.value || '12',
                itemsPerPage: document.getElementById('itemsPerPageSelect')?.value || 25,
                animations: document.getElementById('animationsCheck')?.checked !== false,
                autosave: document.getElementById('autosaveCheck')?.checked !== false,
                barcodeSound: document.getElementById('barcodeSound')?.checked !== false,
                autoPrint: document.getElementById('autoPrint')?.checked || false,
                clearCartAfterSale: document.getElementById('clearCartAfterSale')?.checked !== false
            };

            localStorage.setItem('systemSettings', JSON.stringify(systemSettings));
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸàÿ±ÿßŸã
            applySystemSettings(systemSettings);
            
            showToast('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ
        function applySystemSettings(settings) {
            console.log('‚öôÔ∏è ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ:', settings);
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ´ŸäŸÖ
            applyTheme(settings.theme || 'dark');
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ
            if (settings.colorScheme) {
                const colors = colorSchemes[settings.colorScheme] || colorSchemes.default;
                applyCustomColors(colors);
            } else {
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿÆÿµÿµÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ©
                const savedColors = localStorage.getItem('customColors');
                if (savedColors) {
                    applyCustomColors(JSON.parse(savedColors));
                }
            }
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆÿ∑
            applyFontSize(settings.fontSize || 'medium');
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÑÿ∫ÿ©
            applyLanguage(settings.language || 'ar');
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿ∂ÿ∫Ÿàÿ∑
            if (settings.compactMode) {
                document.body.classList.add('compact-mode');
                console.log('üì¶ ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿ∂ÿ∫Ÿàÿ∑');
            } else {
                document.body.classList.remove('compact-mode');
                console.log('üì¶ ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÖÿ∂ÿ∫Ÿàÿ∑');
            }
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©
            if (!settings.animations) {
                document.body.classList.add('no-animations');
                console.log('üé¨ ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©');
            } else {
                document.body.classList.remove('no-animations');
                console.log('üé¨ ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑŸÖÿ™ÿ≠ÿ±ŸÉÿ©');
            }
            
            console.log('‚úÖ ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ¨ŸÖŸäÿπ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿ®ŸÜÿ¨ÿßÿ≠');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ´ŸäŸÖ
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('currentTheme', theme);
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿÆŸÑŸÅŸäÿ©
            const animatedBg = document.querySelector('.animated-bg');
            if (animatedBg) {
                if (theme === 'light') {
                    animatedBg.style.background = 'var(--theme-bg-primary)';
                } else {
                    animatedBg.style.background = 'var(--theme-bg-primary)';
                }
            }
            
            console.log('üé® ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ´ŸäŸÖ:', theme);
        }

        // Ÿàÿ∏ŸäŸÅÿ© ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ´ŸäŸÖ ŸÖŸÜ ÿßŸÑŸÇÿßÿ¶ŸÖÿ©
        function changeTheme(theme) {
            applyTheme(theme);
            
            const themeNames = {
                'dark': 'üåô ÿßŸÑÿØÿßŸÉŸÜ ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸä',
                'light': '‚òÄÔ∏è ÿßŸÑŸÅÿßÿ™ÿ≠ ÿßŸÑŸÉŸÑÿßÿ≥ŸäŸÉŸä',
                'blue-dark': 'üîµ ÿßŸÑÿ£ÿ≤ÿ±ŸÇ ÿßŸÑÿØÿßŸÉŸÜ',
                'green-dark': 'üíö ÿßŸÑÿ£ÿÆÿ∂ÿ± ÿßŸÑÿØÿßŸÉŸÜ',
                'orange-dark': 'üß° ÿßŸÑÿ®ÿ±ÿ™ŸÇÿßŸÑŸä ÿßŸÑÿØÿßŸÉŸÜ',
                'purple-dark': 'üíú ÿßŸÑÿ®ŸÜŸÅÿ≥ÿ¨Ÿä ÿßŸÑÿØÿßŸÉŸÜ',
                'red-dark': '‚ù§Ô∏è ÿßŸÑÿ£ÿ≠ŸÖÿ± ÿßŸÑÿØÿßŸÉŸÜ',
                'cyan-light': 'ü©µ ÿßŸÑÿ≥ŸÖÿßŸàŸä ÿßŸÑŸÅÿßÿ™ÿ≠',
                'gold-light': 'üü° ÿßŸÑÿ∞Ÿáÿ®Ÿä ÿßŸÑŸÅÿßÿ™ÿ≠',
                'pink-light': 'üå∏ ÿßŸÑŸàÿ±ÿØŸä ÿßŸÑŸÅÿßÿ™ÿ≠',
                'olive': 'üü¢ ÿßŸÑÿ≤Ÿäÿ™ŸàŸÜŸä',
                'royal-blue': 'üî¥ ÿßŸÑÿ£ÿ≤ÿ±ŸÇ ÿßŸÑŸÖŸÑŸÉŸä'
            };
            
            const themeName = themeNames[theme] || theme;
            showToast('‚ú® ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ∏Ÿáÿ±: ' + themeName, 'success');
        }

        // Ÿàÿ∏ŸäŸÅÿ© ÿßŸÑÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ≥ÿ±Ÿäÿπ ÿ®ŸäŸÜ ÿßŸÑÿ´ŸäŸÖÿßÿ™
        function toggleThemeQuick() {
            const themes = [
                'dark', 'light', 'blue-dark', 'green-dark', 'orange-dark', 
                'purple-dark', 'red-dark', 'cyan-light', 'gold-light', 
                'pink-light', 'olive', 'royal-blue'
            ];
            
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            const currentIndex = themes.indexOf(currentTheme);
            const nextIndex = (currentIndex + 1) % themes.length;
            const nextTheme = themes[nextIndex];
            
            changeTheme(nextTheme);
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖŸÜÿ≥ÿØŸÑÿ© ÿ•ÿ∞ÿß ŸÉÿßŸÜÿ™ ŸÖŸàÿ¨ŸàÿØÿ©
            const themeSelect = document.getElementById('themeSelect');
            if (themeSelect) {
                themeSelect.value = nextTheme;
            }
        }

        // ŸÖÿ¨ŸÖŸàÿπÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿ≠ÿØÿØÿ© ŸÖÿ≥ÿ®ŸÇÿßŸã
        const colorSchemes = {
            default: {
                primary: '#6366f1',
                secondary: '#8b5cf6',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#3b82f6'
            },
            blue: {
                primary: '#3b82f6',
                secondary: '#2563eb',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#0ea5e9'
            },
            green: {
                primary: '#10b981',
                secondary: '#059669',
                success: '#22c55e',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#3b82f6'
            },
            orange: {
                primary: '#f97316',
                secondary: '#ea580c',
                success: '#10b981',
                warning: '#fb923c',
                danger: '#ef4444',
                info: '#3b82f6'
            },
            red: {
                primary: '#ef4444',
                secondary: '#dc2626',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#f87171',
                info: '#3b82f6'
            },
            purple: {
                primary: '#a855f7',
                secondary: '#9333ea',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#3b82f6'
            },
            cyan: {
                primary: '#06b6d4',
                secondary: '#0891b2',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#0ea5e9'
            },
            amber: {
                primary: '#f59e0b',
                secondary: '#d97706',
                success: '#10b981',
                warning: '#fbbf24',
                danger: '#ef4444',
                info: '#3b82f6'
            },
            teal: {
                primary: '#14b8a6',
                secondary: '#0d9488',
                success: '#10b981',
                warning: '#f59e0b',
                danger: '#ef4444',
                info: '#3b82f6'
            }
        };

        // ŸÖÿπÿßŸäŸÜÿ© ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ
        function previewColorScheme(scheme) {
            const colors = colorSchemes[scheme] || colorSchemes.default;
            applyCustomColors(colors);
            showToast('ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ŸÖÿ¨ŸÖŸàÿπÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ: ' + scheme, 'success');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿÆÿµÿµÿ©
        function applyCustomColors(colors) {
            const root = document.documentElement;
            
            root.style.setProperty('--primary-color', colors.primary);
            root.style.setProperty('--secondary-color', colors.secondary);
            root.style.setProperty('--success-color', colors.success);
            root.style.setProperty('--warning-color', colors.warning);
            root.style.setProperty('--danger-color', colors.danger);
            root.style.setProperty('--info-color', colors.info);
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ™ÿØÿ±ÿ¨ÿßÿ™
            root.style.setProperty('--primary-gradient', `linear-gradient(135deg, ${colors.primary} 0%, ${colors.secondary} 100%)`);
            root.style.setProperty('--success-gradient', `linear-gradient(135deg, ${colors.success} 0%, ${adjustColor(colors.success, -20)} 100%)`);
            root.style.setProperty('--warning-gradient', `linear-gradient(135deg, ${colors.warning} 0%, ${adjustColor(colors.warning, -20)} 100%)`);
            root.style.setProperty('--danger-gradient', `linear-gradient(135deg, ${colors.danger} 0%, ${adjustColor(colors.danger, -20)} 100%)`);
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ŸÇŸàŸÑ ÿßŸÑÿ£ŸÑŸàÿßŸÜ
            updateColorInputs(colors);
            
            // ÿ≠ŸÅÿ∏ ŸÅŸä localStorage
            localStorage.setItem('customColors', JSON.stringify(colors));
            
            console.log('üé® ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑŸÖÿÆÿµÿµÿ©:', colors);
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ŸÇŸàŸÑ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ£ŸÑŸàÿßŸÜ
        function updateColorInputs(colors) {
            if (document.getElementById('primaryColorPicker')) {
                document.getElementById('primaryColorPicker').value = colors.primary;
                document.getElementById('primaryColorInput').value = colors.primary;
            }
            if (document.getElementById('secondaryColorPicker')) {
                document.getElementById('secondaryColorPicker').value = colors.secondary;
                document.getElementById('secondaryColorInput').value = colors.secondary;
            }
            if (document.getElementById('successColorPicker')) {
                document.getElementById('successColorPicker').value = colors.success;
                document.getElementById('successColorInput').value = colors.success;
            }
            if (document.getElementById('warningColorPicker')) {
                document.getElementById('warningColorPicker').value = colors.warning;
                document.getElementById('warningColorInput').value = colors.warning;
            }
            if (document.getElementById('dangerColorPicker')) {
                document.getElementById('dangerColorPicker').value = colors.danger;
                document.getElementById('dangerColorInput').value = colors.danger;
            }
            if (document.getElementById('infoColorPicker')) {
                document.getElementById('infoColorPicker').value = colors.info;
                document.getElementById('infoColorInput').value = colors.info;
            }
        }

        // Ÿàÿ∏ŸäŸÅÿ© ŸÖÿ≥ÿßÿπÿØÿ© ŸÑÿ™ÿπÿØŸäŸÑ ÿ≥ÿ∑Ÿàÿπ ÿßŸÑŸÑŸàŸÜ
        function adjustColor(color, amount) {
            const num = parseInt(color.replace('#', ''), 16);
            const r = Math.max(0, Math.min(255, (num >> 16) + amount));
            const g = Math.max(0, Math.min(255, ((num >> 8) & 0x00FF) + amount));
            const b = Math.max(0, Math.min(255, (num & 0x0000FF) + amount));
            return '#' + ((r << 16) | (g << 8) | b).toString(16).padStart(6, '0');
        }

        // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
        function resetDefaultColors() {
            if (confirm('ŸáŸÑ ÿ™ÿ±ŸäÿØ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©ÿü')) {
                applyCustomColors(colorSchemes.default);
                const colorSchemeSelect = document.getElementById('colorSchemeSelect');
                if (colorSchemeSelect) colorSchemeSelect.value = 'default';
                showToast('‚úÖ ÿ™ŸÖ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑÿ£ŸÑŸàÿßŸÜ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©', 'success');
            }
        }

        // ÿ•ÿπÿØÿßÿØ ŸÖÿπÿßŸÑÿ¨ÿßÿ™ ÿ™ÿ∫ŸäŸäÿ± ÿßŸÑÿ£ŸÑŸàÿßŸÜ
        function setupColorPickers() {
            // ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
            ['primaryColorPicker', 'primaryColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('primaryColorPicker').value = value;
                        document.getElementById('primaryColorInput').value = value;
                        updateSingleColor('primary', value);
                    });
                }
            });

            // ÿßŸÑŸÑŸàŸÜ ÿßŸÑÿ´ÿßŸÜŸàŸä
            ['secondaryColorPicker', 'secondaryColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('secondaryColorPicker').value = value;
                        document.getElementById('secondaryColorInput').value = value;
                        updateSingleColor('secondary', value);
                    });
                }
            });

            // ŸÑŸàŸÜ ÿßŸÑŸÜÿ¨ÿßÿ≠
            ['successColorPicker', 'successColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('successColorPicker').value = value;
                        document.getElementById('successColorInput').value = value;
                        updateSingleColor('success', value);
                    });
                }
            });

            // ŸÑŸàŸÜ ÿßŸÑÿ™ÿ≠ÿ∞Ÿäÿ±
            ['warningColorPicker', 'warningColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('warningColorPicker').value = value;
                        document.getElementById('warningColorInput').value = value;
                        updateSingleColor('warning', value);
                    });
                }
            });

            // ŸÑŸàŸÜ ÿßŸÑÿÆÿ∑ÿ±
            ['dangerColorPicker', 'dangerColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('dangerColorPicker').value = value;
                        document.getElementById('dangerColorInput').value = value;
                        updateSingleColor('danger', value);
                    });
                }
            });

            // ŸÑŸàŸÜ ÿßŸÑŸÖÿπŸÑŸàŸÖÿßÿ™
            ['infoColorPicker', 'infoColorInput'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        const value = this.value;
                        document.getElementById('infoColorPicker').value = value;
                        document.getElementById('infoColorInput').value = value;
                        updateSingleColor('info', value);
                    });
                }
            });
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÑŸàŸÜ Ÿàÿßÿ≠ÿØ
        function updateSingleColor(colorType, value) {
            const root = document.documentElement;
            root.style.setProperty(`--${colorType}-color`, value);
            
            // ÿ≠ŸÅÿ∏ ŸÅŸä localStorage
            const savedColors = JSON.parse(localStorage.getItem('customColors') || '{}');
            savedColors[colorType] = value;
            localStorage.setItem('customColors', JSON.stringify(savedColors));
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆÿ∑
        function applyFontSize(size) {
            const root = document.documentElement;
            switch(size) {
                case 'small':
                    root.style.fontSize = '13px';
                    break;
                case 'large':
                    root.style.fontSize = '17px';
                    break;
                default: // medium
                    root.style.fontSize = '15px';
            }
            console.log('üìê ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ≠ÿ¨ŸÖ ÿßŸÑÿÆÿ∑:', size);
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÑÿ∫ÿ©
        function applyLanguage(lang) {
            // ÿ≠ŸÅÿ∏ ÿßŸÑŸÑÿ∫ÿ© ÿßŸÑÿ≠ÿßŸÑŸäÿ©
            localStorage.setItem('currentLanguage', lang);
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿßÿ™ÿ¨ÿßŸá
            if (lang === 'ar' || lang === 'ku') {
                document.documentElement.setAttribute('dir', 'rtl');
                document.body.classList.add('rtl');
                document.body.classList.remove('ltr');
            } else {
                document.documentElement.setAttribute('dir', 'ltr');
                document.body.classList.add('ltr');
                document.body.classList.remove('rtl');
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÜÿµŸàÿµ ÿ≠ÿ≥ÿ® ÿßŸÑŸÑÿ∫ÿ©
            updateUILanguage(lang);
        }

        // ÿ™ÿ≠ÿØŸäÿ´ ŸÜÿµŸàÿµ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
        function updateUILanguage(lang) {
            const translations = {
                ar: {
                    // ÿßŸÑŸÇŸàÿßÿ¶ŸÖ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
                    pos: 'ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ',
                    products: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™',
                    inventory: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿÆÿ≤ŸÜ',
                    invoices: 'ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±',
                    debts: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿØŸäŸàŸÜ',
                    printer: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿ©',
                    settings: 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©',
                    
                    // ŸÜŸÇÿ∑ÿ© ÿßŸÑÿ®Ÿäÿπ
                    search: 'ÿ®ÿ≠ÿ´ ÿπŸÜ ŸÖŸÜÿ™ÿ¨...',
                    total: 'ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä',
                    discount: 'ÿßŸÑÿÆÿµŸÖ',
                    finalTotal: 'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÜŸáÿßÿ¶Ÿä',
                    checkout: 'ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ®Ÿäÿπ',
                    clearCart: 'ŸÖÿ≥ÿ≠ ÿßŸÑÿ≥ŸÑÿ©',
                    cart: 'ÿ≥ŸÑÿ© ÿßŸÑÿ™ÿ≥ŸàŸÇ',
                    addToCart: 'ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑÿ≥ŸÑÿ©',
                    
                    // ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ±
                    save: 'ÿ≠ŸÅÿ∏',
                    cancel: 'ÿ•ŸÑÿ∫ÿßÿ°',
                    delete: 'ÿ≠ÿ∞ŸÅ',
                    edit: 'ÿ™ÿπÿØŸäŸÑ',
                    add: 'ÿ•ÿ∂ÿßŸÅÿ©',
                    back: 'ÿ±ÿ¨Ÿàÿπ',
                    
                    // ÿßŸÑÿ≠ŸÇŸàŸÑ
                    name: 'ÿßŸÑÿßÿ≥ŸÖ',
                    price: 'ÿßŸÑÿ≥ÿπÿ±',
                    quantity: 'ÿßŸÑŸÉŸÖŸäÿ©',
                    category: 'ÿßŸÑŸÅÿ¶ÿ©',
                    barcode: 'ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ',
                    description: 'ÿßŸÑŸàÿµŸÅ'
                },
                en: {
                    // Main Menus
                    pos: 'Point of Sale',
                    products: 'Products Management',
                    inventory: 'Inventory Management',
                    invoices: 'Invoices',
                    debts: 'Debts Management',
                    printer: 'Printer Settings',
                    settings: 'General Settings',
                    
                    // Point of Sale
                    search: 'Search for product...',
                    total: 'Total',
                    discount: 'Discount',
                    finalTotal: 'Final Total',
                    checkout: 'Checkout',
                    clearCart: 'Clear Cart',
                    cart: 'Shopping Cart',
                    addToCart: 'Add to Cart',
                    
                    // Buttons
                    save: 'Save',
                    cancel: 'Cancel',
                    delete: 'Delete',
                    edit: 'Edit',
                    add: 'Add',
                    back: 'Back',
                    
                    // Fields
                    name: 'Name',
                    price: 'Price',
                    quantity: 'Quantity',
                    category: 'Category',
                    barcode: 'Barcode',
                    description: 'Description'
                },
                ku: {
                    // ŸÑ€åÿ≥ÿ™€å ÿ≥€ïÿ±€ï⁄©€å
                    pos: 'ÿÆÿß⁄µ€å ŸÅÿ±€Üÿ¥ÿ™ŸÜ',
                    products: 'ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ÿ®€ïÿ±Ÿá€ïŸÖ€ï⁄©ÿßŸÜ',
                    inventory: 'ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ⁄©€Ü⁄Øÿß',
                    invoices: 'Ÿà€ïÿ≥⁄µ€ï⁄©ÿßŸÜ',
                    debts: 'ÿ®€ï⁄ï€éŸà€ïÿ®ÿ±ÿØŸÜ€å ŸÇ€ïÿ±ÿ≤€ï⁄©ÿßŸÜ',
                    printer: '⁄ï€é⁄©ÿÆÿ≥ÿ™ŸÜ€å ⁄ÜÿßŸæ⁄©€ïÿ±',
                    settings: '⁄ï€é⁄©ÿÆÿ≥ÿ™ŸÜ€ï⁄©ÿßŸÜ€å ⁄Øÿ¥ÿ™€å',
                    
                    // ÿÆÿß⁄µ€å ŸÅÿ±€Üÿ¥ÿ™ŸÜ
                    search: '⁄Ø€ï⁄ïÿßŸÜ ÿ®€Ü ÿ®€ïÿ±Ÿá€ïŸÖ...',
                    total: '⁄©€Ü€å ⁄Øÿ¥ÿ™€å',
                    discount: 'ÿØÿßÿ¥⁄©ÿßŸÜÿØŸÜ',
                    finalTotal: '⁄©€Ü€å ⁄©€Üÿ™ÿß€å€å',
                    checkout: 'ÿ™€ïŸàÿßŸà⁄©ÿ±ÿØŸÜ€å ŸÅÿ±€Üÿ¥ÿ™ŸÜ',
                    clearCart: 'ÿ≥⁄ï€åŸÜ€ïŸà€ï€å ÿ≥€ïÿ®€ïÿ™€ï',
                    cart: 'ÿ≥€ïÿ®€ïÿ™€ï€å ⁄©⁄ï€åŸÜ',
                    addToCart: 'ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ ÿ®€Ü ÿ≥€ïÿ®€ïÿ™€ï',
                    
                    // ÿØŸà⁄ØŸÖ€ï⁄©ÿßŸÜ
                    save: 'Ÿæÿßÿ¥€ï⁄©€ïŸàÿ™⁄©ÿ±ÿØŸÜ',
                    cancel: 'Ÿá€ï⁄µŸà€ïÿ¥ÿßŸÜÿØŸÜ€ïŸà€ï',
                    delete: 'ÿ≥⁄ï€åŸÜ€ïŸà€ï',
                    edit: 'ÿØ€ïÿ≥ÿ™⁄©ÿßÿ±€å⁄©ÿ±ÿØŸÜ',
                    add: 'ÿ≤€åÿßÿØ⁄©ÿ±ÿØŸÜ',
                    back: '⁄Ø€ï⁄ïÿßŸÜ€ïŸà€ï',
                    
                    // ÿÆÿßŸÜ€ï⁄©ÿßŸÜ
                    name: 'ŸÜÿßŸà',
                    price: 'ŸÜÿ±ÿÆ',
                    quantity: 'ÿ®⁄ï',
                    category: 'ÿ¨€Üÿ±',
                    barcode: 'ÿ®ÿßÿ±⁄©€ÜÿØ',
                    description: 'Ÿà€ïÿ≥ŸÅ'
                }
            };
            
            const texts = translations[lang] || translations.ar;
            
            // ÿ™ÿ≠ÿØŸäÿ´ ÿπŸÜŸàÿßŸÜ ÿßŸÑÿµŸÅÿ≠ÿ© ÿßŸÑÿ≠ÿßŸÑŸä
            const titleElement = document.getElementById('currentPageTitle');
            if (titleElement) {
                const currentPage = document.querySelector('.page.active')?.id;
                if (currentPage && texts[currentPage]) {
                    titleElement.textContent = texts[currentPage];
                }
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÜÿµŸàÿµ ÿßŸÑŸÇŸàÿßÿ¶ŸÖ ÿßŸÑÿ¨ÿßŸÜÿ®Ÿäÿ©
            document.querySelectorAll('.nav-link').forEach(link => {
                const onclick = link.getAttribute('onclick');
                if (onclick) {
                    const pageMatch = onclick.match(/showPage\('([^']+)'\)/);
                    if (pageMatch && texts[pageMatch[1]]) {
                        const span = link.querySelector('span');
                        if (span) span.textContent = texts[pageMatch[1]];
                    }
                }
            });
            
            // ÿ™ÿ≠ÿØŸäÿ´ placeholder ÿ≠ŸÇŸÑ ÿßŸÑÿ®ÿ≠ÿ´
            const searchInput = document.getElementById('productSearchInput');
            if (searchInput && texts.search) {
                searchInput.placeholder = texts.search;
            }
            
            // ÿ™ÿ≠ÿØŸäÿ´ ŸÜÿµŸàÿµ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ¥ÿßÿ¶ÿπÿ©
            document.querySelectorAll('button').forEach(btn => {
                const text = btn.textContent.trim();
                if (text.includes('ÿ≠ŸÅÿ∏') || text.includes('Save')) {
                    const icon = btn.querySelector('i');
                    btn.innerHTML = '';
                    if (icon) btn.appendChild(icon.cloneNode(true));
                    btn.appendChild(document.createTextNode(' ' + texts.save));
                } else if (text.includes('ÿ•ŸÑÿ∫ÿßÿ°') || text.includes('Cancel')) {
                    const icon = btn.querySelector('i');
                    btn.innerHTML = '';
                    if (icon) btn.appendChild(icon.cloneNode(true));
                    btn.appendChild(document.createTextNode(' ' + texts.cancel));
                }
            });
            
            console.log('üåê ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÑÿ∫ÿ©:', lang);
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
        function saveNotificationSettings() {
            const notificationSettings = {
                lowStock: document.getElementById('lowStockNotifications')?.checked !== false,
                lowStockThreshold: document.getElementById('lowStockThreshold')?.value || 20,
                outOfStock: document.getElementById('outOfStockNotifications')?.checked !== false,
                expiry: document.getElementById('expiryNotifications')?.checked !== false,
                sales: document.getElementById('salesNotifications')?.checked !== false,
                largeSale: document.getElementById('largeSaleNotifications')?.checked || false,
                largeSaleAmount: document.getElementById('largeSaleAmount')?.value || 1000000,
                dailySalesReport: document.getElementById('dailySalesReport')?.checked !== false,
                debt: document.getElementById('debtNotifications')?.checked !== false,
                debtDue: document.getElementById('debtDueNotifications')?.checked !== false,
                debtDueDays: document.getElementById('debtDueDays')?.value || 3,
                overdueDebt: document.getElementById('overdueDebtNotifications')?.checked !== false,
                updates: document.getElementById('updateNotifications')?.checked !== false,
                backupReminders: document.getElementById('backupReminders')?.checked !== false,
                sound: document.getElementById('soundNotifications')?.checked !== false
            };

            localStorage.setItem('notificationSettings', JSON.stringify(notificationSettings));
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
            applyNotificationSettings(notificationSettings);
            
            showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
        function applyNotificationSettings(settings) {
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸä ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿπÿßŸÖÿ©
            window.notificationSettings = settings;
            
            // ÿ™ŸÅÿπŸäŸÑ/ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑÿ£ÿµŸàÿßÿ™
            window.soundEnabled = settings.sound !== false;
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
        function savePrintingSettings() {
            const printingSettings = {
                defaultPrinter: document.getElementById('defaultPrinterSelect')?.value || '',
                paperSize: document.getElementById('paperSizeSelect')?.value || '80mm',
                fontSize: document.getElementById('invoiceFontSize')?.value || 'medium',
                showLogo: document.getElementById('showLogoOnInvoice')?.checked !== false,
                showBarcode: document.getElementById('showBarcodeOnInvoice')?.checked !== false,
                showTax: document.getElementById('showTaxOnInvoice')?.checked !== false,
                footerNote: document.getElementById('invoiceFooterNote')?.value || '',
                autoPrint: document.getElementById('autoPrintInvoice')?.checked || false,
                printCopies: document.getElementById('printCopies')?.checked || false,
                openCashDrawer: document.getElementById('openCashDrawer')?.checked || false
            };

            localStorage.setItem('printingSettings', JSON.stringify(printingSettings));
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
            applyPrintingSettings(printingSettings);
            
            showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ© ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
        function applyPrintingSettings(settings) {
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸä ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿπÿßŸÖÿ©
            window.printingSettings = settings;
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ
        function saveSecuritySettings() {
            const securitySettings = {
                passwordEnabled: document.getElementById('enablePassword')?.checked || false,
                requirePasswordForDelete: document.getElementById('requirePasswordForDelete')?.checked !== false,
                requirePasswordForReports: document.getElementById('requirePasswordForReports')?.checked || false,
                requirePasswordForSettings: document.getElementById('requirePasswordForSettings')?.checked !== false,
                activityLogEnabled: document.getElementById('enableActivityLog')?.checked !== false,
                logRetentionPeriod: document.getElementById('logRetentionPeriod')?.value || 90
            };

            localStorage.setItem('securitySettings', JSON.stringify(securitySettings));
            
            // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ
            applySecuritySettings(securitySettings);
            
            showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿ™ÿ∑ÿ®ŸäŸÇ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ
        function applySecuritySettings(settings) {
            // ÿ≠ŸÅÿ∏ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸä ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿπÿßŸÖÿ©
            window.securitySettings = settings;
        }

        // ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä
        function saveBackupSettings() {
            const backupSettings = {
                autoBackupEnabled: document.getElementById('autoBackupEnabled')?.checked || false,
                frequency: document.getElementById('autoBackupFrequency')?.value || 'daily',
                location: document.getElementById('backupLocation')?.value || ''
            };

            localStorage.setItem('backupSettings', JSON.stringify(backupSettings));
            showToast('ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ŸÉÿßŸÖŸÑÿ©
        async function createFullBackup() {
            try {
                const backupData = {
                    version: '1.0.0',
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleString('ar-IQ'),
                    type: 'full',
                    data: {
                        products: products || [],
                        categories: categories || [],
                        suppliers: suppliers || [],
                        sales: salesData || [],
                        debts: debtsData || [],
                        settings: {
                            store: JSON.parse(localStorage.getItem('storeSettings') || '{}'),
                            system: JSON.parse(localStorage.getItem('systemSettings') || '{}'),
                            notifications: JSON.parse(localStorage.getItem('notificationSettings') || '{}'),
                            printing: JSON.parse(localStorage.getItem('printingSettings') || '{}'),
                            security: JSON.parse(localStorage.getItem('securitySettings') || '{}'),
                            backup: JSON.parse(localStorage.getItem('backupSettings') || '{}')
                        }
                    },
                    stats: {
                        totalProducts: (products || []).length,
                        totalCategories: (categories || []).length,
                        totalSuppliers: (suppliers || []).length,
                        totalSales: (salesData || []).length,
                        totalDebts: (debtsData || []).length
                    }
                };

                const dataStr = JSON.stringify(backupData, null, 2);
                const fileName = `ŸÜÿ≥ÿÆÿ©_ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©_ŸÉÿßŸÖŸÑÿ©_${new Date().toISOString().split('T')[0]}_${Date.now()}.json`;
                
                // ŸÖÿ≠ÿßŸàŸÑÿ© ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ Electron API ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÖÿ™ŸàŸÅÿ±ÿßŸã
                if (window.electronAPI && window.electronAPI.saveFile) {
                    const backupSettings = JSON.parse(localStorage.getItem('backupSettings') || '{}');
                    const result = await window.electronAPI.saveFile({
                        defaultPath: backupSettings.location || '',
                        fileName: fileName,
                        content: dataStr
                    });
                    
                    if (result.success) {
                        showToast('‚úÖ ÿ™ŸÖ ÿ≠ŸÅÿ∏ ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ŸÅŸä: ' + result.path, 'success');
                    } else {
                        throw new Error('Failed to save via Electron');
                    }
                } else {
                    // ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ÿßŸÑÿπÿßÿØŸäÿ©
                    const dataBlob = new Blob([dataStr], {type: 'application/json'});
                    const url = URL.createObjectURL(dataBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = fileName;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    showToast('‚úÖ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ÿßŸÑŸÉÿßŸÖŸÑÿ© ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                }
                
                console.log('üì¶ ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©:', backupData.stats);
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©:', error);
                showToast('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©', 'error');
            }
        }

        // ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÅŸÇÿ∑
        function createDataBackup() {
            try {
                const backupData = {
                    version: '1.0.0',
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleString('ar-IQ'),
                    type: 'data',
                    data: {
                        products: products || [],
                        categories: categories || [],
                        suppliers: suppliers || [],
                        sales: salesData || [],
                        debts: debtsData || []
                    },
                    stats: {
                        totalProducts: (products || []).length,
                        totalSales: (salesData || []).length,
                        totalDebts: (debtsData || []).length
                    }
                };

                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `ŸÜÿ≥ÿÆÿ©_ÿ®ŸäÿßŸÜÿßÿ™_${new Date().toISOString().split('T')[0]}_${Date.now()}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                showToast('‚úÖ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                console.log('üì¶ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:', backupData.stats);
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:', error);
                showToast('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ŸÜÿ≥ÿÆ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™', 'error');
            }
        }

        // ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸÅŸÇÿ∑
        function createSettingsBackup() {
            try {
                const backupData = {
                    version: '1.0.0',
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleString('ar-IQ'),
                    type: 'settings',
                    data: {
                        store: JSON.parse(localStorage.getItem('storeSettings') || '{}'),
                        system: JSON.parse(localStorage.getItem('systemSettings') || '{}'),
                        notifications: JSON.parse(localStorage.getItem('notificationSettings') || '{}'),
                        printing: JSON.parse(localStorage.getItem('printingSettings') || '{}'),
                        security: JSON.parse(localStorage.getItem('securitySettings') || '{}'),
                        backup: JSON.parse(localStorage.getItem('backupSettings') || '{}')
                    }
                };

                const dataStr = JSON.stringify(backupData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `ŸÜÿ≥ÿÆÿ©_ÿ•ÿπÿØÿßÿØÿßÿ™_${new Date().toISOString().split('T')[0]}_${Date.now()}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                showToast('‚úÖ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                console.log('üì¶ ÿ™ŸÖ ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™');
            } catch (error) {
                console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™:', error);
                showToast('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ŸÜÿ≥ÿÆ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™', 'error');
            }
        }

        // ÿßÿ≥ÿ™ÿπÿßÿØÿ© ŸÜÿ≥ÿÆÿ© ÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©
        function handleBackupRestore(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    if (confirm('ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßÿ≥ÿ™ÿπÿßÿØÿ© Ÿáÿ∞Ÿá ÿßŸÑŸÜÿ≥ÿÆÿ©ÿü ÿ≥Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ≠ÿßŸÑŸäÿ©!')) {
                        if (backupData.type === 'full' || backupData.type === 'data') {
                            if (backupData.data.products) products = backupData.data.products;
                            if (backupData.data.categories) categories = backupData.data.categories;
                            if (backupData.data.suppliers) suppliers = backupData.data.suppliers;
                            if (backupData.data.sales) salesData = backupData.data.sales;
                            if (backupData.data.debts) debtsData = backupData.data.debts;
                            
                            saveToLocalStorage();
                        }
                        
                        if (backupData.type === 'full' || backupData.type === 'settings') {
                            if (backupData.data.settings) {
                                Object.keys(backupData.data.settings).forEach(key => {
                                    localStorage.setItem(`${key}Settings`, JSON.stringify(backupData.data.settings[key]));
                                });
                            }
                        }
                        
                        showToast('ÿ™ŸÖ ÿßÿ≥ÿ™ÿπÿßÿØÿ© ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ© ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                        setTimeout(() => location.reload(), 1500);
                    }
                } catch (error) {
                    showToast('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ŸÖŸÑŸÅ ÿßŸÑŸÜÿ≥ÿÆÿ© ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿäÿ©', 'error');
                    console.error(error);
                }
            };
            reader.readAsText(file);
        }

        // ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ - ÿ≠ÿ∞ŸÅ ÿ¥ÿßŸÖŸÑ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
        async function confirmFactoryReset() {
            const confirmText = '‚ö†Ô∏è ÿ™ÿ≠ÿ∞Ÿäÿ± ÿÆÿ∑Ÿäÿ± ÿ¨ÿØÿßŸã!\n\n' +
                               '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n' +
                               'üóëÔ∏è ÿ≥Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅ:\n' +
                               '‚Ä¢ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸàÿßŸÑŸÅÿ¶ÿßÿ™\n' +
                               '‚Ä¢ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ\n' +
                               '‚Ä¢ ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖÿ®Ÿäÿπÿßÿ™ ŸàÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±\n' +
                               '‚Ä¢ ÿ¨ŸÖŸäÿπ ÿßŸÑÿØŸäŸàŸÜ ŸàÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑\n' +
                               '‚Ä¢ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸàÿßŸÑÿ™ÿÆÿµŸäÿµÿßÿ™\n' +
                               '‚Ä¢ ÿ≥ŸÑÿ© ÿßŸÑÿ™ÿ≥ŸàŸÇ ŸàÿßŸÑŸÖÿ≥ŸàÿØÿßÿ™\n' +
                               '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n' +
                               '‚ö†Ô∏è ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞Ÿá ÿßŸÑÿπŸÖŸÑŸäÿ©!\n\n' +
                               'ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ 100% ŸÖŸÜ ÿßŸÑŸÖÿ™ÿßÿ®ÿπÿ©ÿü';
            
            if (confirm(confirmText)) {
                if (confirm('‚ö†Ô∏è ÿ™ÿ£ŸÉŸäÿØ ÿ´ÿßŸÜŸä:\n\nŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ÿ™ŸÖÿßŸÖÿßŸã ŸÖŸÜ ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ¥Ÿäÿ°ÿü\nÿ≥Ÿäÿµÿ®ÿ≠ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ŸÉÿ£ŸÜŸá ÿ¨ÿØŸäÿØ ÿ™ŸÖÿßŸÖÿßŸã!')) {
                    if (confirm('‚ö†Ô∏è ÿ™ÿ£ŸÉŸäÿØ ŸÜŸáÿßÿ¶Ÿä:\n\nÿßŸÉÿ™ÿ® ŸÜÿπŸÖ ŸÅŸä ÿπŸÇŸÑŸÉ Ÿàÿßÿ∂ÿ∫ÿ∑ ŸÖŸàÿßŸÅŸÇ\nÿ≥Ÿäÿ™ŸÖ ÿ≠ÿ∞ŸÅ ŸÉŸÑ ÿ¥Ÿäÿ° ÿßŸÑÿ¢ŸÜ!')) {
                        
                        try {
                            showToast('üîÑ ÿ¨ÿßÿ±Ÿä ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™...', 'info');
                            
                            // 1. ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ÿßŸÑÿπÿßŸÖÿ©
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖŸÜ ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™...');
                            products = [];
                            categories = [];
                            suppliers = [];
                            salesData = [];
                            debtsData = [];
                            cartItems = [];
                            
                            // 2. ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ŸÖŸÅÿßÿ™Ÿäÿ≠ LocalStorage
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ LocalStorage...');
                            const localStorageKeys = Object.keys(localStorage);
                            localStorageKeys.forEach(key => {
                                localStorage.removeItem(key);
                            });
                            localStorage.clear();
                            
                            // 3. ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ŸÇŸàÿßÿπÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ IndexedDB
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ IndexedDB...');
                            const databases = ['POSDatabase', 'posDB', 'productsDB', 'salesDB', 'debtsDB'];
                            for (const dbName of databases) {
                                try {
                                    indexedDB.deleteDatabase(dbName);
                                    console.log(`‚úÖ ÿ™ŸÖ ÿ≠ÿ∞ŸÅ: ${dbName}`);
                                } catch (error) {
                                    console.warn(`‚ö†Ô∏è ÿÆÿ∑ÿ£ ŸÅŸä ÿ≠ÿ∞ŸÅ ${dbName}:`, error);
                                }
                            }
                            
                            // 4. ÿ≠ÿ∞ŸÅ Cookies
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ Cookies...');
                            document.cookie.split(";").forEach(function(c) { 
                                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
                            });
                            
                            // 5. ÿ≠ÿ∞ŸÅ SessionStorage
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ SessionStorage...');
                            sessionStorage.clear();
                            
                            // 6. ÿ≠ÿ∞ŸÅ Cache API
                            console.log('üóëÔ∏è ÿ≠ÿ∞ŸÅ Cache...');
                            if ('caches' in window) {
                                caches.keys().then(function(names) {
                                    for (let name of names) {
                                        caches.delete(name);
                                    }
                                });
                            }
                            
                            // 7. ÿ™ŸÜÿ∏ŸäŸÅ DOM
                            console.log('üóëÔ∏è ÿ™ŸÜÿ∏ŸäŸÅ ÿßŸÑŸàÿßÿ¨Ÿáÿ©...');
                            const searchInput = document.getElementById('productSearchInput');
                            if (searchInput) searchInput.value = '';
                            
                            const cartSection = document.querySelector('.cart-items');
                            if (cartSection) cartSection.innerHTML = '';
                            
                            // 8. ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©
                            console.log('üîÑ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©...');
                            const defaultSettings = {
                                theme: 'dark',
                                language: 'ar',
                                fontSize: 'medium',
                                animations: true
                            };
                            localStorage.setItem('systemSettings', JSON.stringify(defaultSettings));
                            
                            console.log('‚úÖ ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠!');
                            
                            showToast('‚úÖ ÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                            
                            // ÿ±ÿ≥ÿßŸÑÿ© ÿ™ÿ£ŸÉŸäÿØ ŸÜŸáÿßÿ¶Ÿäÿ©
                            setTimeout(() => {
                                alert('‚úÖ ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠!\n\n' +
                                      'üîÑ ÿ≥Ÿäÿ™ŸÖ ÿ•ÿπÿßÿØÿ© ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ¢ŸÜ\n' +
                                      'ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿ≥ŸäŸÉŸàŸÜ ŸÜÿ∏ŸäŸÅÿßŸã ÿ™ŸÖÿßŸÖÿßŸã ŸÉÿ£ŸÜŸá ÿ¨ÿØŸäÿØ!');
                                
                                // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿµŸÅÿ≠ÿ©
                                window.location.href = window.location.href.split('?')[0];
                                location.reload(true);
                            }, 1500);
                            
                        } catch (error) {
                            console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ÿ•ÿπÿßÿØÿ© ÿ∂ÿ®ÿ∑ ÿßŸÑŸÖÿµŸÜÿπ:', error);
                            showToast('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ≠ÿ∞ŸÅ: ' + error.message, 'error');
                        }
                    }
                }
            }
        }

        // ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÅŸÇÿ∑
        function clearSampleData() {
            if (confirm('üßπ ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©\n\nŸáŸÑ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸàÿßŸÑÿ®ÿØÿ° ÿ®ÿ™ÿ∑ÿ®ŸäŸÇ ŸÜÿ∏ŸäŸÅÿü\n\n‚úÖ ÿ≥Ÿäÿ™ŸÖ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™')) {
                try {
                    showToast('üîÑ ÿ¨ÿßÿ±Ÿä ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©...', 'info');
                    
                    // ÿ≠ÿ∞ŸÅ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÅŸÇÿ∑
                    products = [];
                    categories = [];
                    suppliers = [];
                    salesData = [];
                    debtsData = [];
                    cartItems = [];
                    
                    // ÿ≠ŸÅÿ∏ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÅÿßÿ±ÿ∫ÿ©
                    saveToLocalStorage();
                    
                    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸàÿßÿ¨Ÿáÿ©
                    updateAllViews();
                    renderCart();
                    
                    console.log('‚úÖ ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©');
                    showToast('‚úÖ ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ÿ®ŸÜÿ¨ÿßÿ≠!', 'success');
                    
                    setTimeout(() => {
                        alert('‚úÖ ÿ™ŸÖ ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠!\n\n' +
                              'üìù ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ¢ŸÜ ŸÜÿ∏ŸäŸÅ Ÿàÿ¨ÿßŸáÿ≤ ŸÑŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ\n' +
                              '‚öôÔ∏è ÿ™ŸÖ ÿßŸÑÿßÿ≠ÿ™ŸÅÿßÿ∏ ÿ®ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ŸàÿßŸÑÿ™ÿÆÿµŸäÿµÿßÿ™');
                    }, 1000);
                    
                } catch (error) {
                    console.error('‚ùå ÿÆÿ∑ÿ£ ŸÅŸä ŸÖÿ≥ÿ≠ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™:', error);
                    showToast('‚ùå ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑŸÖÿ≥ÿ≠', 'error');
                }
            }
        }

        // ÿØŸàÿßŸÑ ÿ•ÿ∂ÿßŸÅŸäÿ©
        function refreshPrinters() {
            showToast('ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ÿØŸäÿ´ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿßÿ™...', 'info');
            // ŸáŸÜÿß ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© ŸÉŸàÿØ ŸÑŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ∑ÿßÿ®ÿπÿßÿ™ ŸÖŸÜ ÿßŸÑŸÜÿ∏ÿßŸÖ
        }

        async function chooseBackupLocation() {
            if (window.electronAPI && window.electronAPI.selectDirectory) {
                const result = await window.electronAPI.selectDirectory();
                if (result && !result.canceled) {
                    const locationInput = document.getElementById('backupLocation');
                    if (locationInput) {
                        locationInput.value = result.filePaths[0];
                        showToast('‚úÖ ÿ™ŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑŸÖÿ¨ŸÑÿØ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
                    }
                }
            } else {
                // ŸÅŸä ÿ≠ÿßŸÑÿ© ÿπÿØŸÖ ÿ™ŸàŸÅÿ± Electron API
                const locationInput = document.getElementById('backupLocation');
                if (locationInput) {
                    const path = prompt('ÿ£ÿØÿÆŸÑ ŸÖÿ≥ÿßÿ± ÿßŸÑŸÖÿ¨ŸÑÿØ ŸÑŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä:', locationInput.value || 'C:\\Backups');
                    if (path) {
                        locationInput.value = path;
                        showToast('‚úÖ ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖÿ¨ŸÑÿØ', 'success');
                    }
                }
            }
        }

        function printTestPage() {
            showToast('ÿ¨ÿßÿ±Ÿä ÿ∑ÿ®ÿßÿπÿ© ÿµŸÅÿ≠ÿ© ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©...', 'info');
            window.print();
        }

        function changePassword() {
            const current = document.getElementById('currentPassword')?.value;
            const newPass = document.getElementById('newPassword')?.value;
            const confirm = document.getElementById('confirmPassword')?.value;

            if (!current || !newPass || !confirm) {
                showToast('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ', 'warning');
                return;
            }

            if (newPass !== confirm) {
                showToast('ŸÉŸÑŸÖÿ™ÿß ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ™ŸäŸÜ', 'error');
                return;
            }

            // ÿ≠ŸÅÿ∏ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± (Ÿäÿ¨ÿ® ÿ™ÿ¥ŸÅŸäÿ±Ÿáÿß ŸÅŸä ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ≠ŸÇŸäŸÇŸä)
            localStorage.setItem('appPassword', newPass);
            showToast('ÿ™ŸÖ ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
            
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        function viewActivityLog() {
            showToast('ÿ≥Ÿäÿ™ŸÖ ŸÅÿ™ÿ≠ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™', 'info');
            // ŸáŸÜÿß ŸäŸÖŸÉŸÜ ÿ•ÿ∂ÿßŸÅÿ© ÿµŸÅÿ≠ÿ© ÿπÿ±ÿ∂ ÿ≥ÿ¨ŸÑ ÿßŸÑŸÜÿ¥ÿßÿ∑ÿßÿ™
        }

        // ŸÖÿπÿßŸÑÿ¨ ÿ±ŸÅÿπ ÿßŸÑÿ¥ÿπÿßÿ± ŸÖÿπ ŸÖÿπÿßŸäŸÜÿ©
        function setupLogoPreview() {
            const logoInput = document.getElementById('settingsStoreLogo');
            if (logoInput) {
                logoInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file && file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            // ÿ•ŸÜÿ¥ÿßÿ° ŸÖÿπÿßŸäŸÜÿ©
                            let preview = document.querySelector('.logo-preview');
                            if (!preview) {
                                preview = document.createElement('div');
                                preview.className = 'logo-preview';
                                preview.style.cssText = 'margin-top: 1rem; padding: 1rem; background: var(--theme-bg-hover); border-radius: 8px; text-align: center;';
                                logoInput.parentElement.appendChild(preview);
                            }
                            preview.innerHTML = `
                                <img src="${event.target.result}" style="max-width: 200px; max-height: 100px; border-radius: 8px;">
                                <p style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--success-color);">
                                    <i class="fas fa-check-circle"></i> ÿ™ŸÖ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ¥ÿπÿßÿ± ÿ®ŸÜÿ¨ÿßÿ≠
                                </p>
                            `;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        // ÿ™ŸÅÿπŸäŸÑ/ÿ•ŸÑÿ∫ÿßÿ° ÿ™ŸÅÿπŸäŸÑ ÿ≠ŸÇŸàŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
        document.addEventListener('DOMContentLoaded', () => {
            const enablePasswordCheck = document.getElementById('enablePassword');
            const passwordFields = document.getElementById('passwordFields');
            
            if (enablePasswordCheck && passwordFields) {
                enablePasswordCheck.addEventListener('change', function() {
                    passwordFields.style.display = this.checked ? 'block' : 'none';
                });
            }

            // ÿ™ÿ≠ŸÖŸäŸÑ Ÿàÿ™ÿ∑ÿ®ŸäŸÇ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ©
            loadAllSettings();
            
            // ÿ™ŸÅÿπŸäŸÑ ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑÿ¥ÿπÿßÿ±
            setupLogoPreview();
            
            // ÿ•ÿπÿØÿßÿØ ŸÖŸÜÿ™ŸÇŸäÿßÿ™ ÿßŸÑÿ£ŸÑŸàÿßŸÜ
            setupColorPickers();
        });

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
        function loadAllSettings() {
            loadStoreSettings();
            loadSystemSettings();
            loadNotificationSettings();
            loadPrintingSettings();
            loadSecuritySettings();
            loadBackupSettings();
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ∏ÿßŸÖ
        function loadSystemSettings() {
            const savedSettings = localStorage.getItem('systemSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                // ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑŸÇŸäŸÖ ŸÅŸä ÿßŸÑŸÜŸÖÿßÿ∞ÿ¨
                if (document.getElementById('themeSelect')) document.getElementById('themeSelect').value = settings.theme || 'dark';
                if (document.getElementById('colorSchemeSelect')) document.getElementById('colorSchemeSelect').value = settings.colorScheme || 'default';
                if (document.getElementById('fontSizeSelect')) document.getElementById('fontSizeSelect').value = settings.fontSize || 'medium';
                if (document.getElementById('compactModeCheck')) document.getElementById('compactModeCheck').checked = settings.compactMode || false;
                if (document.getElementById('languageSelect')) document.getElementById('languageSelect').value = settings.language || 'ar';
                if (document.getElementById('dateFormatSelect')) document.getElementById('dateFormatSelect').value = settings.dateFormat || 'DD/MM/YYYY';
                if (document.getElementById('timeFormatSelect')) document.getElementById('timeFormatSelect').value = settings.timeFormat || '12';
                if (document.getElementById('itemsPerPageSelect')) document.getElementById('itemsPerPageSelect').value = settings.itemsPerPage || 25;
                if (document.getElementById('animationsCheck')) document.getElementById('animationsCheck').checked = settings.animations !== false;
                if (document.getElementById('autosaveCheck')) document.getElementById('autosaveCheck').checked = settings.autosave !== false;
                if (document.getElementById('barcodeSound')) document.getElementById('barcodeSound').checked = settings.barcodeSound !== false;
                if (document.getElementById('autoPrint')) document.getElementById('autoPrint').checked = settings.autoPrint || false;
                if (document.getElementById('clearCartAfterSale')) document.getElementById('clearCartAfterSale').checked = settings.clearCartAfterSale !== false;
                
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™ ÿπŸÑŸâ ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ
                applySystemSettings(settings);
            }
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
        function loadNotificationSettings() {
            const savedSettings = localStorage.getItem('notificationSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (document.getElementById('lowStockNotifications')) document.getElementById('lowStockNotifications').checked = settings.lowStock !== false;
                if (document.getElementById('lowStockThreshold')) document.getElementById('lowStockThreshold').value = settings.lowStockThreshold || 20;
                if (document.getElementById('outOfStockNotifications')) document.getElementById('outOfStockNotifications').checked = settings.outOfStock !== false;
                if (document.getElementById('expiryNotifications')) document.getElementById('expiryNotifications').checked = settings.expiry !== false;
                if (document.getElementById('salesNotifications')) document.getElementById('salesNotifications').checked = settings.sales !== false;
                if (document.getElementById('largeSaleNotifications')) document.getElementById('largeSaleNotifications').checked = settings.largeSale || false;
                if (document.getElementById('largeSaleAmount')) document.getElementById('largeSaleAmount').value = settings.largeSaleAmount || 1000000;
                if (document.getElementById('dailySalesReport')) document.getElementById('dailySalesReport').checked = settings.dailySalesReport !== false;
                if (document.getElementById('debtNotifications')) document.getElementById('debtNotifications').checked = settings.debt !== false;
                if (document.getElementById('debtDueNotifications')) document.getElementById('debtDueNotifications').checked = settings.debtDue !== false;
                if (document.getElementById('debtDueDays')) document.getElementById('debtDueDays').value = settings.debtDueDays || 3;
                if (document.getElementById('overdueDebtNotifications')) document.getElementById('overdueDebtNotifications').checked = settings.overdueDebt !== false;
                if (document.getElementById('updateNotifications')) document.getElementById('updateNotifications').checked = settings.updates !== false;
                if (document.getElementById('backupReminders')) document.getElementById('backupReminders').checked = settings.backupReminders !== false;
                if (document.getElementById('soundNotifications')) document.getElementById('soundNotifications').checked = settings.sound !== false;
                
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                applyNotificationSettings(settings);
            }
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ∑ÿ®ÿßÿπÿ©
        function loadPrintingSettings() {
            const savedSettings = localStorage.getItem('printingSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (document.getElementById('defaultPrinterSelect')) document.getElementById('defaultPrinterSelect').value = settings.defaultPrinter || '';
                if (document.getElementById('paperSizeSelect')) document.getElementById('paperSizeSelect').value = settings.paperSize || '80mm';
                if (document.getElementById('invoiceFontSize')) document.getElementById('invoiceFontSize').value = settings.fontSize || 'medium';
                if (document.getElementById('showLogoOnInvoice')) document.getElementById('showLogoOnInvoice').checked = settings.showLogo !== false;
                if (document.getElementById('showBarcodeOnInvoice')) document.getElementById('showBarcodeOnInvoice').checked = settings.showBarcode !== false;
                if (document.getElementById('showTaxOnInvoice')) document.getElementById('showTaxOnInvoice').checked = settings.showTax !== false;
                if (document.getElementById('invoiceFooterNote')) document.getElementById('invoiceFooterNote').value = settings.footerNote || '';
                if (document.getElementById('autoPrintInvoice')) document.getElementById('autoPrintInvoice').checked = settings.autoPrint || false;
                if (document.getElementById('printCopies')) document.getElementById('printCopies').checked = settings.printCopies || false;
                if (document.getElementById('openCashDrawer')) document.getElementById('openCashDrawer').checked = settings.openCashDrawer || false;
                
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                applyPrintingSettings(settings);
            }
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑÿ£ŸÖÿßŸÜ
        function loadSecuritySettings() {
            const savedSettings = localStorage.getItem('securitySettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (document.getElementById('enablePassword')) document.getElementById('enablePassword').checked = settings.passwordEnabled || false;
                if (document.getElementById('requirePasswordForDelete')) document.getElementById('requirePasswordForDelete').checked = settings.requirePasswordForDelete !== false;
                if (document.getElementById('requirePasswordForReports')) document.getElementById('requirePasswordForReports').checked = settings.requirePasswordForReports || false;
                if (document.getElementById('requirePasswordForSettings')) document.getElementById('requirePasswordForSettings').checked = settings.requirePasswordForSettings !== false;
                if (document.getElementById('enableActivityLog')) document.getElementById('enableActivityLog').checked = settings.activityLogEnabled !== false;
                if (document.getElementById('logRetentionPeriod')) document.getElementById('logRetentionPeriod').value = settings.logRetentionPeriod || 90;
                
                // ÿ•ÿ∏Ÿáÿßÿ±/ÿ•ÿÆŸÅÿßÿ° ÿ≠ŸÇŸàŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±
                const passwordFields = document.getElementById('passwordFields');
                if (passwordFields) {
                    passwordFields.style.display = settings.passwordEnabled ? 'block' : 'none';
                }
                
                // ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™
                applySecuritySettings(settings);
            }
        }

        // ÿ™ÿ≠ŸÖŸäŸÑ ÿ•ÿπÿØÿßÿØÿßÿ™ ÿßŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä
        function loadBackupSettings() {
            const savedSettings = localStorage.getItem('backupSettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                if (document.getElementById('autoBackupEnabled')) document.getElementById('autoBackupEnabled').checked = settings.autoBackupEnabled || false;
                if (document.getElementById('autoBackupFrequency')) document.getElementById('autoBackupFrequency').value = settings.frequency || 'daily';
                if (document.getElementById('backupLocation')) document.getElementById('backupLocation').value = settings.location || '';
            }
        }

        // ÿØŸàÿßŸÑ ÿßŸÑÿ™ŸàÿßŸÅŸÇŸäÿ© ŸÑŸÑŸÜÿ≥ÿÆ ÿßŸÑÿßÿ≠ÿ™Ÿäÿßÿ∑Ÿä ÿßŸÑŸÇÿØŸäŸÖÿ©
        function createBackup() {
            createFullBackup();
        }

        function restoreBackup() {
            document.getElementById('backupFileInput')?.click();
        }

        function resetSystem() {
            confirmFactoryReset();
        }

        // ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
        async function exportData(type, format) {
            let data = [];
            let filename = '';
            
            // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÜŸàÿπ
            switch(type) {
                case 'products':
                    data = products;
                    filename = 'ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™';
                    break;
                case 'inventory':
                    data = products;
                    filename = 'ÿßŸÑŸÖÿÆÿ≤ŸàŸÜ';
                    break;
                case 'invoices':
                    data = salesData;
                    filename = 'ÿßŸÑŸÅŸàÿßÿ™Ÿäÿ±';
                    break;
                case 'debts':
                    data = debtsData;
                    filename = 'ÿßŸÑÿØŸäŸàŸÜ';
                    break;
                default:
                    showToast('ŸÜŸàÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿπÿ±ŸàŸÅ', 'error');
                    return;
            }
            
            if (data.length === 0) {
                showToast('ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™ ŸÑŸÑÿ™ÿµÿØŸäÿ±', 'warning');
                return;
            }
            
            try {
                switch(format) {
                    case 'json':
                        exportToJSON(data, filename);
                        break;
                    case 'excel':
                        exportToExcel(data, filename, type);
                        break;
                    case 'pdf':
                        exportToPDF(data, filename, type);
                        break;
                    default:
                        showToast('ÿµŸäÿ∫ÿ© ÿßŸÑÿ™ÿµÿØŸäÿ± ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖÿ©', 'error');
                }
            } catch (error) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿµÿØŸäÿ±:', error);
                showToast('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿµÿØŸäÿ±', 'error');
            }
        }
        
        // ÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ JSON
        function exportToJSON(data, filename) {
            const jsonStr = JSON.stringify(data, null, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `${filename}_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            showToast('ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }
        
        // ÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ Excel
        function exportToExcel(data, filename, type) {
            if (typeof XLSX === 'undefined') {
                showToast('ŸÖŸÉÿ™ÿ®ÿ© Excel ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ÿ©', 'error');
                return;
            }
            
            let worksheetData = [];
            
            // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÜŸàÿπ
            if (type === 'products' || type === 'inventory') {
                worksheetData = data.map(item => ({
                    'ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ': item.product_barcode || '',
                    'ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨': item.product_name || '',
                    'ÿßŸÑÿ™ÿµŸÜŸäŸÅ': categories.find(c => c.category_id === item.product_category)?.category_name || '',
                    'ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ': item.product_price_retail || 0,
                    'ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°': item.product_cost_retail || 0,
                    'ÿßŸÑŸÉŸÖŸäÿ©': item.stock_quantity || 0,
                    'ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ': item.min_stock || 0,
                    'ÿßŸÑŸÖŸàÿ±ÿØ': item.supplier || ''
                }));
            } else if (type === 'invoices') {
                worksheetData = data.map(item => ({
                    'ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©': item.invoice_id || '',
                    'ÿßŸÑÿ™ÿßÿ±ŸäÿÆ': new Date(item.timestamp).toLocaleDateString('ar-IQ'),
                    'ÿßŸÑÿπŸÖŸäŸÑ': item.customer_name || 'ÿπŸÖŸäŸÑ ŸÜŸÇÿØŸä',
                    'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä': item.final_total || 0,
                    'ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ': item.payment_method || '',
                    'ÿßŸÑÿÆÿµŸÖ': item.discount || 0,
                    'ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©': item.tax || 0
                }));
            } else if (type === 'debts') {
                worksheetData = data.map(item => ({
                    'ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ': item.customer_name || '',
                    'ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ': item.customer_phone || '',
                    'ÿßŸÑÿπŸÜŸàÿßŸÜ': item.customer_address || '',
                    'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä': item.total_amount || item.final_total || 0,
                    'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä': item.remaining_amount || 0,
                    'ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä': item.monthly_amount || 0,
                    'ÿπÿØÿØ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑': item.installment_months || 0,
                    'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿßÿ≥ÿ™ÿ≠ŸÇÿßŸÇ': new Date(item.due_date).toLocaleDateString('ar-IQ')
                }));
            }
            
            const worksheet = XLSX.utils.json_to_sheet(worksheetData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, filename);
            XLSX.writeFile(workbook, `${filename}_${new Date().toISOString().split('T')[0]}.xlsx`);
            showToast('ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }
        
        // ÿ™ÿµÿØŸäÿ± ÿ•ŸÑŸâ PDF
        function exportToPDF(data, filename, type) {
            if (typeof jspdf === 'undefined' || typeof jspdf.jsPDF === 'undefined') {
                showToast('ŸÖŸÉÿ™ÿ®ÿ© PDF ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ÿ©', 'error');
                return;
            }
            
            const { jsPDF } = jspdf;
            const doc = new jsPDF();
            
            // ÿ•ÿ∂ÿßŸÅÿ© ÿØÿπŸÖ ŸÑŸÑÿπÿ±ÿ®Ÿäÿ© (ŸäŸÖŸÉŸÜ ÿ™ÿ≠ÿ≥ŸäŸÜŸá ÿ®ÿ•ÿ∂ÿßŸÅÿ© ÿÆÿ∑ ÿπÿ±ÿ®Ÿä)
            let headers = [];
            let rows = [];
            
            if (type === 'products' || type === 'inventory') {
                headers = [['Barcode', 'Name', 'Category', 'Price', 'Cost', 'Stock', 'Min', 'Supplier']];
                rows = data.map(item => [
                    item.product_barcode || '',
                    item.product_name || '',
                    categories.find(c => c.category_id === item.product_category)?.category_name || '',
                    formatCurrency(item.product_price_retail || 0),
                    formatCurrency(item.product_cost_retail || 0),
                    item.stock_quantity || 0,
                    item.min_stock || 0,
                    item.supplier || ''
                ]);
            } else if (type === 'invoices') {
                headers = [['Invoice', 'Date', 'Customer', 'Total', 'Method', 'Discount', 'Tax']];
                rows = data.map(item => [
                    item.invoice_id || '',
                    new Date(item.timestamp).toLocaleDateString('ar-IQ'),
                    item.customer_name || 'Cash',
                    formatCurrency(item.final_total || 0),
                    item.payment_method || '',
                    formatCurrency(item.discount || 0),
                    formatCurrency(item.tax || 0)
                ]);
            } else if (type === 'debts') {
                headers = [['Customer', 'Phone', 'Total', 'Remaining', 'Monthly', 'Months', 'Due Date']];
                rows = data.map(item => [
                    item.customer_name || '',
                    item.customer_phone || '',
                    formatCurrency(item.total_amount || item.final_total || 0),
                    formatCurrency(item.remaining_amount || 0),
                    formatCurrency(item.monthly_amount || 0),
                    item.installment_months || 0,
                    new Date(item.due_date).toLocaleDateString('ar-IQ')
                ]);
            }
            
            doc.autoTable({
                head: headers,
                body: rows,
                startY: 20,
                styles: { font: 'helvetica', fontSize: 8 }
            });
            
            doc.save(`${filename}_${new Date().toISOString().split('T')[0]}.pdf`);
            showToast('ÿ™ŸÖ ÿ™ÿµÿØŸäÿ± ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ŸÜÿ¨ÿßÿ≠', 'success');
        }

        // ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
        async function importData(type) {
            const fileInputId = `import${type.charAt(0).toUpperCase() + type.slice(1)}File`;
            const fileInput = document.getElementById(fileInputId);
            
            if (!fileInput || !fileInput.files || fileInput.files.length === 0) {
                showToast('ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßÿÆÿ™Ÿäÿßÿ± ŸÖŸÑŸÅ', 'warning');
                return;
            }
            
            const file = fileInput.files[0];
            const fileExtension = file.name.split('.').pop().toLowerCase();
            
            try {
                if (fileExtension === 'json') {
                    await importFromJSON(file, type);
                } else if (fileExtension === 'xlsx' || fileExtension === 'xls') {
                    await importFromExcel(file, type);
                } else if (fileExtension === 'csv') {
                    await importFromCSV(file, type);
                } else {
                    showToast('ÿµŸäÿ∫ÿ© ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖÿ©. ÿßÿ≥ÿ™ÿÆÿØŸÖ JSON ÿ£Ÿà Excel ÿ£Ÿà CSV', 'error');
                }
            } catch (error) {
                console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ:', error);
                showToast('ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™: ' + error.message, 'error');
            }
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ input
            fileInput.value = '';
        }
        
        // ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ŸÖŸÜ JSON
        async function importFromJSON(file, type) {
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    const jsonData = JSON.parse(e.target.result);
                    
                    if (!Array.isArray(jsonData)) {
                        showToast('ÿµŸäÿ∫ÿ© ÿßŸÑŸÖŸÑŸÅ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©. Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸÖÿµŸÅŸàŸÅÿ©', 'error');
                        return;
                    }
                    
                    await processImportedData(jsonData, type);
                } catch (error) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© JSON:', error);
                    showToast('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ: ' + error.message, 'error');
                }
            };
            
            reader.readAsText(file);
        }
        
        // ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ŸÖŸÜ Excel
        async function importFromExcel(file, type) {
            if (typeof XLSX === 'undefined') {
                showToast('ŸÖŸÉÿ™ÿ®ÿ© Excel ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ÿ©', 'error');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    
                    // ÿ™ÿ≠ŸàŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿßŸÑŸÜŸàÿπ
                    const convertedData = convertExcelData(jsonData, type);
                    await processImportedData(convertedData, type);
                } catch (error) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© Excel:', error);
                    showToast('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ: ' + error.message, 'error');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ŸÖŸÜ CSV
        async function importFromCSV(file, type) {
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    const csvData = e.target.result;
                    const lines = csvData.split('\n');
                    const headers = lines[0].split(',').map(h => h.trim());
                    const jsonData = [];
                    
                    for (let i = 1; i < lines.length; i++) {
                        if (!lines[i].trim()) continue;
                        
                        const values = lines[i].split(',');
                        const obj = {};
                        
                        headers.forEach((header, index) => {
                            obj[header] = values[index]?.trim() || '';
                        });
                        
                        jsonData.push(obj);
                    }
                    
                    const convertedData = convertExcelData(jsonData, type);
                    await processImportedData(convertedData, type);
                } catch (error) {
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© CSV:', error);
                    showToast('ÿÆÿ∑ÿ£ ŸÅŸä ŸÇÿ±ÿßÿ°ÿ© ÿßŸÑŸÖŸÑŸÅ: ' + error.message, 'error');
                }
            };
            
            reader.readAsText(file);
        }
        
        // ÿ™ÿ≠ŸàŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ Excel/CSV ÿ•ŸÑŸâ ÿßŸÑÿµŸäÿ∫ÿ© ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©
        function convertExcelData(excelData, type) {
            const convertedData = [];
            
            if (type === 'products' || type === 'inventory') {
                excelData.forEach(row => {
                    // ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑÿ™ÿµŸÜŸäŸÅ
                    let categoryId = '';
                    const categoryName = row['ÿßŸÑÿ™ÿµŸÜŸäŸÅ'] || row['Category'] || '';
                    if (categoryName) {
                        const foundCategory = categories.find(c => c.category_name === categoryName);
                        categoryId = foundCategory ? foundCategory.category_id : '';
                    }
                    
                    convertedData.push({
                        type: 'product',
                        product_id: row['product_id'] || Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        product_name: row['ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨'] || row['Name'] || row['product_name'] || '',
                        product_barcode: row['ÿßŸÑÿ®ÿßÿ±ŸÉŸàÿØ'] || row['Barcode'] || row['product_barcode'] || '',
                        product_price_retail: parseFloat(row['ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ'] || row['Price'] || row['product_price_retail'] || 0),
                        product_price_wholesale: parseFloat(row['ÿ≥ÿπÿ± ÿßŸÑÿ¨ŸÖŸÑÿ©'] || row['Wholesale Price'] || row['product_price_wholesale'] || row['ÿ≥ÿπÿ± ÿßŸÑÿ®Ÿäÿπ'] || row['Price'] || 0),
                        product_cost_retail: parseFloat(row['ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°'] || row['Cost'] || row['product_cost_retail'] || 0),
                        product_cost_wholesale: parseFloat(row['ÿ™ŸÉŸÑŸÅÿ© ÿßŸÑÿ¨ŸÖŸÑÿ©'] || row['Wholesale Cost'] || row['product_cost_wholesale'] || row['ÿ≥ÿπÿ± ÿßŸÑÿ¥ÿ±ÿßÿ°'] || row['Cost'] || 0),
                        stock_quantity: parseInt(row['ÿßŸÑŸÉŸÖŸäÿ©'] || row['Stock'] || row['stock_quantity'] || 0),
                        min_stock: parseInt(row['ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ'] || row['Min'] || row['min_stock'] || 5),
                        product_category: row['product_category'] || categoryId || '1',
                        supplier: row['ÿßŸÑŸÖŸàÿ±ÿØ'] || row['Supplier'] || row['supplier'] || '',
                        timestamp: row['timestamp'] || new Date().toISOString()
                    });
                });
            } else if (type === 'invoices') {
                excelData.forEach(row => {
                    convertedData.push({
                        type: 'sale',
                        invoice_id: row['ÿ±ŸÇŸÖ ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©'] || row['Invoice'] || row['invoice_id'] || 'INV-' + Date.now(),
                        customer_name: row['ÿßŸÑÿπŸÖŸäŸÑ'] || row['Customer'] || row['customer_name'] || 'ÿπŸÖŸäŸÑ ŸÜŸÇÿØŸä',
                        final_total: parseFloat(row['ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä'] || row['Total'] || row['final_total'] || 0),
                        payment_method: row['ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ'] || row['Method'] || row['payment_method'] || 'ŸÜŸÇÿØŸä',
                        discount: parseFloat(row['ÿßŸÑÿÆÿµŸÖ'] || row['Discount'] || row['discount'] || 0),
                        tax: parseFloat(row['ÿßŸÑÿ∂ÿ±Ÿäÿ®ÿ©'] || row['Tax'] || row['tax'] || 0),
                        items: row['items'] || '[]',
                        timestamp: row['timestamp'] || new Date().toISOString()
                    });
                });
            } else if (type === 'debts') {
                excelData.forEach(row => {
                    const totalAmount = parseFloat(row['ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä'] || row['Total'] || row['total_amount'] || 0);
                    const installmentMonths = parseInt(row['ÿπÿØÿØ ÿßŸÑÿ£ŸÇÿ≥ÿßÿ∑'] || row['Months'] || row['installment_months'] || 12);
                    const monthlyAmount = parseFloat(row['ÿßŸÑŸÇÿ≥ÿ∑ ÿßŸÑÿ¥Ÿáÿ±Ÿä'] || row['Monthly'] || row['monthly_amount'] || (totalAmount / installmentMonths));
                    
                    convertedData.push({
                        type: 'debt',
                        customer_name: row['ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ'] || row['Customer'] || row['customer_name'] || '',
                        customer_phone: row['ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ'] || row['Phone'] || row['customer_phone'] || '',
                        customer_address: row['ÿßŸÑÿπŸÜŸàÿßŸÜ'] || row['Address'] || row['customer_address'] || '',
                        total_amount: totalAmount,
                        remaining_amount: parseFloat(row['ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä'] || row['Remaining'] || row['remaining_amount'] || totalAmount),
                        monthly_amount: monthlyAmount,
                        installment_months: installmentMonths,
                        due_date: row['due_date'] || new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString(),
                        invoice_id: row['invoice_id'] || 'INV-' + Date.now(),
                        timestamp: row['timestamp'] || new Date().toISOString()
                    });
                });
            }
            
            return convertedData;
        }
        
        // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™Ÿàÿ±ÿØÿ©
        async function processImportedData(data, type) {
            if (!window.dataSdk) {
                showToast('ŸÜÿ∏ÿßŸÖ ŸÇÿßÿπÿØÿ© ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠', 'error');
                return;
            }
            
            let successCount = 0;
            let errorCount = 0;
            
            showToast(`ÿ¨ÿßÿ±Ÿä ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ${data.length} ÿπŸÜÿµÿ±...`, 'info');
            
            for (const item of data) {
                try {
                    // ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ŸÜŸàÿπ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿµÿ≠Ÿäÿ≠
                    if (type === 'products' || type === 'inventory') {
                        item.type = 'product';
                    } else if (type === 'invoices') {
                        item.type = 'sale';
                    } else if (type === 'debts') {
                        item.type = 'debt';
                    }
                    
                    const result = await window.dataSdk.create(item);
                    if (result.isOk) {
                        successCount++;
                    } else {
                        errorCount++;
                        console.error('ŸÅÿ¥ŸÑ ŸÅŸä ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿπŸÜÿµÿ±:', item, result.error);
                    }
                } catch (error) {
                    errorCount++;
                    console.error('ÿÆÿ∑ÿ£ ŸÅŸä ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿπŸÜÿµÿ±:', item, error);
                }
            }
            
            // ÿ•ÿπÿßÿØÿ© ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™
            await new Promise(resolve => setTimeout(resolve, 500));
            
            if (successCount > 0) {
                showToast(`ÿ™ŸÖ ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ${successCount} ÿπŸÜÿµÿ± ÿ®ŸÜÿ¨ÿßÿ≠${errorCount > 0 ? ` Ÿà${errorCount} ÿπŸÜÿµÿ± ŸÅÿ¥ŸÑ` : ''}`, 'success');
            } else {
                showToast('ŸÅÿ¥ŸÑ ÿßÿ≥ÿ™Ÿäÿ±ÿßÿØ ÿ¨ŸÖŸäÿπ ÿßŸÑÿπŸÜÿßÿµÿ±', 'error');
            }
        }

        // Initialize app when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            initApp();
        }

        // ÿ±ÿ®ÿ∑ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ™ÿ≠ŸÉŸÖ ÿ®ÿßŸÑŸÜÿßŸÅÿ∞ÿ©
        document.addEventListener('DOMContentLoaded', () => {
            const { ipcRenderer } = require('electron');
            
            // ÿ•ÿπÿØÿßÿØ ŸÖÿ≥ÿ™ŸÖÿπÿßÿ™ ÿ£ÿ≠ÿØÿßÿ´ ÿßŸÑÿ≥ŸÑÿ© ŸÑŸÑÿ™ŸÖÿ±Ÿäÿ± ÿßŸÑÿ™ŸÑŸÇÿßÿ¶Ÿä
            const cartSection = document.querySelector('.cart-section');
            const cartItems = document.getElementById('cartItems');
            
            if (cartSection && cartItems) {
                // ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑŸÑÿ£ÿπŸÑŸâ ÿπŸÜÿØ hover ÿπŸÑŸâ ÿßŸÑÿ≥ŸÑÿ©
                cartSection.addEventListener('mouseenter', () => {
                    scrollCartToTop();
                });
                
                // ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ŸÖÿ±Ÿäÿ± ŸÑŸÑÿ£ÿ≥ŸÅŸÑ ÿπŸÜÿØ ÿ•ÿ≤ÿßŸÑÿ© ÿßŸÑŸÖÿ§ÿ¥ÿ±
                cartSection.addEventListener('mouseleave', () => {
                    scrollCartToBottom();
                });
            }
            
            // ÿ≤ÿ± ÿßŸÑÿ•ÿ∫ŸÑÿßŸÇ
            const closeBtn = document.querySelector('.titlebar-btn.close');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    ipcRenderer.send('window-close');
                });
            }
            
            // ÿ≤ÿ± ÿßŸÑÿ™ÿµÿ∫Ÿäÿ±
            const minimizeBtn = document.querySelector('.titlebar-btn.minimize');
            if (minimizeBtn) {
                minimizeBtn.addEventListener('click', () => {
                    ipcRenderer.send('window-minimize');
                });
            }
            
            // ÿ≤ÿ± ÿßŸÑÿ™ŸÉÿ®Ÿäÿ±
            const maximizeBtn = document.querySelector('.titlebar-btn.maximize');
            if (maximizeBtn) {
                maximizeBtn.addEventListener('click', () => {
                    ipcRenderer.send('window-maximize');
                });
            }
        });
    </script>
 </body>
</html>